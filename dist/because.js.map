{"version":3,"sources":["webpack/universalModuleDefinition","webpack/bootstrap 5ebf1d11c86902fb69a9","./src/service.ts","./src/headers.ts","./src/data.ts","./src/errors.ts","./src/parse.ts","./src/query.ts","./src/service_frontend.ts","./src/location.ts","./src/log.ts","./src/table.ts","./src/services/basemap/frontend.ts","./src/services/geocoding/frontend.ts","./src/services/routing/frontend.ts","./src/services/search/frontend.ts","./src/services/token/frontend.ts","./src/host.ts","./src/request.ts","./src/response.ts","./src/services/geocoding/geocode.ts","./src/services/geocoding/parse.ts","./src/services/routing/route.ts","./src/flavors/browser_es5.ts","./src/frontend.ts","./src/hosts.ts","./src/auth.ts","./src/browser.ts","./src/client.ts","./src/format.ts","./src/progress.ts","./src/services/basemap/basemap.ts","./src/services/basemap/endpoints.ts","./src/services/basemap/parse.ts","./src/services/basemap/service.ts","./src/services/geocoding/endpoints.ts","./src/services/geocoding/service.ts","./src/services/routing/endpoints.ts","./src/services/routing/parse.ts","./src/services/routing/service.ts","./src/services/search/endpoints.ts","./src/services/search/parse.ts","./src/services/search/search_result.ts","./src/services/search/service.ts","./src/services/token/endpoints.ts","./src/services/token/jwt.ts","./src/services/token/parse.ts","./src/services/token/service.ts","./src/transfer.ts","./src/xhr.ts"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA,mDAA2C,cAAc;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;;;;;;;;;;;;;AChEA,oCAAqC;AACrC,qCAAuC;AACvC,uCAAoC;AAGpC,wCAAoC;AACpC,qCAAgC;AAChC,uCAAkC;AAoBlC;IAA2B,gCAAc;IAAzC;;IACA,CAAC;IAAD,mBAAC;AAAD,CAAC,CAD0B,WAAI,GAC9B;AAGD;IAA4B,iCAAsB;IAAlD;;IACA,CAAC;IAAD,oBAAC;AAAD,CAAC,CAD2B,oBAAY,GACvC;AAGD;IAAkC,gCAAK;IAAvC;;IACA,CAAC;IAAD,mBAAC;AAAD,CAAC,CADiC,KAAK,GACtC;AADY,oCAAY;AAOzB;IAMI,iBAAa,SAAwB,EAAE,OAAiB;QACpD,SAAS,GAAG,SAAS,IAAI,IAAI,CAAC,SAAS,IAAI,EAAE,CAAC;QAE9C,IAAI,CAAC,KAAK,GAAG,IAAI,aAAa,CAAC,SAAS,CAAC,CAAC;QAC1C,IAAI,CAAC,QAAQ,GAAG,OAAO,IAAI,IAAI,iBAAO,EAAE,CAAC;IAC7C,CAAC;IAEO,+BAAa,GAArB,UAAsB,SAAuB;QAGzC,GAAG,CAAC,CAAe,UAAgB,EAAhB,iBAAK,CAAC,SAAS,CAAC,EAAhB,cAAgB,EAAhB,IAAgB;YAA9B,IAAM,IAAI;YACJ,iBAAG,EAAE,eAAK,CAAS;YAC1B,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;SAE9B;IACL,CAAC;IAED,0BAAQ,GAAR,UAAS,IAAY;QACjB,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;IAChC,CAAC;IAED,qBAAG,GAAH,UAAI,aAAqB,EAAE,IAAU;QACjC,IAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;QAC9C,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;IAC9B,CAAC;IAED,qBAAG,GAAH,UAAI,IAAS,EAAE,aAAqB,EAAE,IAAW;QAC7C,IAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;QAC9C,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;YACZ,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,eAAe,CAAC;YAC7D,MAAM,IAAI,KAAK,CACX,uBAAqB,aAAa,iEACM,IAAM,CACjD,CAAC;QACN,CAAC;QACD,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,EAAE,IAAI,CAAQ,CAAC;IAC3C,CAAC;IA2BL,cAAC;AAAD,CAAC;AArEY,0BAAO;AA+EpB;IAaI,kBACI,MAAc,EACd,GAAQ,EACR,KAA2B,EAC3B,OAAiC,EACjC,IAA0B;QAE1B,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,IAAI,GAAG,GAAG,CAAC;QAEhB,EAAE,CAAC,CAAC,CAAC,KAAK,IAAI,OAAO,KAAK,KAAK,QAAQ,CAAC,CAAC,CAAC;YACtC,IAAI,CAAC,aAAa,GAAG,KAAK,IAAI,IAAI,aAAK,EAAE,CAAC;QAC9C,CAAC;QACD,IAAI,CAAC,EAAE,CAAC,CAAC,OAAO,KAAK,KAAK,UAAU,CAAC,CAAC,CAAC;YACnC,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;QAChC,CAAC;QAED,EAAE,CAAC,CAAC,CAAC,OAAO,IAAI,OAAO,OAAO,KAAK,QAAQ,CAAC,CAAC,CAAC;YAC1C,IAAI,CAAC,eAAe,GAAG,OAAO,IAAI,IAAI,iBAAO,EAAE,CAAC;QACpD,CAAC;QACD,IAAI,CAAC,EAAE,CAAC,CAAC,OAAO,OAAO,KAAK,UAAU,CAAC,CAAC,CAAC;YACrC,IAAI,CAAC,gBAAgB,GAAG,OAAO,CAAC;QACpC,CAAC;QAED,EAAE,CAAC,CAAC,CAAC,IAAI,IAAI,OAAO,IAAI,KAAK,QAAQ,CAAC,CAAC,CAAC;YACpC,IAAI,CAAC,YAAY,GAAG,IAAI,IAAI,EAAE,CAAC;QACnC,CAAC;QACD,IAAI,CAAC,EAAE,CAAC,CAAC,OAAO,IAAI,KAAK,UAAU,CAAC,CAAC,CAAC;YAClC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;QAC9B,CAAC;IACL,CAAC;IAED,sBAAG,GAAH,UAAI,IAAW,EAAE,YAA6B;QAA7B,mDAA6B;QAC1C,IAAI,GAAG,IAAI,IAAI,EAAE,CAAC;QAClB,IAAM,WAAW,GAA4B,EAAE,CAAC;QAChD,GAAG,CAAC,CAAc,UAAiB,EAAjB,WAAM,CAAC,IAAI,CAAC,IAAI,CAAC,EAAjB,cAAiB,EAAjB,IAAiB;YAA9B,IAAM,GAAG;YACV,IAAI,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC;YAC5B,EAAE,CAAC,CAAC,KAAK,KAAK,SAAS,CAAC,CAAC,CAAC;gBACtB,KAAK,GAAG,EAAE,CAAC;YACf,CAAC;YACD,IAAI,CAAC,EAAE,CAAC,CAAC,OAAO,KAAK,KAAK,QAAQ,CAAC,CAAC,CAAC;gBACjC,KAAK,GAAG,KAAK,CAAC,QAAQ,EAAE,CAAC;YAC7B,CAAC;YACD,IAAI,CAAC,CAAC;gBACF,KAAK,GAAG,KAAK,CAAC;YAClB,CAAC;YACD,WAAW,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;SAC5B;QAED,IAAM,GAAG,GAAG,eAAM,CAAC,IAAI,CAAC,IAAc,EAAE,WAAW,CAAQ,CAAC;QAG5D,EAAE,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC;YACf,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;YAC/B,IAAM,EAAE,GAAW,KAAK,CAAC,OAAO,CAAC;YACjC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;gBACL,MAAM,CAAI,GAAG,SAAI,EAAW,CAAC;YACjC,CAAC;QACL,CAAC;QACD,MAAM,CAAC,GAAG,CAAC;IACf,CAAC;IAED,sBAAG,GAAH,UAAI,IAAS,EAAE,IAAW,EAAE,YAA6B;QAA7B,mDAA6B;QAErD,EAAE,CAAC,CAAC,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAc,CAAC,CAAC,CAAC,CAAC;YAC1C,MAAM,IAAI,KAAK,CAAC,sBAAoB,IAAM,CAAC,CAAC;QAChD,CAAC;QAGD,IAAM,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE,YAAY,CAAC,CAAC,OAAO,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC;QAC/D,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC;QAClC,MAAM,CAAI,IAAI,SAAI,GAAY,CAAC;IACnC,CAAC;IAED,wBAAK,GAAL,UAAM,IAAW;QACb,IAAI,KAAY,CAAC;QACjB,EAAE,CAAC,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC;YACtB,KAAK,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,IAAI,EAAE,CAAC,CAAC;QAC5C,CAAC;QACD,IAAI,CAAC,CAAC;YACF,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC;QACtC,CAAC;QACD,MAAM,CAAC,KAAK,CAAC;IACjB,CAAC;IAED,0BAAO,GAAP,UAAQ,IAAW;QACf,IAAI,OAAgB,CAAC;QACrB,EAAE,CAAC,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC;YACxB,OAAO,GAAG,IAAI,CAAC,gBAAgB,CAAC,IAAI,IAAI,EAAE,CAAC,CAAC;QAChD,CAAC;QACD,IAAI,CAAC,CAAC;YACF,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,IAAI,EAAE,CAAC;QAC1C,CAAC;QACD,MAAM,CAAC,OAAO,CAAC;IACnB,CAAC;IAED,uBAAI,GAAJ,UAAK,IAAW;QACZ,IAAI,IAAU,CAAC;QACf,EAAE,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC;YACrB,IAAI,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,IAAI,EAAE,CAAC,CAAC;QAC1C,CAAC;QACD,IAAI,CAAC,CAAC;YACF,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC;QAC7B,CAAC;QACD,MAAM,CAAC,IAAI,CAAC;IAChB,CAAC;IAED,0BAAO,GAAP,UAAQ,IAAS,EAAE,IAAW;QAC1B,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QAC/B,IAAM,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;QACnC,IAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC7B,IAAM,OAAO,GAAG,IAAI,iBAAO,CACvB,IAAI,CAAC,MAAM,EACX,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE,IAAI,EAAE,KAAK,CAAC,EAC3B,KAAK,EACL,IAAI,EACJ,OAAO,CACV,CAAC;QACF,MAAM,CAAC,OAAO,CAAC;IACnB,CAAC;IAEL,eAAC;AAAD,CAAC;AAtIY,4BAAQ;;;;;;;;;;;;;;;;;;;;AChHrB,oCAAyC;AACzC,qCAA8C;AAS9C;IAAgC,8BAAY;IAA5C;;IACA,CAAC;IAAD,iBAAC;AAAD,CAAC,CAD+B,WAAI,GACnC;AADY,gCAAU;AASvB,mBAAmB,GAAW;IAC1B,MAAM,CAAC,GAAG,CAAC,WAAW,EAAE,CAAC;AAC7B,CAAC;AAMD,uBACI,OAA0B,EAAE,KAAc;IAI1C,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;QACX,MAAM,CAAC,EAAE,CAAC;IACd,CAAC;IACD,EAAE,CAAC,CAAC,KAAK,IAAI,OAAO,CAAC,MAAM,GAAG,KAAK,CAAC,CAAC,CAAC;QAClC,MAAM,IAAI,KAAK,CAAC,sCAAsC,CAAC,CAAC;IAC5D,CAAC;IAED,IAAM,QAAQ,GAAG,MAAM,CAAC;IACxB,IAAM,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;IAEtC,IAAM,QAAQ,GAAG,IAAI,CAAC;IACtB,IAAM,IAAI,GAAe,EAAE,CAAC;IAC5B,GAAG,CAAC,CAAe,UAAK,EAAL,eAAK,EAAL,mBAAK,EAAL,IAAK;QAAnB,IAAM,IAAI;QACX,IAAM,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;QACrC,IAAM,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC;QACjC,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,QAAQ,CAAC,MAAM,CAAC,CAAC;QAClD,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;YACN,IAAI,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;QACtB,CAAC;KACJ;IACD,MAAM,CAAC,IAAI,CAAC;AAChB,CAAC;AA1BD,sCA0BC;AAWD;IAA6B,2BAAoB;IAU7C,iBAAa,IAAiB;QAA9B,iBAQC;QANG,IAAM,UAAU,GAAG,UAAG,CAClB,IAAI,IAAI,EAAE,EACV,UAAC,GAAW,EAAE,KAAa;YAC3B,MAAM,CAAC,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,KAAK,CAAC,CAAC;QACnC,CAAC,CAAC,CAAC;QACH,0BAAM,UAAU,CAAC,SAAC;;IACtB,CAAC;IAMM,aAAK,GAAZ,UAAa,IAAgB;QACzB,IAAM,IAAI,GAAe,aAAa,CAAC,IAAI,CAAC,CAAC;QAC7C,MAAM,CAAC,IAAI,OAAO,CAAC,IAAI,CAAC,CAAC;IAC7B,CAAC;IAOD,qBAAG,GAAH,UAAI,GAAW;QAEX,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,CAAC;IACtC,CAAC;IAWD,qBAAG,GAAH,UAAI,GAAW,EAAE,KAAwB;QACrC,IAAI,MAAc,CAAC;QACnB,EAAE,CAAC,CAAC,OAAM,CAAC,KAAK,CAAC,KAAK,QAAQ,CAAC,CAAC,CAAC;YAC7B,MAAM,GAAG,KAAK,CAAC;QACnB,CAAC;QACD,IAAI,CAAC,CAAC;YACF,MAAM,GAAG,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QAC7B,CAAC;QAED,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,GAAG,MAAM,CAAC;IACxC,CAAC;IACL,cAAC;AAAD,CAAC,CA3D4B,oBAAY,GA2DxC;AA3DY,0BAAO;;;;;;;;;;ACZpB;IAAA;IAEA,CAAC;IAAD,WAAC;AAAD,CAAC;AAFY,oBAAI;AAUjB,gBAAkC,IAAqB;IAGnD,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC;AACpC,CAAC;AAJD,wBAIC;AAUD,cAAgC,IAAqB;IACjD,IAAM,MAAM,GAAa,EAAE,CAAC;IAC5B,GAAG,CAAC,CAAC,IAAM,QAAQ,IAAI,IAAI,CAAC,CAAC,CAAC;QAC1B,EAAE,CAAC,CAAC,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;YAChC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC1B,CAAC;IACL,CAAC;IACD,MAAM,CAAC,MAAM,CAAC;AAClB,CAAC;AARD,oBAQC;AAQD,gBAAkC,IAAqB;IAEnD,IAAM,MAAM,GAAgB,EAAE,CAAC;IAC/B,GAAG,CAAC,CAAc,UAAU,EAAV,SAAI,CAAC,IAAI,CAAC,EAAV,cAAU,EAAV,IAAU;QAAvB,IAAM,GAAG;QACV,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;KAC1B;IACD,MAAM,CAAC,MAAM,CAAC;AAClB,CAAC;AAPD,wBAOC;AAOD,eACC,IAAqB;IAClB,IAAM,MAAM,GAA0B,EAAE,CAAC;IACzC,GAAG,CAAC,CAAc,UAAU,EAAV,SAAI,CAAC,IAAI,CAAC,EAAV,cAAU,EAAV,IAAU;QAAvB,IAAM,GAAG;QACV,MAAM,CAAC,IAAI,CAAC,CAAC,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;KACjC;IACD,MAAM,CAAC,MAAM,CAAC;AAClB,CAAC;AAPD,sBAOC;AAOD,gBACC,CAAkB,EAAE,CAAkB;IACnC,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;QACV,MAAM,CAAC,IAAI,CAAC;IAChB,CAAC;IACD,IAAM,MAAM,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;IACvB,IAAM,MAAM,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;IACvB,EAAE,CAAC,CAAC,MAAM,CAAC,MAAM,KAAK,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC;QAClC,MAAM,CAAC,KAAK,CAAC;IACjB,CAAC;IACD,MAAM,CAAC,IAAI,EAAE,CAAC;IACd,MAAM,CAAC,IAAI,EAAE,CAAC;IACd,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;QACrC,IAAM,KAAK,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;QACxB,IAAM,KAAK,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;QACxB,EAAE,CAAC,CAAC,KAAK,KAAK,KAAK,CAAC,CAAC,CAAC;YAClB,MAAM,CAAC,KAAK,CAAC;QACjB,CAAC;QACD,IAAM,OAAO,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC;QACzB,IAAM,OAAO,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC;QACzB,EAAE,CAAC,CAAC,OAAO,KAAK,OAAO,CAAC,CAAC,CAAC;YACtB,MAAM,CAAC,KAAK,CAAC;QACjB,CAAC;IACL,CAAC;IACD,MAAM,CAAC,IAAI,CAAC;AAChB,CAAC;AAzBD,wBAyBC;AAOD,sBACC,CAAc,EAAE,CAAc;IAC3B,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;QACV,MAAM,CAAC,IAAI,CAAC;IAChB,CAAC;IACD,EAAE,CAAC,CAAC,CAAC,CAAC,MAAM,KAAK,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;QACxB,MAAM,CAAC,KAAK,CAAC;IACjB,CAAC;IACD,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;QAChC,IAAM,MAAM,GAAc,CAAC,CAAC,CAAC,CAAC,CAAC;QAC/B,IAAM,MAAM,GAAc,CAAC,CAAC,CAAC,CAAC,CAAC;QAI/B,EAAE,CAAC,CAAC,MAAM,KAAK,MAAM,CAAC,CAAC,CAAC;YACpB,MAAM,CAAC,KAAK,CAAC;QACjB,CAAC;IACL,CAAC;IACD,MAAM,CAAC,IAAI,CAAC;AAChB,CAAC;AAnBD,oCAmBC;AAOD,qBACC,CAAyB,EAAE,CAAyB;IACjD,EAAE,CAAC,CAAC,CAAC,CAAC,MAAM,KAAK,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;QAAC,MAAM,CAAC,KAAK,CAAC;IAAC,CAAC;IAC5C,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;QAC1B,aAAe,EAAd,UAAE,EAAE,UAAE,CAAS;QAChB,aAAe,EAAd,UAAE,EAAE,UAAE,CAAS;QACtB,EAAE,CAAC,CAAC,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC;YACzB,MAAM,CAAC,KAAK,CAAC;QACjB,CAAC;IACL,CAAC;IACD,MAAM,CAAC,IAAI,CAAC;AAChB,CAAC;AAXD,kCAWC;AA2BD,cACC,IAAqB,EAAE,QAAiC;IACrD,GAAG,CAAC,CAAe,UAAW,EAAX,UAAK,CAAC,IAAI,CAAC,EAAX,cAAW,EAAX,IAAW;QAAzB,IAAM,IAAI;QACX,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;KAC9B;AACL,CAAC;AALD,oBAKC;AAQD,mBACC,IAAqB,EAAE,QAAiC;IACrD,IAAM,MAAM,GAA+B,EAAE,CAAC;IAC9C,GAAG,CAAC,CAAe,UAAW,EAAX,UAAK,CAAC,IAAI,CAAC,EAAX,cAAW,EAAX,IAAW;QAAzB,IAAM,IAAI;QACX,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;KAC3C;IACD,MAAM,CAAC,MAAM,CAAC;AAClB,CAAC;AAQD,aACC,IAAqB,EAAE,QAAiC;IACrD,IAAM,MAAM,GAAoB,EAAE,CAAC;IACnC,GAAG,CAAC,CAAe,UAAyB,EAAzB,cAAS,CAAC,IAAI,EAAE,QAAQ,CAAC,EAAzB,cAAyB,EAAzB,IAAyB;QAAvC,IAAM,IAAI;QACJ,iBAAG,EAAE,eAAK,CAAS;QAC1B,MAAM,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;KACvB;IACD,MAAM,CAAC,MAAM,CAAC;AAClB,CAAC;AARD,kBAQC;AAQD,cACC,IAAqB;IAClB,MAAM,CAAC,GAAG,CAAC,IAAI,EAAE,UAAC,GAAW,EAAE,KAAgB;QAC3C,MAAM,CAAC,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;IACxB,CAAC,CAAC,CAAC;AACP,CAAC;AALD,oBAKC;AASD,iBACC,IAAqB,EAAE,KAAsB;IAC1C,IAAM,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC;IAC1B,GAAG,CAAC,CAAC,IAAM,QAAQ,IAAI,KAAK,CAAC,CAAC,CAAC;QAC3B,EAAE,CAAC,CAAC,KAAK,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;YACjC,MAAM,CAAC,QAAQ,CAAC,GAAG,KAAK,CAAC,QAAQ,CAAC,CAAC;QACvC,CAAC;IACL,CAAC;IACD,MAAM,CAAC,MAAM,CAAC;AAClB,CAAC;AATD,0BASC;AAOD,oBACC,IAAqB,EAAE,GAAS;IAAT,+BAAS;IAC7B,IAAM,MAAM,GAAa,EAAE,CAAC;IAC5B,GAAG,CAAC,CAAe,UAAW,EAAX,UAAK,CAAC,IAAI,CAAC,EAAX,cAAW,EAAX,IAAW;QAAzB,IAAM,IAAI;QACX,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;KAC/B;IACD,MAAM,CAAC,MAAM,CAAC;AAClB,CAAC;AAPD,gCAOC;AAQD,mBACC,IAAqB,EAAE,GAAW,EAAE,QAAc;IAAd,yCAAc;IAC/C,MAAM,CAAC,UAAU,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;AAChD,CAAC;AAHD,8BAGC;;;;;;;;;;;;;;;;;;;;ACrTD;IAOI,sBAAa,OAAe;QANnB,SAAI,GAAW,cAAc,CAAC;QAOnC,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;IAC3B,CAAC;IACL,mBAAC;AAAD,CAAC;AAVY,oCAAY;AAuBzB;IAAmC,iCAAY;IAA/C;QAAA,qEAEC;QADY,UAAI,GAAW,eAAe,CAAC;;IAC5C,CAAC;IAAD,oBAAC;AAAD,CAAC,CAFkC,YAAY,GAE9C;AAFY,sCAAa;AAU1B;IAAgC,8BAAY;IAA5C;;IACA,CAAC;IAAD,iBAAC;AAAD,CAAC,CAD+B,YAAY,GAC3C;AADY,gCAAU;;;;;;;;;;;;;;;;;;;;ACzCvB,sCAAwC;AAIxC;IAAyB,8BAAY;IAGjC,oBAAa,OAAe,EAAE,QAAkB;QAAhD,YACI,kBAAM,OAAO,CAAC,SAEjB;QADG,KAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;;IAC7B,CAAC;IACL,iBAAC;AAAD,CAAC,CAPwB,qBAAY,GAOpC;AAOD;IAAA;IAGA,CAAC;IAAD,mBAAC;AAAD,CAAC;AAUD,wBAAuD,QAAkB;IACrE,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;QACZ,MAAM,IAAI,KAAK,CAAC,aAAa,CAAC,CAAC;IACnC,CAAC;IACD,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;QACjB,MAAM,IAAI,KAAK,CAAC,sBAAsB,CAAC,CAAC;IAC5C,CAAC;IACD,EAAE,CAAC,CAAC,QAAQ,CAAC,MAAM,GAAG,GAAG,IAAI,QAAQ,CAAC,MAAM,GAAG,GAAG,CAAC,CAAC,CAAC;QACjD,IAAM,OAAO,GAAG,qBAAmB,QAAQ,CAAC,MAAQ,CAAC;QACrD,MAAM,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC;IAC7B,CAAC;IACD,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;IACvC,EAAE,CAAC,CAAC,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC;QACtC,IAAM,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC;QAC5B,IAAM,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC;QAClC,MAAM,IAAI,KAAK,CAAC,6BAA2B,IAAI,UAAK,OAAS,CAAC,CAAC;IACnE,CAAC;IACD,MAAM,CAAC,IAAI,CAAC;AAChB,CAAC;AAlBD,wCAkBC;AAID,qBAA+B,QAAkB;IAC7C,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;QACZ,MAAM,IAAI,KAAK,CAAC,aAAa,CAAC,CAAC;IACnC,CAAC;IACD,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;QACjB,MAAM,IAAI,KAAK,CAAC,sBAAsB,CAAC,CAAC;IAC5C,CAAC;IACD,EAAE,CAAC,CAAC,QAAQ,CAAC,MAAM,GAAG,GAAG,IAAI,QAAQ,CAAC,MAAM,GAAG,GAAG,CAAC,CAAC,CAAC;QACjD,IAAM,OAAO,GAAG,qBAAmB,QAAQ,CAAC,MAAQ,CAAC;QACrD,MAAM,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC;IAC7B,CAAC;IACD,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;IACvC,MAAM,CAAC,IAAI,CAAC;AAChB,CAAC;AAbD,kCAaC;;;;;;;;;;;;;;;;;;;;ACzDD,oCAA6D;AAC7D,qCAAuC;AAMvC;IAA+B,6BAAY;IAA3C;;IACA,CAAC;IAAD,gBAAC;AAAD,CAAC,CAD8B,WAAI,GAClC;AADY,8BAAS;AAkBtB;IAA2B,yBAAoB;IAW3C,eAAa,IAAgB;eACzB,kBAAM,IAAI,IAAI,EAAE,CAAC;IACrB,CAAC;IAED,sBAAI,0BAAO;aAAX;YACI,IAAM,UAAU,GAAG,iBAAiB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YACjD,MAAM,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC;QACvC,CAAC;;;OAAA;IAED,mBAAG,GAAH,UAAI,GAAW;QACX,IAAM,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;QAC7B,IAAM,MAAM,GAAG,OAAO,GAAM,GAAG,SAAI,OAAS,GAAG,GAAG,CAAE;QACpD,MAAM,CAAC,MAAM,CAAC;IAClB,CAAC;IAED,oBAAI,GAAJ;QACI,MAAM,CAAC,IAAI,KAAK,CAAC,WAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;IACvC,CAAC;IAKD,uBAAO,GAAP,UAAQ,KAAY;QAChB,IAAM,IAAI,GAAG,cAAO,CAAS,IAAI,CAAC,KAAK,EAAE,KAAK,CAAC,IAAI,EAAE,CAAC,CAAC;QACvD,IAAM,MAAM,GAAG,IAAI,KAAK,CAAC,IAAI,CAAC,CAAC;QAC/B,MAAM,CAAC,MAAM,CAAC;IAClB,CAAC;IAEL,YAAC;AAAD,CAAC,CAvC0B,oBAAY,GAuCtC;AAvCY,sBAAK;AAiDlB,2BAAkC,IAA2B;IACzD,MAAM,CAAC,UAAG,CAAC,IAAI,EAAE,UAAC,GAAW,EAAE,KAAsB;QACjD,EAAE,CAAC,CAAC,OAAO,KAAK,KAAK,QAAQ,CAAC,CAAC,CAAC;YAC5B,KAAK,GAAG,KAAK,CAAC,QAAQ,EAAE,CAAC;QAC7B,CAAC;QACD,MAAM,CAAC;YACH,kBAAkB,CAAC,GAAG,CAAC;YACvB,kBAAkB,CAAC,KAAK,CAAC;SAC5B,CAAC;IACN,CAAC,CAAC,CAAC;AACP,CAAC;AAVD,8CAUC;AASD,yBAAgC,IAA2B;IACvD,MAAM,CAAC,gBAAS,CAAC,IAAI,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;AACrC,CAAC;AAFD,0CAEC;;;;;;;;;;AC/FD,mCAA4B;AAU5B;IAWI,yBACI,OAAgB,EAAE,QAAkB,EAAE,IAAU;QAEhD,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QACvB,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC;QAC1B,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QACjB,IAAI,CAAC,GAAG,GAAG,IAAI,SAAG,CAAC,iBAAiB,CAAC,CAAC;IAC1C,CAAC;IAqCD,8BAAI,GAAJ,UAAK,OAAgB;QACjB,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,MAAM,EAAE,EAAC,SAAS,EAAE,OAAO,EAAC,CAAC,CAAC;QAC7C,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IACxC,CAAC;IAEL,sBAAC;AAAD,CAAC;AA5DY,0CAAe;;;;;;;;;;;;;;;;;;;;ACC5B,wBAA+B,GAA0B;IACrD,MAAM,CAAC,CAAC,OAAO,GAAG,KAAK,QAAQ,IAAI,GAAG,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC;AACzD,CAAC;AAFD,wCAEC;AAED;IAII,eAAa,CAAS,EAAE,CAAS;QAC7B,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC;QACX,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC;IACf,CAAC;IAED,sBAAM,GAAN,UAAO,KAAY;QACf,MAAM,CAAC,CAAC,KAAK,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,IAAI,KAAK,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,CAAC,CAAC;IACtD,CAAC;IACL,YAAC;AAAD,CAAC;AAZY,sBAAK;AAelB;IAA6B,2BAAM;IAAnC;;IACA,CAAC;IAAD,cAAC;AAAD,CAAC,CAD4B,MAAM,GAClC;AADY,0BAAO;;;;;;;;;;ACvCpB,oCAA+B;AAa/B,IAAK,KAQJ;AARD,WAAK,KAAK;IACN,mCAAS;IACT,iCAAQ;IACR,qCAAU;IACV,uCAAW;IACX,mCAAS;IACT,yCAAY;AAEhB,CAAC,EARI,KAAK,KAAL,KAAK,QAQT;AAGD,IAAM,WAAW,GAA8B,EAAE,CAAC;AAElD,WAAW,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,OAAO,CAAC;AACnC,WAAW,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,SAAS,CAAC;AACvC,WAAW,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,OAAO,CAAC;AAUnC;IAGI,aAAa,IAAY;QACrB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;IACrB,CAAC;IAES,kBAAI,GAAd,UAAe,KAAY,EAAE,IAAY,EAAE,IAAW;QAClD,IAAM,UAAU,GAAG,WAAW,CAAC,KAAK,CAAC,CAAC;QACtC,IAAM,MAAM,GAAM,IAAI,CAAC,IAAI,UAAK,UAAU,UAAK,IAAM,CAAC;QACtD,GAAG,CAAC,CAAe,UAAiB,EAAjB,iBAAK,CAAC,IAAI,IAAI,EAAE,CAAC,EAAjB,cAAiB,EAAjB,IAAiB;YAA/B,IAAM,IAAI;YACJ,iBAAG,EAAE,eAAK,CAAS;YAE1B,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,GAAG,EAAE,KAAK,CAAC,CAAC;SACnC;IACL,CAAC;IAED,mBAAK,GAAL,UAAM,IAAY,EAAE,IAAW;QAC3B,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;IACvC,CAAC;IAED,qBAAO,GAAP,UAAQ,IAAY,EAAE,IAAW;QAC7B,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;IACzC,CAAC;IAED,mBAAK,GAAL,UAAM,IAAY,EAAE,IAAW;QAC3B,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;IACvC,CAAC;IACL,UAAC;AAAD,CAAC;AA5BY,kBAAG;;;;;;;;;;;;;;;;;;;;AC9BhB,oCAcgB;AAYhB;IAaI,eAAa,IAAa;QACtB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;IACtB,CAAC;IAKD,sBAAI,yBAAM;aAAV;YACI,MAAM,CAAC,aAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAC9B,CAAC;;;OAAA;IAKD,sBAAM,GAAN,UAAO,KAAe;QAClB,MAAM,CAAC,aAAM,CAAC,KAAK,CAAC,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;IAC3C,CAAC;IAKD,oBAAI,GAAJ;QACI,MAAM,CAAC,IAAI,KAAK,CAAI,WAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;IAC1C,CAAC;IAKD,uBAAO,GAAP,UAAQ,KAAe;QACnB,IAAM,IAAI,GAAG,cAAO,CAAI,IAAI,CAAC,KAAK,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC;QACjD,MAAM,CAAC,IAAI,KAAK,CAAI,IAAI,CAAC,CAAC;IAC9B,CAAC;IAKD,oBAAI,GAAJ;QACI,MAAM,CAAC,WAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IAC5B,CAAC;IAKD,mBAAG,GAAH,UAAI,GAAW;QACX,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IAC3B,CAAC;IAKD,oBAAI,GAAJ;QACI,MAAM,CAAC,WAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IAC5B,CAAC;IAKD,sBAAM,GAAN;QACI,MAAM,CAAC,aAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IAC9B,CAAC;IAKD,qBAAK,GAAL;QACI,MAAM,CAAC,YAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IAC7B,CAAC;IAMD,oBAAI,GAAJ,UAAK,QAAyB;QAC1B,WAAI,CAAC,IAAI,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;IAC/B,CAAC;IAMD,mBAAG,GAAH,UAAI,QAAyB;QACzB,MAAM,CAAC,IAAI,KAAK,CAAC,UAAG,CAAC,IAAI,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC,CAAC;IAChD,CAAC;IAEL,YAAC;AAAD,CAAC;AAjGY,sBAAK;AAoGlB;IAAqC,gCAAQ;IAA7C;;IAuCA,CAAC;IAhCG,0BAAG,GAAH,UAAI,GAAW,EAAE,KAAQ;QACrB,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;IAC5B,CAAC;IAKD,2BAAI,GAAJ;QACI,MAAM,CAAC,IAAI,YAAY,CAAC,WAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;IAC9C,CAAC;IAKD,8BAAO,GAAP,UAAQ,KAAe;QAEnB,IAAM,IAAI,GAAG,cAAO,CAAI,IAAI,CAAC,KAAK,EAAE,KAAK,CAAC,IAAI,EAAE,CAAC,CAAC;QAGlD,IAAM,MAAM,GAAG,IAAI,YAAY,CAAI,IAAI,CAAC,CAAC;QACzC,MAAM,CAAC,MAAM,CAAC;IAClB,CAAC;IAKD,6BAAM,GAAN,UAAO,KAAe;QAClB,GAAG,CAAC,CAAe,UAAa,EAAb,UAAK,CAAC,KAAK,EAAE,EAAb,cAAa,EAAb,IAAa;YAA3B,IAAM,IAAI;YACJ,iBAAG,EAAE,eAAK,CAAS;YAC1B,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;SACxB;IACL,CAAC;IACL,mBAAC;AAAD,CAAC,CAvCoC,KAAK,GAuCzC;AAvCY,oCAAY;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpIzB,gDAAyD;AACzD,wCAA2C;AAC3C,sCAAyC;AAGzC;IAAqC,mCAAe;IAGhD,yBAAa,QAAkB,EAAE,IAAU;QAA3C,iBAGC;QAFG,IAAM,OAAO,GAAG,IAAI,wBAAc,EAAE,CAAC;QACrC,0BAAM,OAAO,EAAE,QAAQ,EAAE,IAAI,CAAC,SAAC;;IACnC,CAAC;IAKK,kCAAQ,GAAd;;gBAIU,QAAQ,EACR,OAAO;;;;mCADI,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC;kCAClC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC;wBAC9B,WAAM,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;;mCAAxB,SAAwB;wBACzC,WAAO,sBAAc,CAAC,QAAQ,CAAC,EAAC;;;;KACnC;IACL,sBAAC;AAAD,CAAC,CApBoC,kCAAe,GAoBnD;AApBY,0CAAe;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACP5B,mCAAgC;AAKhC,gDAAyD;AACzD,wCAA6C;AAC7C,sCAAyC;AAGzC;IAAuC,qCAAe;IAGlD,2BAAa,QAAkB,EAAE,IAAU;QAA3C,iBAIC;QAHG,IAAM,OAAO,GAAG,IAAI,0BAAgB,EAAE,CAAC;QACvC,0BAAM,OAAO,EAAE,QAAQ,EAAE,IAAI,CAAC,SAAC;QAC/B,KAAI,CAAC,GAAG,GAAG,IAAI,SAAG,CAAC,WAAW,CAAC,CAAC;;IACpC,CAAC;IAMK,mCAAO,GAAb,UACI,OAAgB,EAEhB,QAA8B;;gBASxB,QAAQ,EACR,OAAO;;;;wBANb,QAAQ,GAAG,QAAQ,IAAI,QAAQ,CAAC;wBAChC,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;4BACX,MAAM,IAAI,KAAK,CAAC,4BAA4B,CAAC,CAAC;wBAClD,CAAC;mCAEgB,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,SAAS,CAAC;kCACjC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE;4BAC5C,UAAU,EAAE,QAAQ;4BACpB,SAAS,EAAE,kBAAkB,CAAC,OAAiB,CAAC;yBACnD,CAAC;wBACe,WAAM,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;;mCAAxB,SAAwB;wBACzC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,SAAS,EAAE,EAAC,UAAU,EAAE,QAAQ,EAAC,CAAC,CAAC;wBAClD,WAAO,sBAAc,CAAC,QAAQ,CAAC,EAAC;;;;KACnC;IAMK,2CAAe,GAArB,UAAsB,WAAwB,EAAE,QAAiB;;gBAMvD,QAAQ,EACR,OAAO;;;;wBAJb,EAAE,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC;4BACf,MAAM,IAAI,KAAK,CAAC,qCAAqC,CAAC,CAAC;wBAC3D,CAAC;mCACgB,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,SAAS,CAAC;kCACjC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE;4BAC5C,UAAU,EAAE,QAAQ,IAAI,QAAQ;4BAChC,GAAG,EAAE,WAAW,CAAC,CAAC,CAAC;4BACnB,GAAG,EAAE,WAAW,CAAC,CAAC,CAAC;yBACtB,CAAC;wBACe,WAAM,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;;mCAAxB,SAAwB;wBACzC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,iBAAiB,EAAE,EAAC,UAAU,EAAE,QAAQ,EAAC,CAAC,CAAC;wBAC1D,WAAO,sBAAc,CAAC,QAAQ,CAAC,EAAC;;;;KACnC;IACL,wBAAC;AAAD,CAAC,CAvDsC,kCAAe,GAuDrD;AAvDY,8CAAiB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACP9B,gDAAyD;AACzD,wCAA2C;AAC3C,sCAAgC;AAEhC,wCAA8E;AAG9E;IAAqC,mCAAe;IAGhD,yBAAa,QAAkB,EAAE,IAAU;QAA3C,iBAGC;QAFG,IAAM,OAAO,GAAG,IAAI,wBAAc,EAAE,CAAC;QACrC,0BAAM,OAAO,EAAE,QAAQ,EAAE,IAAI,CAAC,SAAC;;IACnC,CAAC;IAaK,+BAAK,GAAX,UAAY,SAAqB,EAAE,QAA8B;;gBAMvD,OAAO,mBACF,GAAG,EACN,GAAG,EAYG,QAAQ,EAMhB,QAAQ,EACR,OAAO;;;;wBA1Bb,QAAQ,GAAG,QAAQ,IAAI,QAAQ,CAAC;wBAChC,EAAE,CAAC,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;4BACvB,MAAM,IAAI,KAAK,CAAC,sCAAsC,CAAC,CAAC;wBAC5D,CAAC;kCAEyB,EAAE;wBAC5B,GAAG,CAAC,kCAAc,uBAAS,EAAT,IAAS;;;4BAEvB,EAAE,CAAC,CAAC,OAAO,GAAG,KAAK,QAAQ,CAAC,CAAC,CAAC;gCAC1B,GAAG,GAAG,GAAG,CAAC;4BACd,CAAC;4BACD,IAAI,CAAC,EAAE,CAAC,CAAC,GAAG,YAAY,gBAAK,CAAC,CAAC,CAAC;gCAC5B,GAAG,GAAM,GAAG,CAAC,CAAC,SAAI,GAAG,CAAC,CAAG,CAAC;4BAC9B,CAAC;4BACD,IAAI,CAAC,EAAE,CAAC,CAAC,yBAAc,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;gCAE3B,GAAG,GAAM,GAAG,CAAC,CAAC,CAAC,SAAI,GAAG,CAAC,CAAC,CAAG,CAAC;4BAChC,CAAC;4BACD,IAAI,CAAC,CAAC;2CACe,CAAC,OAAO,GAAG,CAAC;gCAC7B,MAAM,IAAI,KAAK,CAAC,gCAA8B,QAAU,CAAC,CAAC;4BAC9D,CAAC;4BACD,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;yBACrB;mCAEgB,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,WAAW,CAAC;kCACnC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE;4BAC5C,UAAU,EAAE,QAAQ;4BACpB,WAAW,EAAE,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE;yBACvC,CAAC;wBACe,WAAM,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;;mCAAxB,SAAwB;wBACzC,WAAO,aAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAC;;;;KAChC;IACL,sBAAC;AAAD,CAAC,CArDoC,kCAAe,GAqDnD;AArDY,0CAAe;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACP5B,gDAAyD;AACzD,wCAA0C;AAC1C,sCAGiB;AAGjB;IAAoC,kCAAe;IAG/C,wBAAa,QAAkB,EAAE,IAAU;QAA3C,iBAGC;QAFG,IAAM,OAAO,GAAG,IAAI,uBAAa,EAAE,CAAC;QACpC,0BAAM,OAAO,EAAE,QAAQ,EAAE,IAAI,CAAC,SAAC;;IACnC,CAAC;IAEK,+BAAM,GAAZ,UAEI,IAAY,EACZ,UAA8B,EAC9B,gBAA6B,EAC7B,aAAyB;QAFzB,2CAAwB,KAAK,CAAC;QAC9B,wDAA6B;QAC7B,iDAAyB;;gBAEnB,QAAQ,EACR,GAAG,EACH,OAAO;;;;mCAFI,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,QAAQ,CAAC;8BACpC,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC;kCAChB,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE;4BAC5C,MAAM,EAAE,IAAI;4BACZ,KAAK,EAAE,GAAG;4BACV,kBAAkB,EAAE,gBAAgB;4BACpC,eAAe,EAAE,aAAa;yBACjC,CAAC;wBACe,WAAM,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;;mCAAxB,SAAwB;wBACzC,WAAO,4BAAoB,CAAC,QAAQ,CAAC,EAAC;;;;KACzC;IAEK,oCAAW,GAAjB;;gBACU,QAAQ,EACR,OAAO;;;;mCADI,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,aAAa,CAAC;kCACrC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,EAAE,CAAC;wBAClC,WAAM,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;;mCAAxB,SAAwB;wBACzC,WAAO,4BAAoB,CAAC,QAAQ,CAAC,EAAC;;;;KACzC;IAEK,uCAAc,GAApB;;gBACU,QAAQ,EACR,OAAO;;;;mCADI,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,YAAY,CAAC;kCACpC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,EAAE,CAAC;wBAClC,WAAM,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;;mCAAxB,SAAwB;wBACzC,WAAO,+BAAuB,CAAC,QAAQ,CAAC,EAAC;;;;KAC5C;IAEK,2CAAkB,GAAxB,UAAyB,QAAgB,EAAE,CAAS;;gBAC1C,QAAQ,EACR,OAAO;;;;mCADI,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,oBAAoB,CAAC;kCAC5C,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE;4BAC5C,UAAU,EAAE,QAAQ;4BACpB,GAAG,EAAE,CAAC;yBACT,CAAC;wBACe,WAAM,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;;mCAAxB,SAAwB;wBACzC,WAAO,4BAAoB,CAAC,QAAQ,CAAC,EAAC;;;;KACzC;IACL,qBAAC;AAAD,CAAC,CAlDmC,kCAAe,GAkDlD;AAlDY,wCAAc;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACR3B,qCAA4D;AAC5D,gDAAyD;AACzD,wCAAyC;AACzC,sCAA0C;AAI1C;IAAmC,iCAAe;IAG9C,uBAAa,QAAkB,EAAE,IAAU;QAA3C,iBAGC;QAFG,IAAM,OAAO,GAAG,IAAI,sBAAY,EAAE,CAAC;QACnC,0BAAM,OAAO,EAAE,QAAQ,EAAE,IAAI,CAAC,SAAC;;IACnC,CAAC;IAKK,iCAAS,GAAf,UAAgB,QAAkB,EAAE,QAAkB;;gBAS5C,QAAQ,EACR,OAAO;;;;wBARb,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;4BACZ,MAAM,IAAI,iBAAU,CAAC,sBAAsB,CAAC,CAAC;wBACjD,CAAC;wBACD,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;4BACZ,MAAM,IAAI,iBAAU,CAAC,sBAAsB,CAAC,CAAC;wBACjD,CAAC;mCAEgB,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,WAAW,CAAC;kCACnC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE;4BAC5C,UAAU,EAAE,QAAkB;4BAC9B,UAAU,EAAE,QAAkB;yBACjC,CAAC;wBACe,WAAM,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;;mCAAxB,SAAwB;wBACzC,WAAO,uBAAe,CAAC,QAAQ,CAAC,EAAC;;;;KACpC;IAKK,iCAAS,GAAf;;gBACU,QAAQ,EACR,OAAO;;;;mCADI,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,WAAW,CAAC;kCACnC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,EAAE,CAAC;wBAClC,WAAM,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;;mCAAxB,SAAwB;wBAGzC,WAAO,QAAQ,EAAC;;;;KACnB;IAEK,kCAAU,GAAhB;;;;;;KAEC;IAEK,iCAAS,GAAf,UAAgB,QAAkB,EAAE,QAAkB;;;;;;KAErD;IAEL,oBAAC;AAAD,CAAC,CAjDkC,kCAAe,GAiDjD;AAjDY,sCAAa;;;;;;;;;;;;;;;;;;;;ACT1B,uCAAoC;AAEpC;IAAiC,+BAAK;IAAtC;;IACA,CAAC;IAAD,kBAAC;AAAD,CAAC,CADgC,KAAK,GACrC;AADY,kCAAW;AAGxB;IAII,cAAa,GAAQ,EAAE,OAAiB;QACpC,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC;QAIf,IAAM,KAAK,GAAG,qBAAqB,CAAC;QACpC,IAAM,KAAK,GAAG,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;QAC/B,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;YACT,MAAM,IAAI,WAAW,CACjB,2CAAyC,GAAK,CACjD,CAAC;QACN,CAAC;QACD,IAAI,CAAC,OAAO,GAAG,OAAO,IAAI,IAAI,iBAAO,EAAE,CAAC;IAC5C,CAAC;IACL,WAAC;AAAD,CAAC;AAlBY,oBAAI;;;;;;;;;;;;;;;;;;;;ACAjB,sCAAyC;AACzC,qCAAgC;AAChC,uCAAgD;AAWhD;IAAuC,qCAAU;IAAjD;;IACA,CAAC;IAAD,wBAAC;AAAD,CAAC,CADsC,oBAAU,GAChD;AADY,8CAAiB;AAI9B;IAAoC,kCAAa;IAAjD;QAAA,qEAGC;QAFY,UAAI,GAAW,gBAAgB,CAAC;;IAE7C,CAAC;IAAD,qBAAC;AAAD,CAAC,CAHmC,sBAAa,GAGhD;AAHY,wCAAc;AAiB3B;IAUI,iBAEI,MAAc,EAEd,GAAQ,EAER,KAAa,EAEb,IAAW,EAEX,OAAiB;QAEjB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,EAAE,CAAC,CAAC,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;YACxB,MAAM,IAAI,cAAc,CACpB,+CAA+C,CAClD,CAAC;QACN,CAAC;QACD,IAAI,CAAC,IAAI,GAAG,GAAU,CAAC;QACvB,IAAI,CAAC,KAAK,GAAG,KAAK,IAAI,IAAI,aAAK,EAAE,CAAC;QAClC,IAAI,CAAC,OAAO,GAAG,OAAO,IAAI,IAAI,iBAAO,EAAE,CAAC;QACxC,IAAI,CAAC,IAAI,GAAG,IAAI,IAAI,EAAU,CAAC;IACnC,CAAC;IAED,wBAAM,GAAN,UAAO,OAAgB;QACnB,MAAM,CAAC,CACH,OAAO,CAAC,MAAM,KAAK,IAAI,CAAC,MAAM;eAC3B,OAAO,CAAC,GAAG,KAAK,IAAI,CAAC,GAAG;eACxB,OAAO,CAAC,IAAI,KAAK,IAAI,CAAC,IAAI;eAC1B,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC;eAChC,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAC1C,CAAC;IACN,CAAC;IAED,sBAAI,GAAJ;QACI,MAAM,CAAC,IAAI,OAAO,CACd,IAAI,CAAC,MAAM,EACX,IAAI,CAAC,IAAI,EAET,IAAI,CAAC,KAAK,EACV,IAAI,CAAC,IAAI,EAET,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,GAAG,IAAI,CAAC,OAAO,CACpD,CAAC;IACN,CAAC;IAED,sBAAI,wBAAG;aAAP;YACI,IAAI,MAAc,CAAC;YACnB,IAAM,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC;YACxC,EAAE,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC;gBACf,MAAM,GAAM,IAAI,CAAC,IAAI,SAAI,YAAc,CAAC;YAC5C,CAAC;YACD,IAAI,CAAC,CAAC;gBACF,MAAM,GAAG,IAAI,CAAC,IAAc,CAAC;YACjC,CAAC;YACD,MAAM,CAAC,MAAM,CAAC;QAClB,CAAC;;;OAAA;IACL,cAAC;AAAD,CAAC;AAnEY,0BAAO;;;;;;;;;;;;;;;;;;;;AClCpB,sCAAyC;AACzC,uCAAgD;AAMhD;IAAwC,sCAAU;IAAlD;;IACA,CAAC;IAAD,yBAAC;AAAD,CAAC,CADuC,oBAAU,GACjD;AADY,gDAAkB;AAI/B;IAAqC,mCAAa;IAAlD;;IACA,CAAC;IAAD,sBAAC;AAAD,CAAC,CADoC,sBAAa,GACjD;AADY,0CAAe;AAQ5B;IAYI,kBACI,MAAc,EACd,OAAwD,EACxD,IAAa;QAEb,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,EAAE,CAAC,CAAC,OAAO,YAAY,iBAAO,CAAC,CAAC,CAAC;YAC7B,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC;QAC5B,CAAC;QACD,IAAI,CAAC,EAAE,CAAC,CAAC,OAAO,YAAY,QAAQ,CAAC,CAAC,CAAC;YACnC,IAAI,CAAC,YAAY,GAAG,OAAO,CAAC;QAChC,CAAC;QACD,IAAI,CAAC,CAAC;YACF,IAAI,CAAC,QAAQ,GAAG,IAAI,iBAAO,CAAC,OAAO,IAAI,EAAE,CAAC,CAAC;QAC/C,CAAC;QACD,IAAI,CAAC,IAAI,GAAG,IAAI,IAAI,EAAE,CAAC;IAC3B,CAAC;IAED,sBAAI,6BAAO;aAAX;YACI,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;gBACjB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,YAAY,EAAE,CAAC;YACxC,CAAC;YACD,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC;QACzB,CAAC;;;OAAA;IACL,eAAC;AAAD,CAAC;AApCY,4BAAQ;;;;;;;;;;;;;;;;;;;;ACnBrB,wCAAgD;AAChD,sCAAyC;AAGzC;IAAA;IAKA,CAAC;IAAD,mBAAC;AAAD,CAAC;AALY,oCAAY;AAWzB;IAAA;IAMA,CAAC;IAAD,kBAAC;AAAD,CAAC;AANY,kCAAW;AAaxB;IAA6B,2BAAK;IAO9B,iBACW,OAAgB,EAChB,MAAc,EACd,KAAa,EACb,CAAS,EACT,CAAS;QALpB,YAOI,kBAAM,CAAC,EAAE,CAAC,CAAC,SACd;QAPU,aAAO,GAAP,OAAO,CAAS;QAChB,YAAM,GAAN,MAAM,CAAQ;QACd,WAAK,GAAL,KAAK,CAAQ;QACb,OAAC,GAAD,CAAC,CAAQ;QACT,OAAC,GAAD,CAAC,CAAQ;;IAGpB,CAAC;IAEM,aAAK,GAAZ,UAAa,QAAkB;QAC3B,MAAM,CAAC,sBAAc,CAAC,QAAQ,CAAC,CAAC;IACpC,CAAC;IAEL,cAAC;AAAD,CAAC,CArB4B,gBAAK,GAqBjC;AArBY,0BAAO;;;;;;;;;;;;;;;;;;;;ACjCpB,qCAA6C;AAC7C,wCAAkD;AAGlD;IAAyB,8BAAK;IAA9B;;IAAgC,CAAC;IAAD,iBAAC;AAAD,CAAC,CAAR,KAAK,GAAG;AAGjC,wBAA+B,QAAkB;IAC7C,IAAM,IAAI,GAAG,sBAAc,CAAe,QAAQ,CAAC,CAAC;IAEpD,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,UAAC,IAAI;QAC/B,MAAM,CAAC,IAAI,iBAAO,CAEd,IAAI,CAAC,cAAc,EAEnB,IAAI,CAAC,eAAe,EAEpB,IAAI,CAAC,KAAK,EAEV,IAAI,CAAC,CAAC,EACN,IAAI,CAAC,CAAC,CACT,CAAC;IACN,CAAC,CAAC,CAAC;AACP,CAAC;AAhBD,wCAgBC;;;;;;;;;;;;;;;;;;;;ACtBD,sCAAsC;AAMtC;IAAA;IAGA,CAAC;IAAD,mBAAC;AAAD,CAAC;AAED;IAA2B,gCAAM;IAAjC;;IACA,CAAC;IAAD,mBAAC;AAAD,CAAC,CAD0B,MAAM,GAChC;AAED;IAAuB,4BAAM;IAA7B;;IACA,CAAC;IAAD,eAAC;AAAD,CAAC,CADsB,MAAM,GAC5B;AAED;IAAuB,4BAAM;IAA7B;;IACA,CAAC;IAAD,eAAC;AAAD,CAAC,CADsB,MAAM,GAC5B;AAKD;IAAA;IAKA,CAAC;IAAD,eAAC;AAAD,CAAC;AAKD;IAAA;IAIA,CAAC;IAAD,cAAC;AAAD,CAAC;AAMD;IAAA;IASA,CAAC;IAAD,gBAAC;AAAD,CAAC;AATY,8BAAS;AAYtB;IAMI,eACI,IAAW,EACX,QAAkB,EAClB,QAAkB,EAClB,MAAgB;QAEhB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;QAClB,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACzB,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACzB,IAAI,CAAC,OAAO,GAAG,MAAM,IAAI,EAAE,CAAC;IAChC,CAAC;IAEM,WAAK,GAAZ,UAAa,QAAkB;QAC3B,MAAM,CAAC,mBAAW,CAAC,QAAQ,CAAC,CAAC;IACjC,CAAC;IAED,sBAAI,uBAAI;aAAR;YACI,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC;QACtB,CAAC;;;OAAA;IAED,sBAAI,wBAAK;aAAT;YACI,IAAM,KAAK,GAAW,EAAE,CAAC;YACzB,GAAG,CAAC,CAAc,UAAS,EAAT,SAAI,CAAC,IAAI,EAAT,cAAS,EAAT,IAAS;gBAAtB,IAAM,GAAG;gBACV,KAAK,CAAC,IAAI,OAAV,KAAK,EAAS,GAAG,CAAC,KAAK,EAAE;aAC5B;YACD,MAAM,CAAC,KAAK,CAAC;QACjB,CAAC;;;OAAA;IAED,sBAAI,yBAAM;aAAV;YACI,IAAM,MAAM,GAAY,EAAE,CAAC;YAC3B,GAAG,CAAC,CAAe,UAAU,EAAV,SAAI,CAAC,KAAK,EAAV,cAAU,EAAV,IAAU;gBAAxB,IAAM,IAAI;gBACX,MAAM,CAAC,IAAI,OAAX,MAAM,EAAS,IAAI,CAAC,MAAM,EAAE;aAC/B;YACD,MAAM,CAAC,MAAM,CAAC;QAClB,CAAC;;;OAAA;IAED,sBAAI,+BAAY;aAAhB;YACI,IAAM,KAAK,GAAG,EAAE,CAAC;YACjB,GAAG,CAAC,CAAe,UAAU,EAAV,SAAI,CAAC,KAAK,EAAV,cAAU,EAAV,IAAU;gBAAxB,IAAM,IAAI;gBACX,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;aACjC;YACD,MAAM,CAAC,KAAK,CAAC;QACjB,CAAC;;;OAAA;IAED,wBAAQ,GAAR,UAAS,GAAW,EAAE,IAAY,EAAE,KAAa;QAC7C,GAAG,GAAG,GAAG,IAAI,CAAC,CAAC;QACf,IAAI,GAAG,IAAI,IAAI,CAAC,CAAC;QACjB,KAAK,GAAG,KAAK,IAAI,CAAC,CAAC;IACvB,CAAC;IACL,YAAC;AAAD,CAAC;AAvDY,sBAAK;AA0DlB;IAKI,aAAa,KAAa,EAAE,QAAgB,EAAE,QAAgB;QAC1D,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;QACpB,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACzB,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;IAC7B,CAAC;IAED,sBAAI,sBAAK;aAAT;YACI,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC;QACvB,CAAC;;;OAAA;IAED,sBAAI,uBAAM;aAAV;YACI,IAAM,MAAM,GAAY,EAAE,CAAC;YAC3B,GAAG,CAAC,CAAe,UAAU,EAAV,SAAI,CAAC,KAAK,EAAV,cAAU,EAAV,IAAU;gBAAxB,IAAM,IAAI;gBACX,MAAM,CAAC,IAAI,OAAX,MAAM,EAAS,IAAI,CAAC,MAAM,EAAE;aAC/B;YACD,MAAM,CAAC,MAAM,CAAC;QAClB,CAAC;;;OAAA;IAED,sBAAI,6BAAY;aAAhB;YACI,IAAM,KAAK,GAAG,EAAE,CAAC;YACjB,GAAG,CAAC,CAAe,UAAU,EAAV,SAAI,CAAC,KAAK,EAAV,cAAU,EAAV,IAAU;gBAAxB,IAAM,IAAI;gBACX,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;aACjC;YACD,MAAM,CAAC,KAAK,CAAC;QACjB,CAAC;;;OAAA;IAEL,UAAC;AAAD,CAAC;AA/BY,kBAAG;AAkChB;IAMI,cACI,MAAe,EACf,YAA0B,EAC1B,QAAkB,EAClB,QAAkB;QAElB,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;QACtB,IAAI,CAAC,YAAY,GAAG,YAAY,CAAC;QACjC,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACzB,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;IAC7B,CAAC;IAED,sBAAI,wBAAM;aAAV;YACI,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC;QACxB,CAAC;;;OAAA;IACL,WAAC;AAAD,CAAC;AArBY,oBAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7IjB,uCAAuC;AACvC,yCAA2C;AAE3C,oCAA6B;AAM7B;IAAqC,mCAAY;IAM7C,yBAAa,OAAgB,EAAE,OAAgB;QAA/C,YACI,kBAAM,OAAO,CAAC,SAGjB;QAFG,KAAI,CAAC,OAAO,GAAG,OAAO,IAAI,CAAC,CAAC;QAC5B,KAAI,CAAC,GAAG,GAAG,KAAI,CAAC,OAAO,EAAE,CAAC;;IAC9B,CAAC;IAKO,iCAAO,GAAf;QAAA,iBAiBC;QAhBG,IAAM,GAAG,GAAG,IAAI,SAAG,CAAC,IAAI,CAAC,OAAO,IAAI,CAAC,CAAC,CAAC;QAGvC,IAAM,MAAM,GAAG,UAAC,IAAY,EAAE,QAAkB;YAC5C,IAAM,KAAK,GAAG,QAAQ,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;YAClC,GAAG,CAAC,MAAM,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;QAE5B,CAAC,CAAC;QACF,MAAM,CAAC,WAAW,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;QACvC,MAAM,CAAC,UAAU,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;QACrC,MAAM,CAAC,MAAM,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;QAC7B,MAAM,CAAC,SAAS,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;QACnC,MAAM,CAAC,OAAO,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC/B,MAAM,CAAC,OAAO,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC/B,MAAM,CAAC,SAAS,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;QACnC,MAAM,CAAC,GAAG,CAAC;IACf,CAAC;IAES,gCAAM,GAAhB,UAAiB,KAAa;QAC1B,iBAAM,MAAM,YAAC,KAAK,CAAC,CAAC;IACxB,CAAC;IAEY,iCAAO,GAApB;;gBACU,OAAO,EAQP,IAAI;;;;kCARM,CACZ,IAAI,CAAC,OAAO,CAAC,OAAO;8BAClB,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,KAAK,EAAE;8BAC5B,EAAE,CACP;wBAED,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;+BAEP,IAAI,CAAC,OAAO,CAAC,IAAI,IAAI,EAAE;wBACpC,IAAI,CAAC,GAAG,CAAC,KAAK,CACV,IAAI,CAAC,OAAO,CAAC,MAAM,EACnB,IAAI,CAAC,OAAO,CAAC,GAAG,EAChB,OAAO,EACP,IAAc,CACjB,CAAC;wBACF,WAAM,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE;;wBAAxB,SAAwB,CAAC;wBACzB,WAAO,IAAI,CAAC,QAAQ,EAAC;;;;KACxB;IAQD,sBAAI,qCAAQ;aAAZ;YAEI,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC;QAC7B,CAAC;;;OAAA;IAEM,+BAAK,GAAZ;QACI,EAAE,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;YACX,IAAI,CAAC,GAAG,CAAC,KAAK,EAAE,CAAC;QACrB,CAAC;QACD,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;IACxB,CAAC;IAWD,sCAAY,GAAZ,UAAa,EAAiB;QAC1B,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,EAAE,CAAC,CAAC;IAChD,CAAC;IAOD,qCAAW,GAAX,UAAY,EAAiB;QACzB,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,EAAE,CAAC,CAAC;IAChD,CAAC;IAOD,iCAAO,GAAP,UAAQ,EAAW;QACf,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;IACxB,CAAC;IAOD,oCAAU,GAAV,UAAW,EAAiB;QACxB,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,EAAE,CAAC,CAAC;QAC5C,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;IAC3B,CAAC;IAOD,kCAAQ,GAAR,UAAS,EAAmB;QACxB,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;IACzB,CAAC;IAOD,kCAAQ,GAAR,UAAS,EAAmB;QACxB,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;QAChB,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;IACzB,CAAC;IAOD,oCAAU,GAAV,UAAW,EAAiB;QACxB,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;QACvB,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,EAAE,CAAC,CAAC;IAChD,CAAC;IACL,sBAAC;AAAD,CAAC,CAjJoC,uBAAY,GAiJhD;AAjJY,0CAAe;AAuJ5B;IAAmC,iCAAU;IACzC;eACI,kBAAM,eAAe,CAAC;IAC1B,CAAC;IACL,oBAAC;AAAD,CAAC,CAJkC,mBAAU,GAI5C;AAJY,sCAAa;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvK1B,oCAA+B;AAC/B,mCAA4B;AAG5B,sCAAyC;AAGzC,qCAA8B;AAG9B,wCAAoC;AAEpC,uCAAoC;AAOpC,yCAA0D;AAI1D,yCAA8D;AAC9D,yCAA8D;AAC9D,yCAAkE;AAClE,yCAA4D;AAE5D;IAAuB,4BAAM;IAA7B;;IACA,CAAC;IAAD,eAAC;AAAD,CAAC,CADsB,MAAM,GAC5B;AAMD;IA4DI,kBACW,OAAwC,EACvC,MAAc,EACf,IAAU,EACV,KAAe;QAHf,YAAO,GAAP,OAAO,CAAiC;QACvC,WAAM,GAAN,MAAM,CAAQ;QACf,SAAI,GAAJ,IAAI,CAAM;QACV,UAAK,GAAL,KAAK,CAAU;QAT1B,oBAAe,GAAG,IAAI,iBAAO,CAAC;YAC1B,YAAY,EAAE,SAAS;YACvB,QAAQ,EAAE,kBAAkB;SAC/B,CAAC,CAAC;QAQC,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;YACX,MAAM,IAAI,sBAAa,CACnB,8CAA8C,CACjD,CAAC;QACN,CAAC;QACD,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;YACV,MAAM,IAAI,sBAAa,CACnB,oBAAoB,CACvB,CAAC;QACN,CAAC;QACD,EAAE,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,IAAI,YAAY,WAAI,CAAC,CAAC,CAAC,CAAC;YACnC,MAAM,IAAI,sBAAa,CACnB,2BAA2B,CAC9B,CAAC;QACN,CAAC;QACD,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QACjB,IAAI,CAAC,KAAK,GAAG,KAAK,IAAI,KAAK,CAAC;QAC5B,IAAI,CAAC,GAAG,GAAG,SAAS,CAAC;QACrB,IAAI,CAAC,GAAG,GAAG,IAAI,SAAG,CAAC,SAAS,CAAC,CAAC;QAG9B,IAAI,CAAC,MAAM,GAAG,IAAI,wBAAa,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;QAG5C,IAAI,CAAC,qBAAqB,CAAC,OAAO,CAAC,CAAC;IACxC,CAAC;IAEO,wCAAqB,GAA7B,UAA8B,OAAwC;QAClE,GAAG,CAAC,CAAe,UAAc,EAAd,iBAAK,CAAC,OAAO,CAAC,EAAd,cAAc,EAAd,IAAc;YAA5B,IAAM,IAAI;YACX,IAAM,MAAI,GAAW,IAAI,CAAC,CAAC,CAAC,CAAC;YAC7B,IAAM,GAAG,GAAkB,IAAI,CAAC,CAAC,CAAC,CAAC;YACnC,IAAM,QAAQ,GAAG,IAAI,GAAG,CAAC,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;YAC1C,IAAI,CAAC,oBAAoB,CAAC,QAAQ,CAAC,CAAC;SACvC;IACL,CAAC;IAEO,uCAAoB,GAA5B,UAA6B,QAAyB;QAElD,EAAE,CAAC,CAAC,QAAQ,YAAY,wBAAa,CAAC,CAAC,CAAC;YACpC,IAAI,CAAC,MAAM,GAAG,QAAQ,CAAC;QAC3B,CAAC;QACD,IAAI,CAAC,EAAE,CAAC,CAAC,QAAQ,YAAY,0BAAe,CAAC,CAAC,CAAC;YAC3C,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QAC7B,CAAC;QACD,IAAI,CAAC,EAAE,CAAC,CAAC,QAAQ,YAAY,4BAAiB,CAAC,CAAC,CAAC;YAC7C,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC;QAC9B,CAAC;QACD,IAAI,CAAC,EAAE,CAAC,CAAC,QAAQ,YAAY,0BAAe,CAAC,CAAC,CAAC;YAC3C,IAAI,CAAC,OAAO,GAAG,QAAQ,CAAC;QAC5B,CAAC;QACD,IAAI,CAAC,EAAE,CAAC,CAAC,QAAQ,YAAY,yBAAc,CAAC,CAAC,CAAC;YAC1C,IAAI,CAAC,MAAM,GAAG,QAAQ,CAAC;QAC3B,CAAC;IACL,CAAC;IAKD,0BAAO,GAAP,UAEI,MAAc,EAEd,GAAQ,EAER,KAAa,EAEb,IAAW,EAEX,OAAiB;QAEjB,OAAO,GAAG,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC;QACzC,IAAM,GAAG,GAAM,IAAI,CAAC,IAAI,CAAC,GAAG,SAAI,GAAK,CAAC;QACtC,MAAM,CAAC,IAAI,iBAAO,CAAC,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;IAC1D,CAAC;IAEO,mCAAgB,GAAxB,UAAyB,OAAiB;QACtC,IAAM,QAAQ,GAAY,CACtB,OAAO;cACL,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC;cACrC,IAAI,CAAC,eAAe,CAAC,IAAI,EAAE,CAChC,CAAC;QACF,EAAE,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;YACX,QAAQ,CAAC,GAAG,CAAC,eAAe,EAAE,YAAU,IAAI,CAAC,GAAG,CAAC,KAAO,CAAC,CAAC;QAC9D,CAAC;QACD,MAAM,CAAC,QAAQ,CAAC;IAEpB,CAAC;IAQK,wBAAK,GAAX,UAAY,QAAkB,EAAE,QAAkB;;gBACxC,QAAQ,EACV,GAAG;;;;mCADqC,IAAI,CAAC,MAAM;6BAEnD,QAAQ,EAAR,cAAQ;wBACF,WAAM,QAAQ,CAAC,SAAS,CAAC,QAAQ,EAAE,QAAQ,CAAC;;wBAAlD,GAAG,GAAG,SAA4C,CAAC;wBACnD,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC;;;wBAGf,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,2CAA2C,CAAC,CAAC;;4BAEhE,WAAO,GAAG,EAAC;;;;KACd;IASD,uBAAI,GAAJ,UAAK,OAAgB;QACjB,IAAM,OAAO,GAAG,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;QAEvD,OAAO,CAAC,OAAO,GAAG,OAAO,CAAC;QAC1B,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,eAAe,EAAE,EAAC,SAAS,EAAE,OAAO,EAAC,CAAC,CAAC;QACtD,IAAM,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QAC3C,MAAM,CAAC,QAAQ,CAAC;IACpB,CAAC;IAWa,6BAAU,GAAxB;;;gBACI,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC;oBAC/B,MAAM,IAAI,KAAK,CAAC,eAAe,CAAC,CAAC;gBACrC,CAAC;gBACD,WAAO,IAAI,CAAC,GAAG,EAAC;;;KACnB;IAEL,eAAC;AAAD,CAAC;AA9MY,4BAAQ;;;;;;;;;;ACnCrB,qCAA8B;AAK1B,eALK,WAAI,CAKL;AAIK,YAAI,GAAyB;IACtC,KAAK,EAAE,oCAAoC;IAC3C,MAAM,EAAE,qCAAqC;IAC7C,MAAM,EAAE,gCAAgC;IACxC,OAAO,EAAE,0BAA0B;CACtC,CAAC;AAGW,aAAK,GAA0B;IACxC,KAAK,EAAE,IAAI,WAAI,CAAC,YAAI,CAAC,GAAG,CAAC;IACzB,MAAM,EAAE,IAAI,WAAI,CAAC,YAAI,CAAC,IAAI,CAAC;IAC3B,MAAM,EAAE,IAAI,WAAI,CAAC,YAAI,CAAC,IAAI,CAAC;IAC3B,OAAO,EAAE,IAAI,WAAI,CAAC,YAAI,CAAC,KAAK,CAAC;CAChC,CAAC;;;;;;;;;;;;;;;;;;;;AChBF,sCAAwC;AAOxC;IAA8B,4BAAM;IAApC;;IACA,CAAC;IAAD,eAAC;AAAD,CAAC,CAD6B,MAAM,GACnC;AADY,4BAAQ;AAOrB;IAA8B,4BAAM;IAApC;;IACA,CAAC;IAAD,eAAC;AAAD,CAAC,CAD6B,MAAM,GACnC;AADY,4BAAQ;AAMrB;IAAA;IAGA,CAAC;IAAD,kBAAC;AAAD,CAAC;AAHY,kCAAW;AAQxB;IAAgC,8BAAY;IAA5C;;IACA,CAAC;IAAD,iBAAC;AAAD,CAAC,CAD+B,qBAAY,GAC3C;AADY,gCAAU;;;;;;;;;;;;;;;;;;;;ACrBvB,yCAAsC;AACtC,sCAAsC;AAItC,yCAA0D;AAC1D,yCAA8D;AAC9D,yCAA8D;AAC9D,yCAAkE;AAClE,yCAA4D;AAE5D,4CAG+B;AAM/B;IAA6B,2BAAQ;IACjC,iBAAa,GAAY,EAAE,KAAe;QAA1C,iBAiBC;QAhBG,GAAG,GAAG,GAAG,IAAI,MAAM,CAAC;QACpB,IAAM,IAAI,GAAS,aAAK,CAAC,GAAG,CAAC,CAAC;QAC9B,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;YACR,MAAM,IAAI,KAAK,CAAC,0BAAwB,GAAG,MAAG,CAAC,CAAC;QACpD,CAAC;QACD,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;YACZ,MAAM,IAAI,KAAK,CAAC,mBAAiB,GAAG,MAAG,CAAC,CAAC;QAC7C,CAAC;QACD,IAAM,OAAO,GAAoC;YAC7C,QAAQ,EAAE,wBAAa;YACvB,SAAS,EAAE,0BAAe;YAC1B,SAAS,EAAE,4BAAiB;YAC5B,SAAS,EAAE,0BAAe;YAC1B,QAAQ,EAAE,yBAAc;SAC3B,CAAC;QACF,0BAAM,OAAO,EAAE,IAAI,2BAAM,EAAE,EAAE,IAAI,EAAE,KAAK,CAAC,SAAC;;IAC9C,CAAC;IACL,cAAC;AAAD,CAAC,CAnB4B,mBAAQ,GAmBpC;AAnBY,0BAAO;;;;;;;;;;ACkBpB;IAeI,oBAAa,QAA6B;QACtC,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;IAC7B,CAAC;IASM,6BAAQ,GAAf,UAAgB,OAAgB;QAC5B,IAAM,QAAQ,GAAG,IAAI,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;QAC5C,MAAM,CAAC,QAAQ,CAAC;IACpB,CAAC;IAQM,yBAAI,GAAX,UAAY,OAAgB;QACxB,IAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;QAIxC,QAAQ,CAAC,KAAK,EAAE,CAAC;QACjB,MAAM,CAAC,QAAQ,CAAC;IACpB,CAAC;IACL,iBAAC;AAAD,CAAC;AA7CY,gCAAU;;;;;;;;;;AClDvB,IAAM,KAAK,GAAG,UAAU,CAAC;AAGzB,gBAAuB,QAAgB,EAAE,IAAmB;IACxD,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,KAAK,EAAE,UAAC,KAAK,EAAE,KAAK;QACxC,MAAM,CAAC,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,SAAS,CAAC,IAAI,EAAE,CAAC;IAClD,CAAC,CAAC,CAAC;AACP,CAAC;AAJD,wBAIC;;;;;;;;;;ACUD;IAAA;IAGA,CAAC;IAAD,6BAAC;AAAD,CAAC;AAHY,wDAAsB;AAQnC;IAmBI,kBAAa,IAAa,EAAE,KAAc;QACtC,IAAI,CAAC,KAAK,GAAG,CAAC,OAAO,IAAI,KAAK,WAAW,GAAG,GAAG,GAAG,IAAI,CAAC,CAAC;QACxD,IAAI,CAAC,MAAM,GAAG,CAAC,OAAO,KAAK,KAAK,WAAW,GAAG,GAAG,GAAG,KAAK,CAAC,CAAC;IAC/D,CAAC;IAKD,sBAAI,0BAAI;aAAR;YACI,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC;QACtB,CAAC;;;OAAA;IAKD,sBAAI,2BAAK;aAAT;YACI,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC;QACvB,CAAC;;;OAAA;IAKD,sBAAI,0BAAI;aAAR;YACI,EAAE,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBACpB,MAAM,CAAC,GAAG,CAAC;YACf,CAAC;YACD,MAAM,CAAC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC;QAClC,CAAC;;;OAAA;IAKD,sBAAI,6BAAO;aAAX;YACI,EAAE,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC,KAAK,KAAK,CAAC,CAAC,CAAC,CAAC;gBAC5D,MAAM,CAAC,GAAG,CAAC;YACf,CAAC;YACD,IAAM,IAAI,GAAG,KAAK,CAAC;YACnB,MAAM,CAAC,CAAC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC;QAC3C,CAAC;;;OAAA;IAOD,oCAAiB,GAAjB,UAAkB,EAA0B;QACxC,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC,MAAM,CAAC;QACvB,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC,KAAK,CAAC;IAC3B,CAAC;IAEL,eAAC;AAAD,CAAC;AArEY,4BAAQ;;;;;;;;;;ACtBrB;IAAA;IAcA,CAAC;IAAD,kBAAC;AAAD,CAAC;AAdY,kCAAW;AAwBxB;IAEI,iBAEW,QAAa,EACb,QAAkB,EAClB,WAAuB,EACvB,KAAa,EACb,QAAgB,EAChB,WAAmB,EACnB,WAAqB,EACrB,WAAmB,EACnB,SAA6B,EAC7B,SAAc;QATd,aAAQ,GAAR,QAAQ,CAAK;QACb,aAAQ,GAAR,QAAQ,CAAU;QAClB,gBAAW,GAAX,WAAW,CAAY;QACvB,UAAK,GAAL,KAAK,CAAQ;QACb,aAAQ,GAAR,QAAQ,CAAQ;QAChB,gBAAW,GAAX,WAAW,CAAQ;QACnB,gBAAW,GAAX,WAAW,CAAU;QACrB,gBAAW,GAAX,WAAW,CAAQ;QACnB,cAAS,GAAT,SAAS,CAAoB;QAC7B,cAAS,GAAT,SAAS,CAAK;IAQzB,CAAC;IACL,cAAC;AAAD,CAAC;AAtBY,0BAAO;;;;;;;;;;AC7BpB,uCAAyC;AAG5B,iBAAS,GAAG;IAErB,UAAU,EAAE,IAAI,kBAAQ,CAEpB,KAAK,EAAE,YAAY,CACtB;IAED,QAAQ,EAAE,IAAI,kBAAQ,CAClB,KAAK,EAAE,kBAAkB,CAC5B;CACJ,CAAC;;;;;;;;;;;;;;;;;;;;ACXF,qCAA0D;AAC1D,wCAAuE;AAGvE;IAAyB,8BAAK;IAA9B;;IAAgC,CAAC;IAAD,iBAAC;AAAD,CAAC,CAAR,KAAK,GAAG;AAGjC,wBAA+B,QAAkB;IAC7C,IAAM,OAAO,GAAkB,mBAAW,CAAc,QAAQ,CAAC,CAAC;IAClE,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,UAAC,MAAM;QACtB,MAAM,CAAC,IAAI,iBAAO,CAEd,MAAM,CAAC,QAAe,EAEtB,MAAM,CAAC,QAAoB,EAE3B,MAAM,CAAC,UAAwB,EAE/B,MAAM,CAAC,IAAI,EAEX,MAAM,CAAC,QAAQ,EAEf,MAAM,CAAC,WAAW,EAElB,MAAM,CAAC,UAAU,EAEjB,MAAM,CAAC,WAAW,EAElB,MAAM,CAAC,SAAS,EAEhB,MAAM,CAAC,QAAe,CACzB,CAAC;IACN,CAAC,CAAC,CAAC;AACP,CAAC;AA1BD,wCA0BC;;;;;;;;;;;;;;;;;;;;ACjCD,uCAAwC;AACxC,0CAAwC;AAMxC;IAAoC,kCAAO;IAEvC;eACI,kBAAM,qBAAS,CAAC;IACpB,CAAC;IAED,8BAAK,GAAL,UAAM,QAAkB;IACxB,CAAC;IACL,qBAAC;AAAD,CAAC,CARmC,iBAAO,GAQ1C;AARY,wCAAc;;;;;;;;;;ACT3B,uCAAyC;AAG5B,iBAAS,GAAG;IAErB,SAAS,EAAE,IAAI,kBAAQ,CACnB,KAAK,EAAE,uCAAuC,CACjD;IAED,SAAS,EAAE,IAAI,kBAAQ,CACnB,KAAK,EAAE,yCAAyC,CACnD;IAED,OAAO,EAAE,IAAI,kBAAQ,CACjB,KAAK,EAAE,2BAA2B,CACrC;IAED,QAAQ,EAAE,IAAI,kBAAQ,CAClB,KAAK,EAAE,iBAAiB,CAC3B;CACJ,CAAC;;;;;;;;;;;;;;;;;;;;ACnBF,uCAAkD;AAClD,wCAAiD;AACjD,0CAAwC;AAMxC;IAAsC,oCAAO;IACzC;eACI,kBAAM,qBAAS,CAAC;IACpB,CAAC;IAED,gCAAK,GAAL,UAAM,QAAkB;QACpB,MAAM,CAAC,iBAAO,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;IACnC,CAAC;IACL,uBAAC;AAAD,CAAC,CARqC,iBAAO,GAQ5C;AARY,4CAAgB;;;;;;;;;;ACT7B,uCAAyC;AACzC,qCAAoC;AAGvB,iBAAS,GAAG;IAOrB,UAAU,EAAE,IAAI,kBAAQ,CACpB,KAAK,EAAE,YAAY,CACtB;IAID,UAAU,EAAE,IAAI,kBAAQ,CACpB,KAAK,EACL;;;;qCAI6B,CAChC;IAED,SAAS,EAAE,IAAI,kBAAQ,CACnB,KAAK,EACL;;iDAEyC,CAC5C;IAID,WAAW,EAAE,IAAI,kBAAQ,CACrB,KAAK,EAAE,oBAAoB,EAC3B,UAAC,IAAI;QACD,IAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC;QAE1C,IAAM,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,QAAQ,EAAE,CAAC;QAC5C,MAAM,CAAC,IAAI,aAAK,CAAC;YACb,UAAU,EAAE,QAAQ;YACpB,WAAW,EAAE,SAAS;SACzB,CAAC,CAAC;IACP,CAAC,CACJ;IAED,OAAO,EAAE,IAAI,kBAAQ,CACjB,KAAK,EAAE,qBAAqB,CAC/B;IAED,WAAW,EAAE,IAAI,kBAAQ,CAErB,KAAK,EAAE,6BAA6B,EACpC,UAAC,IAAI;QACD,MAAM,CAAC,IAAI,aAAK,CAAC;YACb,UAAU,EAAE,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE;YAEpC,SAAS,EAAE,IAAI,CAAC,SAAS,CAAC,QAAQ,EAAE;YAEpC,SAAS,EAAE,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE;YAEnC,MAAM,EAAE,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;YAE5B,YAAY,EAAE,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE;YAExC,UAAU,EAAE,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE;SACvC,CAAC,CAAC;IACP,CAAC,CACJ;IAED,kBAAkB,EAAE,IAAI,kBAAQ,CAQ5B,KAAK,EAAE,qCAAqC,CAC/C;IAED,QAAQ,EAAE,IAAI,kBAAQ,CAClB,KAAK,EAAE,eAAe,CACzB;CACJ,CAAC;;;;;;;;;;;;;;;;;;;;ACrFF,qCAA6C;AAC7C,wCAAuC;AACvC,sCAAsD;AAGtD;IAAyB,8BAAK;IAA9B;;IAAgC,CAAC;IAAD,iBAAC;AAAD,CAAC,CAAR,KAAK,GAAG;AAGjC,qBAA4B,QAAkB;IAE1C,IAAM,IAAI,GAAG,sBAAc,CAAY,QAAQ,CAAC,CAAC;IAGjD,IAAM,IAAI,GAAG,EAAE,CAAC;IAChB,GAAG,CAAC,CAAmB,UAAS,EAAT,SAAI,CAAC,IAAI,EAAT,cAAS,EAAT,IAAS;QAA3B,IAAM,QAAQ;QACf,IAAM,KAAK,GAAG,EAAE,CAAC;QACjB,GAAG,CAAC,CAAoB,UAAc,EAAd,aAAQ,CAAC,KAAK,EAAd,cAAc,EAAd,IAAc;YAAjC,IAAM,SAAS;YAChB,IAAM,MAAM,GAAG,EAAE,CAAC;YAClB,GAAG,CAAC,CAAqB,UAA8B,EAA9B,cAAS,CAAC,QAAQ,CAAC,WAAW,EAA9B,cAA8B,EAA9B,IAA8B;gBAAlD,IAAM,UAAU;gBACjB,IAAM,KAAK,GAAG,IAAI,gBAAK,CAAC,UAAU,CAAC,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;gBACtD,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;aACtB;YACD,IAAM,IAAI,GAAG,IAAI,YAAI,CACjB,MAAM,EACN,SAAS,CAAC,YAAY,EACtB,SAAS,CAAC,QAAQ,EAClB,SAAS,CAAC,QAAQ,CACrB,CAAC;YACF,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SACpB;QACD,IAAM,GAAG,GAAG,IAAI,WAAG,CAAC,KAAK,EAAE,QAAQ,CAAC,QAAQ,EAAE,QAAQ,CAAC,QAAQ,CAAC,CAAC;QACjE,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;KAClB;IACD,IAAM,KAAK,GAAG,IAAI,aAAK,CACnB,IAAI,EACJ,IAAI,CAAC,QAAQ,EACb,IAAI,CAAC,QAAQ,CAChB,CAAC;IACF,MAAM,CAAC,KAAK,CAAC;AACjB,CAAC;AA/BD,kCA+BC;;;;;;;;;;;;;;;;;;;;ACvCD,uCAAsD;AACtD,0CAAwC;AAGxC;IAAyC,uCAAY;IAArD;;IACA,CAAC;IAAD,0BAAC;AAAD,CAAC,CADwC,sBAAY,GACpD;AADY,kDAAmB;AAOhC;IAAoC,kCAAO;IAGvC;eACI,kBAAM,qBAAS,CAAC;IACpB,CAAC;IACL,qBAAC;AAAD,CAAC,CANmC,iBAAO,GAM1C;AANY,wCAAc;;;;;;;;;;ACZ3B,qCAAoC;AACpC,uCAAyC;AAGzC;IAAA;IAKA,CAAC;IAAD,iBAAC;AAAD,CAAC;AAID,IAAM,kBAAkB,GAAG;IACvB,IAAI;IACJ,KAAK;IACL,KAAK;IACL,MAAM;IACN,IAAI;IACJ,KAAK;IACL,MAAM;CACT,CAAC;AAIW,iBAAS,GAAG;IAErB,QAAQ,EAAE,IAAI,kBAAQ,CAClB,KAAK,EACL,UAAU,EAEV,UAAC,IAAI;QACD,MAAM,CAAC,IAAI,aAAK,CAAC;YACb,GAAG,EAAE,CAAC,IAAI,CAAC,IAAI,IAAI,EAAE,CAAC,CAAC,QAAQ,EAAE;YACjC,KAAK,EAAE,CAAC,IAAI,CAAC,UAAU,IAAI,KAAK,CAAC,CAAC,QAAQ,EAAE;YAC5C,GAAG,EAAE,CAAC,IAAI,CAAC,gBAAgB,IAAI,EAAE,CAAC,CAAC,QAAQ,EAAE;YAC7C,IAAI,EAAE,CAAC,IAAI,CAAC,aAAa,IAAI,CAAC,CAAC,CAAC,QAAQ,EAAE;SAC7C,CAAC,CAAC;IACP,CAAC,CACJ;IAED,aAAa,EAAE,IAAI,kBAAQ,CACvB,KAAK,EACL,eAAe,CAClB;IAGD,YAAY,EAAE,IAAI,kBAAQ,CACtB,KAAK,EACL,qBAAqB,CACxB;IAID,oBAAoB,EAAE,IAAI,kBAAQ,CAC9B,KAAK,EACL,+BAA+B,EAC/B,UAAC,IAAI;QACD,IAAI,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC;QAEf,EAAE,CAAC,CAAC,OAAO,CAAC,KAAK,QAAQ,CAAC,CAAC,CAAC;YACxB,CAAC,GAAG,EAAE,CAAC;QACX,CAAC;QACD,MAAM,CAAC,IAAI,aAAK,CAAC;YACb,GAAG,EAAE,CAAC;SACT,CAAC,CAAC;IACP,CAAC,CACJ;IAED,QAAQ,EAAE,IAAI,kBAAQ,CAClB,KAAK,EAAE,gBAAgB,CAC1B;CACJ,CAAC;;;;;;;;;;ACtEF,qCAGqB;AACrB,8CAIyB;AAOzB,8BAAqC,QAAkB;IACnD,IAAM,MAAM,GAAG,sBAAc,CAAuB,QAAQ,CAAC,CAAC;IAC9D,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,UAAC,OAAyB;QACjD,MAAM,CAAC,IAAI,4BAAY,CACnB,OAAO,CAAC,UAAU,CAAC,KAAK,EACxB,OAAO,CAAC,UAAU,CAAC,GAAG,EACtB,OAAO,CAAC,UAAU,CAAC,EAAE,EACrB,OAAO,CAAC,UAAU,CAAC,IAAI,EACvB,OAAO,CAAC,UAAU,CAAC,QAAQ,EAC3B,OAAO,CAAC,UAAU,CAAC,WAAW,EAC9B,OAAO,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,CAAC,EAC/B,OAAO,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,CAAC,CAClC,CAAC;IACN,CAAC,CAAC,CAAC;AACP,CAAC;AAdD,oDAcC;AAGD,iCAAwC,QAAkB;IACtD,IAAM,OAAO,GAAG,mBAAW,CAAqB,QAAQ,CAAC,CAAC;IAC1D,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,UAAC,MAA0B;QAC1C,MAAM,CAAC,MAAwB,CAAC;IACpC,CAAC,CAAC,CAAC;AACP,CAAC;AALD,0DAKC;;;;;;;;;;;;;;;;;;;;ACpCD,wCAAoD;AAGpD;IAAA;IAOA,CAAC;IAAD,2BAAC;AAAD,CAAC;AAPY,oDAAoB;AAUjC;IAAA;IAGA,CAAC;IAAD,mBAAC;AAAD,CAAC;AAGD;IAAA;IAOA,CAAC;IAAD,qBAAC;AAAD,CAAC;AAGD;IAAA;IAIA,CAAC;IAAD,uBAAC;AAAD,CAAC;AAJY,4CAAgB;AAO7B;IAAkC,gCAAK;IACnC,sBACW,KAAa,EACb,GAAQ,EACR,EAAU,EACV,IAAY,EACZ,QAAgB,EAChB,WAAmB,EACnB,CAAS,EACT,CAAS;QARpB,YAUI,kBAAM,CAAC,EAAE,CAAC,CAAC,SACd;QAVU,WAAK,GAAL,KAAK,CAAQ;QACb,SAAG,GAAH,GAAG,CAAK;QACR,QAAE,GAAF,EAAE,CAAQ;QACV,UAAI,GAAJ,IAAI,CAAQ;QACZ,cAAQ,GAAR,QAAQ,CAAQ;QAChB,iBAAW,GAAX,WAAW,CAAQ;QACnB,OAAC,GAAD,CAAC,CAAQ;QACT,OAAC,GAAD,CAAC,CAAQ;;IAGpB,CAAC;IACL,mBAAC;AAAD,CAAC,CAbiC,gBAAK,GAatC;AAbY,oCAAY;;;;;;;;;;;;;;;;;;;;ACvCzB,uCAAkD;AAClD,0CAAwC;AAMxC;IAAmC,iCAAO;IAEtC;eACI,kBAAM,qBAAS,CAAC;IACpB,CAAC;IACL,oBAAC;AAAD,CAAC,CALkC,iBAAO,GAKzC;AALY,sCAAa;;;;;;;;;;ACP1B,qCAAoC;AACpC,uCAAwC;AACxC,uCAAyC;AAG5B,iBAAS,GAAG;IACrB,WAAW,EAAE,IAAI,kBAAQ,CACrB,MAAM,EACN,SAAS,EACT,IAAI,aAAK,EAAE,EACX,IAAI,iBAAO,CAAC;QACR,cAAc,EAAE,kBAAkB;KACrC,CAAC,EACF,UAAC,IAAI;QACD,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC;YAClB,UAAU,EAAE,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE;YACpC,UAAU,EAAE,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE;SACvC,CAAC,CAAC;IACP,CAAC,CACJ;IAED,WAAW,EAAE,IAAI,kBAAQ,CACrB,KAAK,EACL,qBAAqB,CACxB;IAED,YAAY,EAAE,IAAI,kBAAQ,CACtB,KAAK,EACL,eAAe,CAClB;IAED,QAAQ,EAAE,IAAI,kBAAQ,CAClB,KAAK,EAAE,eAAe,CACzB;CACJ,CAAC;;;;;;;;;;AC/BF;IAII,aAEW,IAAY,EAGZ,KAAa,EAGb,cAAuB,EAGvB,KAAe,EAGf,MAAc,EAGd,OAAe,EAGf,QAAgB,EAGhB,UAAgB,EAGhB,SAAe,EAGf,KAAa;QA3Bb,SAAI,GAAJ,IAAI,CAAQ;QAGZ,UAAK,GAAL,KAAK,CAAQ;QAGb,mBAAc,GAAd,cAAc,CAAS;QAGvB,UAAK,GAAL,KAAK,CAAU;QAGf,WAAM,GAAN,MAAM,CAAQ;QAGd,YAAO,GAAP,OAAO,CAAQ;QAGf,aAAQ,GAAR,QAAQ,CAAQ;QAGhB,eAAU,GAAV,UAAU,CAAM;QAGhB,cAAS,GAAT,SAAS,CAAM;QAGf,UAAK,GAAL,KAAK,CAAQ;IAExB,CAAC;IACL,UAAC;AAAD,CAAC;AApCY,kBAAG;AA0ChB;IAEI,iBAAqB,IAAa;QAAb,SAAI,GAAJ,IAAI,CAAS;IAClC,CAAC;IAED,sBAAI,yBAAI;aAAR;YACI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC;QAC1B,CAAC;;;OAAA;IAED,sBAAI,0BAAK;aAAT;YACI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC;QAC3B,CAAC;;;OAAA;IAED,sBAAI,mCAAc;aAAlB;YACI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC;QACpC,CAAC;;;OAAA;IAED,sBAAI,0BAAK;aAAT;YACI,IAAM,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YACzD,KAAK,CAAC,IAAI,EAAE,CAAC;YACb,MAAM,CAAC,KAAK,CAAC;QACjB,CAAC;;;OAAA;IAED,sBAAI,2BAAM;aAAV;YACI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC;QACzB,CAAC;;;OAAA;IAED,sBAAI,4BAAO;aAAX;YACI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC;QACzB,CAAC;;;OAAA;IAED,sBAAI,6BAAQ;aAAZ;YACI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC;QACzB,CAAC;;;OAAA;IAED,sBAAI,+BAAU;aAAd;YACI,MAAM,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,CAAC;QAC1C,CAAC;;;OAAA;IAED,sBAAI,8BAAS;aAAb;YACI,MAAM,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,CAAC;QAC1C,CAAC;;;OAAA;IAED,sBAAI,0BAAK;aAAT;YACI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,IAAI,EAAE,CAAC;QACjC,CAAC;;;OAAA;IAEL,cAAC;AAAD,CAAC;AA/CY,0BAAO;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5CpB,qCAA6C;AAC7C,oCAAqC;AAGrC;IAAyB,8BAAK;IAA9B;;IAAgC,CAAC;IAAD,iBAAC;AAAD,CAAC,CAAR,KAAK,GAAG;AAKjC;IAAA;IAKA,CAAC;IAAD,iBAAC;AAAD,CAAC;AAKD;IAAA;IAIA,CAAC;IAAD,qBAAC;AAAD,CAAC;AAKD;IAAA;IAGA,CAAC;IAAD,mBAAC;AAAD,CAAC;AASD;IAAA;IAIA,CAAC;IAAD,gBAAC;AAAD,CAAC;AAJY,8BAAS;AAStB;IAAA;IAEA,CAAC;IAAD,kBAAC;AAAD,CAAC;AAFY,kCAAW;AAOxB;IAAA;IAaA,CAAC;IAAD,cAAC;AAAD,CAAC;AAbY,0BAAO;AAqBpB,0BAAiC,QAAkB;IAC/C,IAAM,IAAI,GAAG,sBAAc,CAAY,QAAQ,CAAC,CAAC;IACjD,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;QACd,MAAM,IAAI,KAAK,CAAC,eAAe,CAAC,CAAC;IACrC,CAAC;IACD,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC;AACtB,CAAC;AAND,4CAMC;AAKD,sBAA6B,IAAY;IACrC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;QACR,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;IACxC,CAAC;IACD,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IAC9B,EAAE,CAAC,CAAC,KAAK,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC,CAAC;QACrB,MAAM,IAAI,KAAK,CAAC,oCAAoC,CAAC,CAAC;IAC1D,CAAC;IACD,IAAM,MAAM,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;IAExB,IAAM,OAAO,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IACpC,IAAM,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;IACnC,MAAM,CAAC,MAAM,CAAC;AAClB,CAAC;AAbD,oCAaC;AAQD,0BAAiC,QAAkB;IAC/C,IAAM,IAAI,GAAG,gBAAgB,CAAC,QAAQ,CAAC,CAAC;IACxC,IAAM,IAAI,GAAG,YAAY,CAAC,IAAI,CAAC,CAAC;IAEhC,MAAM,cAAK,IAAI,IAAE,OAAO,EAAE,IAAI,CAAC,KAAK,IAAI,EAAE,IAAE;AAChD,CAAC;AALD,4CAKC;AASD,yBAAgC,QAAkB;IAC9C,IAAM,IAAI,GAAG,gBAAgB,CAAC,QAAQ,CAAC,CAAC;IACxC,IAAM,IAAI,GAAG,YAAY,CAAC,IAAI,CAAC,CAAC;IAGhC,IAAM,IAAI,GAAG,IAAI,aAAO,CAAC,IAAI,CAAC,CAAC;IAC/B,MAAM,CAAC,IAAI,SAAG,CACV,IAAI,CAAC,IAAI,EACT,IAAI,CAAC,KAAK,EACV,IAAI,CAAC,cAAc,EACnB,IAAI,CAAC,KAAK,EACV,IAAI,CAAC,MAAM,EACX,IAAI,CAAC,OAAO,EACZ,IAAI,CAAC,QAAQ,EACb,IAAI,CAAC,UAAU,EACf,IAAI,CAAC,SAAS,EACd,IAAI,CACP,CAAC;AACN,CAAC;AAlBD,0CAkBC;;;;;;;;;;;;;;;;;;;;AC9ID,uCAAkD;AAClD,0CAAwC;AAMxC;IAAkC,gCAAO;IAErC;eACI,kBAAM,qBAAS,CAAC;IACpB,CAAC;IAED,4BAAK,GAAL,UAAM,QAAkB;IACxB,CAAC;IACL,mBAAC;AAAD,CAAC,CARiC,iBAAO,GAQxC;AARY,oCAAY;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACGzB,yCAAsC;AACtC,yCAAsC;AAkDtC;IA0BI,sBAAa,OAAgB,EAAE,OAAgB;QAC3C,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QACvB,IAAI,CAAC,OAAO,GAAG,OAAO,IAAI,CAAC,CAAC;QAC5B,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;QACjB,IAAI,CAAC,aAAa,GAAG,IAAI,mBAAQ,EAAE,CAAC;QACpC,IAAI,CAAC,gBAAgB,GAAG,IAAI,mBAAQ,EAAE,CAAC;QAGvC,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;QAErB,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;QAErB,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;IAC1B,CAAC;IAED,4BAAK,GAAL;QACI,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;YAChB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;QACxB,CAAC;IACL,CAAC;IAES,6BAAM,GAAhB,UAAiB,KAAa;QAC1B,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;YACjB,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;YACpB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;QACzB,CAAC;IACL,CAAC;IAKY,8BAAO,GAApB;;gBAMU,QAAQ;;gBAFd,IAAI,CAAC,KAAK,EAAE,CAAC;2BAEI,OAAO,CAAC,OAAO,CAAC,IAAI,mBAAQ,CAAC,CAAC,CAAC,CAAC;gBACjD,WAAO,QAAQ,EAAC;;;KACnB;IAOM,2BAAI,GAAX,UACI,UAAwB,EACxB,SAAyB;QAQzB,IAAM,QAAQ,GAAsB,IAAI,CAAC,OAAO,EAAE,CAAC;QACnD,IAAM,QAAQ,GAAe,QAAQ,CAAC,IAAI,CAAC,UAAU,EAAE,SAAS,CAAC,CAAC;QAClE,MAAM,CAAC,QAAQ,CAAC;IACpB,CAAC;IAOM,4BAAK,GAAZ,UACI,SAAyB;QAKzB,MAAM,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;IAC3C,CAAC;IAEM,4BAAK,GAAZ;QACI,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;IACxB,CAAC;IAED,sBAAI,+BAAK;aAAT;YACI,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC;QACvB,CAAC;;;OAAA;IAEL,mBAAC;AAAD,CAAC;AA7GY,oCAAY;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5DzB,yCAAsC;AACtC,uCAAoC;AAMpC,yBAAyB,GAAmB;IAIxC,IAAM,kBAAkB,GAAG;QACvB,IAAM,IAAI,GAAe,GAAG,CAAC,qBAAqB,EAAE,CAAC;QACrD,MAAM,CAAC,iBAAO,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;IAC/B,CAAC,CAAC;IAEF,IAAM,QAAQ,GAAG,IAAI,mBAAQ,CACzB,GAAG,CAAC,MAAM,EACV,kBAAkB,EAClB,GAAG,CAAC,YAAY,CACnB,CAAC;IACF,MAAM,CAAC,QAAQ,CAAC;AACpB,CAAC;AAGD;IAAuB,4BAAK;IAIxB,kBAAa,OAAe,EAAE,EAAS;QAAvC,YACI,iBAAO,SAGV;QAFG,KAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QACvB,KAAI,CAAC,KAAK,GAAG,EAAE,CAAC;;IACpB,CAAC;IACL,eAAC;AAAD,CAAC,CATsB,KAAK,GAS3B;AAaD,wBAA8B,GAAmB;;YAGvC,QAAQ;;uBAAG,CAAC;YAClB,EAAE,CAAC,CAAC,GAAG,CAAC,UAAU,KAAK,QAAQ,CAAC,CAAC,CAAC;gBAC9B,MAAM,KAAC,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,EAAC;YAChC,CAAC;YAGD,WAAO,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM;oBAE/B,IAAM,KAAK,GAAG,EAAC,MAAM,EAAE,KAAK,EAAC,CAAC;oBAI9B,iBAAiB,EAAW;wBAExB,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;4BAEd,KAAK,CAAC,IAAI,GAAG,IAAI,CAAC;4BAGlB,OAAO,CAAC,GAAG,CAAC,CAAC;wBAKjB,CAAC;oBACL,CAAC;oBAID,IAAM,IAAI,GAAG,UAAC,EAAS;wBAEnB,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;4BAEd,KAAK,CAAC,IAAI,GAAG,IAAI,CAAC;4BAGlB,IAAM,KAAK,GAAG,IAAI,QAAQ,CAAC,YAAY,EAAE,EAAE,CAAC,CAAC;4BAC7C,MAAM,CAAC,KAAK,CAAC,CAAC;wBAClB,CAAC;oBACL,CAAC,CAAC;oBAGF,GAAG,CAAC,gBAAgB,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;oBAGtC,GAAG,CAAC,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;oBACpC,GAAG,CAAC,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;oBACpC,GAAG,CAAC,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;oBAKtC,GAAG,CAAC,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;gBAC1C,CAAC,CAAC,EAAC;;;CACN;AAGD,mBACI,GAAmB,EACnB,MAAc,EACd,GAAW,EACX,OAA4B,EAC5B,IAAa;IAET,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;IAC5B,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;QACV,GAAG,CAAC,CAAe,UAAO,EAAP,mBAAO,EAAP,qBAAO,EAAP,IAAO;YAArB,IAAM,IAAI;YACJ,iBAAG,EAAE,eAAK,CAAS;YAC1B,GAAG,CAAC,gBAAgB,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;SACpC;IACL,CAAC;IACD,GAAG,CAAC,IAAI,CAAC,IAAI,IAAI,EAAE,CAAC,CAAC;AAC7B,CAAC;AAQD;IAKI,aAAa,OAAW;QAAX,qCAAW;QACpB,IAAI,CAAC,GAAG,GAAG,IAAI,cAAc,EAAE,CAAC;QAChC,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;IAC3B,CAAC;IAKM,oBAAM,GAAb,UAAc,IAAY,EAAE,QAA6B;QACrD,IAAI,CAAC,GAAG,CAAC,gBAAgB,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;IAC9C,CAAC;IAOY,mBAAK,GAAlB,UACI,MAAc,EAAE,GAAW,EAAE,OAA4B,EACzD,IAAa;;;gBAEb,SAAS,CAAC,IAAI,CAAC,GAAG,EAAE,MAAM,EAAE,GAAG,EAAE,OAAO,EAAE,IAAI,IAAI,EAAE,CAAC,CAAC;gBACtD,WAAO,IAAI,CAAC,OAAO,EAAE,EAAC;;;KACzB;IASY,qBAAO,GAApB;;;;4BACI,WAAM,cAAc,CAAC,IAAI,CAAC,GAAG,CAAC;;wBAA9B,SAA8B,CAAC;wBAC/B,WAAO,IAAI,EAAC;;;;KACf;IAOD,sBAAW,yBAAQ;aAAnB;YACI,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;gBAClB,IAAI,CAAC,SAAS,GAAG,eAAe,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YAC/C,CAAC;YACD,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC;QAC1B,CAAC;;;OAAA;IAEM,mBAAK,GAAZ;QACI,IAAI,CAAC,GAAG,CAAC,KAAK,EAAE,CAAC;IACrB,CAAC;IAEL,UAAC;AAAD,CAAC;AA1DY,kBAAG","file":"because.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"because\"] = factory();\n\telse\n\t\troot[\"because\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 25);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 5ebf1d11c86902fb69a9","import { Data, pairs } from \"./data\";\nimport { MutableTable } from \"./table\";\nimport { Headers } from \"./headers\";\nimport { Log } from \"./log\";\nimport { Method, URI, URL, Body } from \"./http\";\nimport { Request } from \"./request\";\nimport { Query } from \"./query\";\nimport { format } from \"./format\";\n\n\nexport interface Args {\n    [key: string]: string | number ;\n}\n\nexport interface ArgsToQuery {\n    (args: Args): Query;\n}\n\nexport interface ArgsToHeaders {\n    (args: Args): Headers;\n}\n\nexport interface ArgsToBody {\n    (args: Args): Body;\n}\n\n\nclass EndpointData extends Data<Endpoint> {\n}\n\n\nclass EndpointTable extends MutableTable<Endpoint> {\n}\n\n\nexport class ServiceError extends Error {\n}\n\n\n/**\n * Instances are abstract and use relative URIs.\n */\nexport class Service {\n    protected table: EndpointTable;\n    protected endpoints: EndpointData;\n    private _headers: Headers;\n    protected log: Log;\n\n    constructor (endpoints?: EndpointData, headers?: Headers) {\n        endpoints = endpoints || this.endpoints || {};\n        // TODO copy\n        this.table = new EndpointTable(endpoints);\n        this._headers = headers || new Headers();\n    }\n\n    private add_endpoints(endpoints: EndpointData) {\n        // TODO: use some update() thingy here?\n        // Table isn't mutable... blegh\n        for (const pair of pairs(endpoints)) {\n            const [key, value] = pair;\n            this.table.set(key, value);\n            // this.data[pair[0]] = pair[1];\n        }\n    }\n\n    endpoint(name: string): Endpoint {\n        return this.table.get(name);\n    }\n\n    uri(endpoint_name: string, args: Args): URI {\n        const endpoint = this.endpoint(endpoint_name);\n        return endpoint.uri(args);\n    }\n\n    url(base: URL, endpoint_name: string, args?: Args): URL {\n        const endpoint = this.endpoint(endpoint_name);\n        if (!endpoint) {\n            const keys = this.table.keys().join(\", \") || \"no endpoints!\";\n            throw new Error(\n                `no endpoint named ${endpoint_name}.\n                available endpoints for this service: ${keys}`,\n            );\n        }\n        return endpoint.url(base, args) as URL;\n    }\n\n    // headers(endpoint_name: string, args?: Args): Headers {\n    //     const endpoint = this.endpoint(endpoint_name);\n    //     const headers = endpoint.headers(args);\n\n    //     for (const pair of endpoint.headers.pairs()) {\n    //         const [key, value] = pair;\n    //         result.set(key, value);\n    //     }\n    //     if (headers) {\n    //         for (const pair of headers.pairs()) {\n    //             const [key, value] = pair;\n    //             result.set(key, value);\n    //         }\n    //     }\n    //     return result;\n    // }\n\n    // seems useless with these weird signatures\n    // frontend(client: Client, base: URL): ServiceFrontend {\n    //     return new ServiceFrontend(\n    //         this,\n    //         client,\n    //         base,\n    //     );\n    // }\n}\n\n\n/**\n * Instances are abstract and use relative URIs.\n *\n * Intentionally no name on it: there may be any number of names used\n * externally for the same object, it's all arbitrary, but we don't want to\n * couple to one.\n */\nexport class Endpoint {\n    public readonly method: Method;\n    protected readonly _uri: URI;\n\n    readonly query_function: ArgsToQuery;\n    readonly default_query: Query;\n\n    readonly headers_function: ArgsToHeaders;\n    readonly default_headers: Headers;\n\n    readonly body_function: ArgsToBody;\n    readonly default_body: Body;\n\n    constructor (\n        method: Method,\n        uri: URI,\n        query?: Query | ArgsToQuery,\n        headers?: Headers | ArgsToHeaders,\n        body?: string | ArgsToBody,\n    ) {\n        this.method = method;\n        this._uri = uri;\n\n        if (!query || typeof query === \"object\") {\n            this.default_query = query || new Query();\n        }\n        else if (typeof query === \"function\") {\n            this.query_function = query;\n        }\n\n        if (!headers || typeof headers === \"object\") {\n            this.default_headers = headers || new Headers();\n        }\n        else if (typeof headers === \"function\") {\n            this.headers_function = headers;\n        }\n\n        if (!body || typeof body === \"string\") {\n            this.default_body = body || \"\";\n        }\n        else if (typeof body === \"function\") {\n            this.body_function = body;\n        }\n    }\n\n    uri(args?: Args, append_query: boolean = false): URI {\n        args = args || {};\n        const string_args: {[key: string]: string} = {};\n        for (const key of Object.keys(args)) {\n            let value = args[key] || \"\";\n            if (value === undefined) {\n                value = \"\";\n            }\n            else if (typeof value === \"number\") {\n                value = value.toString();\n            }\n            else {\n                value = value;\n            }\n            string_args[key] = value;\n        }\n\n        const uri = format(this._uri as string, string_args) as URI;\n\n        // Inline query: can't do this without messing up Request.\n        if (append_query) {\n            const query = this.query(args);\n            const qs: string = query.encoded;\n            if (qs) {\n                return `${uri}?${qs}` as URI;\n            }\n        }\n        return uri;\n    }\n\n    url(base: URL, args?: Args, append_query: boolean = false): URL {\n        // Sanity check the passed base prefix\n        if (!/^https?:\\/\\/.*$/.test(base as string)) {\n            throw new Error(`invalid URL base ${base}`);\n        }\n\n        // Compose URI, but ensure we strip any redundant slashes before join\n        const uri = this.uri(args, append_query).replace(/^[/]+/g, \"\");\n        base = base.replace(/[/]+$/g, \"\");\n        return `${base}/${uri}` as URL;\n    }\n\n    query(args?: Args): Query {\n        let query: Query;\n        if (this.query_function) {\n            query = this.query_function(args || {});\n        }\n        else {\n            query = this.default_query.copy();\n        }\n        return query;\n    }\n\n    headers(args?: Args): Headers {\n        let headers: Headers;\n        if (this.headers_function) {\n            headers = this.headers_function(args || {});\n        }\n        else {\n            headers = this.default_headers.copy();\n        }\n        return headers;\n    }\n\n    body(args?: Args): Body {\n        let body: Body;\n        if (this.body_function) {\n            body = this.body_function(args || {});\n        }\n        else {\n            body = this.default_body;\n        }\n        return body;\n    }\n\n    request(base: URL, args?: Args): Request {\n        const query = this.query(args);\n        const headers = this.headers(args);\n        const body = this.body(args);\n        const request = new Request(\n            this.method,\n            this.url(base, args, false),\n            query,\n            body,\n            headers,\n        );\n        return request;\n    }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/service.ts","/**\n * Tools for working with HTTP request or response headers.\n *\n * Extends `Table` from `table.ts`.\n *\n */\n\n/** This line does nothing but make typedoc render the module comment. */\n\nimport { Data, map, copy } from \"./data\";\nimport { Table, MutableTable } from \"./table\";\n\n/**\n * Interchange type for HTTP request or response header data.\n *\n * This is defined separately from Data only to provide an extension point\n * specific to data objects that represent headers. For more on the underlying\n * behavior, see [Data](./data.html).\n */\nexport class HeaderData extends Data<string> {\n}\n\n/**\n * Function defining how keys are normalized by Headers.\n *\n * @param key   String to normalize as a key.\n * @returns     Normalized version of the given key.\n */\nfunction normalize(key: string) {\n    return key.toLowerCase();\n}\n\n\n/**\n * Parse output as from XMLHttpRequest.getAllResponseHeaders().\n */\nexport function parse_headers(\n    headers: ByteString | null, limit?: number,\n): HeaderData {\n    // \"null if no response has been received\"\n    // \"If a network error happened, an empty string is returned\"\n    if (!headers) {\n        return {};\n    }\n    if (limit && headers.length > limit) {\n        throw new Error(\"not parsing oversized headers string\");\n    }\n    // Lines separated by CRLF.\n    const line_sep = \"\\r\\n\";\n    const lines = headers.split(line_sep);\n    // Pairs separated by colon.\n    const pair_sep = \": \";\n    const data: HeaderData = {};\n    for (const line of lines) {\n        const index = line.indexOf(pair_sep);\n        const key = line.slice(0, index);\n        const value = line.slice(index + pair_sep.length);\n        if (key) {\n            data[key] = value;\n        }\n    }\n    return data;\n}\n\n/**\n * Class for objects holding HTTP request or response headers.\n *\n * Most of the behavior is from `Table`. This adds:\n * * key normalization, since HTTP header names aren't case-sensitive;\n * * automatically combining lists of string values into comma-separated\n *   strings.\n *\n */\nexport class Headers extends MutableTable<string> {\n\n    /**\n     * @param data      JS object mapping header names to header value strings.\n     *                  If unspecified, the Headers object will be empty.\n     *\n     * *Note:* if you are trying to clone an existing Headers object, use its\n     * copy() method instead of trying to pass it to the Headers constructor,\n     * or trying to extract and pass its data to the Headers constructor.\n     */\n    constructor (data?: HeaderData) {\n        // Normalize header names on the way in.\n        const normalized = map(\n            data || {},\n            (key: string, value: string) => {\n            return [normalize(key), value];\n        });\n        super(normalized);\n    }\n\n    /**\n     * Alternate constructor based on parse_headers.\n     * Example: Headers.parse(\"foo: bar\\r\\nbaz: bam\\r\\n\")\n     */\n    static parse(blob: ByteString) {\n        const data: HeaderData = parse_headers(blob);\n        return new Headers(data);\n    }\n\n    /**\n     * Retrieve the header value for a specified header name.\n     *\n     * @param key   Header name to retrieve the value for.\n     */\n    get(key: string): string {\n        // Normalize requested key\n        return this._data[normalize(key)];\n    }\n\n    /**\n     * Set the header value for a specified header name.\n     *\n     * @param key       Header name to set the value for.\n     * @param value     Header value to set.\n     *                  This may be a string, or a list of strings;\n     *                  a list of strings will be joined by \",\"\n     *                  per RFC 2616.\n     */\n    set(key: string, value: string | string[]): void {\n        let result: string;\n        if (typeof(value) === \"string\") {\n            result = value;\n        }\n        else {\n            result = value.join(\",\");\n        }\n        // Normalize header names on the way in.\n        this._data[normalize(key)] = result;\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/headers.ts","/**\n * Tools for working with data in plain Javascript objects.\n *\n * This module is for working with what might be called \"data objects\": objects\n * of no particular type that are used as `{key: value}` mappings, with string\n * keys, and values that are all some other type.\n *\n * Data objects are easy to make and are commonly and idiomatically used all\n * over the place in JS, so this is a natural choice of parameter types for\n * many public interfaces.\n *\n * However, public interfaces may be passed all kinds of objects. In JS, where\n * type \"object\" has so many distinct functions, this can cause treacherous\n * snafus, like when properties come in from the prototype chain requiring\n * filtering with `Object.hasOwnProperty`, or like when certain properties are\n * really methods, or like when there is a property named `hasOwnProperty`.\n * Unless you can absolutely ensure that nobody passes anything weird (and you\n * can't if you are offering a public JS API for others to use), then careful\n * handling is required to avoid baffling bugs that may cause problems far from\n * the point of origin.\n *\n * This provides a strong reason to codify that careful handling in some\n * functions and then just use those functions instead of repeatedly and\n * partially implementing the same functions all over your code. Therefore:\n *\n * This module explains to TypeScript what data objects are, and then provides\n * a lot of generic functions to do the normal things you'd want to do on data\n * objects, in relatively careful ways.\n *\n * If you want a layer of protection against snafus, and especially if you want\n * to store data objects and work with them more easily, you might be\n * interested in the \"Table\" wrapper in table.ts.\n *\n */\n\n/** This line does nothing but make typedoc render the module comment. */\n\n// (We can't rely on being able to use ES6 Map if we want to be able to target\n// ES5. Ugh.)\n\n// Ugh\n/** Internal interface defining types that define length.\n */\nexport interface Len {\n    length: number;\n}\n\n/**\n * Defines \"data objects.\"\n *\n * This is a generic structural class substitutable for Javascript objects with\n * string properties and monomorphic values. This type is suitable for\n * interfaces and internal representations which need interop with JS objects.\n * Aside from this trivial definition, rest of this file is dedicated to\n * functions for working on this representation more safely.\n *\n * (If you want an encapsulated object, use or subclass\n * [Table](./table.html) instead.)\n *\n * @param ValueType     Type of stored values.\n */\nexport class Data<ValueType> {\n    [key: string]: ValueType;\n}\n\n\n/**\n * Count the number of pairs stored in a data object.\n *\n * @param ValueType     Type of stored values.\n */\nexport function length<ValueType>(data: Data<ValueType>): number {\n    // Unbelievable that we have to define this at all. Ugh.\n    // in any case we are internally iterating, which is O(n). Ugh.\n    return Object.keys(data).length;\n}\n\n/**\n * List the keys in a data object.\n *\n * (This function does the hasOwnProperty dance for everything else. This is\n * clean, but it means multiple iterations over the array for everything. Ugh.)\n *\n * @param ValueType     Type of stored values.\n */\nexport function keys<ValueType>(data: Data<ValueType>): string[] {\n    const result: string[] = [];\n    for (const property in data) {\n        if (data.hasOwnProperty(property)) {\n            result.push(property);\n        }\n    }\n    return result;\n}\n\n/**\n * List the values in a data object.\n *\n * @param ValueType     Type of stored values.\n *\n */\nexport function values<ValueType>(data: Data<ValueType>): ValueType[] {\n    // We can't rely on being able to use iterators. Ugh.\n    const result: ValueType[] = [];\n    for (const key of keys(data)) {\n        result.push(data[key]);\n    }\n    return result;\n}\n\n/**\n * List the [key, value] pairs in a data object.\n *\n * @param ValueType     Type of stored values.\n */\nexport function pairs<ValueType>\n(data: Data<ValueType>): [string, ValueType][] {\n    const result: [string, ValueType][] = [];\n    for (const key of keys(data)) {\n        result.push([key, data[key]]);\n    }\n    return result;\n}\n\n/**\n * Shallow comparison of two data objects.\n *\n * @param ValueType     Type of stored values.\n */\nexport function equals<ValueType>\n(a: Data<ValueType>, b: Data<ValueType>): boolean {\n    if (a === b) {\n        return true;\n    }\n    const keys_a = keys(a);\n    const keys_b = keys(b);\n    if (keys_a.length !== keys_b.length) {\n        return false;\n    }\n    keys_a.sort();\n    keys_b.sort();\n    for (let i = 0; i < keys_a.length; i++) {\n        const key_a = keys_a[i];\n        const key_b = keys_b[i];\n        if (key_a !== key_b) {\n            return false;\n        }\n        const value_a = a[key_a];\n        const value_b = b[key_b];\n        if (value_a !== value_b) {\n            return false;\n        }\n    }\n    return true;\n}\n\n/**\n * Helper function (mostly for tests).\n *\n * @param ValueType     Type of stored values.\n */\nexport function arrays_equal<ValueType>\n(a: ValueType[], b: ValueType[]): boolean {\n    if (a === b) {\n        return true;\n    }\n    if (a.length !== b.length) {\n        return false;\n    }\n    for (let i = 0; i < a.length; i++) {\n        const item_a: ValueType = a[i];\n        const item_b: ValueType = b[i];\n        // rarely, the value 'undefined' may be stored in one while the other\n        // just does not have that key defined. you'd need pairs of this\n        // situation to ensure arrays had the same length.\n        if (item_a !== item_b) {\n            return false;\n        }\n    }\n    return true;\n}\n\n/**\n * Helper function (mostly for tests).\n *\n * @param ValueType     Type of stored values.\n */\nexport function pairs_equal<KeyType, ValueType>\n(a: [KeyType, ValueType][], b: [KeyType, ValueType][]) {\n    if (a.length !== b.length) { return false; }\n    for (let i = 0; i < a.length; i++) {\n        const [ak, av] = a[i];\n        const [bk, bv] = b[i];\n        if (ak !== bk || av !== bv) {\n            return false;\n        }\n    }\n    return true;\n}\n\n/**\n * Type for callbacks taking a (key, value) pair and making side effects.\n *\n * @param ValueType     Type of stored values.\n */\nexport interface EachCallback<ValueType> {\n    (key: string, value: ValueType): void;\n}\n\n/**\n * Type for callbacks taking a (key, value) pair and returning another.\n *\n * @param ValueType     Type of stored values.\n */\nexport interface PairCallback<ValueType> {\n    (key: string, value: ValueType): [string, ValueType];\n}\n// (This isn't usable as a structural subtype of EachCallback? Ugh.)\n\n\n/**\n * Run the side-effecting callback(k, v): void for each pair.\n *\n * @param ValueType     Type of stored values.\n */\nexport function each<ValueType>\n(data: Data<ValueType>, callback: EachCallback<ValueType>) {\n    for (const pair of pairs(data)) {\n        callback(pair[0], pair[1]);\n    }\n}\n\n\n/**\n * Return the result of applying callback to each pair returned by pairs().\n *\n * @param ValueType     Type of stored values.\n */\nfunction map_pairs<ValueType>\n(data: Data<ValueType>, callback: PairCallback<ValueType>) {\n    const result: Array<[string, ValueType]> = [];\n    for (const pair of pairs(data)) {\n        result.push(callback(pair[0], pair[1]));\n    }\n    return result;\n}\n\n\n/**\n * Get the result of applying callback to each [k, v] pair as Data.\n *\n * @param ValueType     Type of stored values.\n */\nexport function map<ValueType>\n(data: Data<ValueType>, callback: PairCallback<ValueType>) {\n    const result: Data<ValueType> = {};\n    for (const pair of map_pairs(data, callback)) {\n        const [key, value] = pair;\n        result[key] = value;\n    }\n    return result;\n}\n\n\n/**\n * Make a shallow copy of a data object..\n *\n * @param ValueType     Type of stored values.\n */\nexport function copy<ValueType>\n(data: Data<ValueType>): Data<ValueType> {\n    return map(data, (key: string, value: ValueType) => {\n        return [key, value];\n    });\n}\n\n\n/**\n * Make a copy of data object with keys in other data object written over.\n *\n * @param data      data object to copy and override keys in\n * @param other     data object from which present keys will override data\n */\nexport function updated<ValueType>\n(data: Data<ValueType>, other: Data<ValueType>): Data<ValueType> {\n    const result = copy(data);\n    for (const property in other) {\n        if (other.hasOwnProperty(property)) {\n            result[property] = other[property];\n        }\n    }\n    return result;\n}\n\n/**\n * Turn pairs of data object into strings delimited by `sep`.\n *\n * @param ValueType     Type of stored values.\n */\nexport function as_strings<ValueType>\n(data: Data<ValueType>, sep = \"=\") {\n    const result: string[] = [];\n    for (const pair of pairs(data)) {\n        result.push(pair.join(sep));\n    }\n    return result;\n}\n\n\n/**\n * Turn a data object into string: join [k, v] on `item_sep`, join on `sep`.\n *\n * @param ValueType     Type of stored values.\n */\nexport function as_string<ValueType>\n(data: Data<ValueType>, sep: string, item_sep = \"=\") {\n    return as_strings(data, item_sep).join(sep);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/data.ts","/**\n * Error types for internal use.\n *\n */\n\n/** This line does nothing but make typedoc render the module comment. */\n\n\nexport class BecauseError implements Error {\n    readonly name: string = \"BecauseError\";\n    readonly message: string;\n\n    /**\n     * @param message       As Error message.\n     */\n    constructor (message: string) {\n        this.message = message;\n    }\n}\n\n\n/**\n * Error thrown by constructors when an invalid object would be created.\n *\n * This causes any assignment to the new object to fail, ensuring that no\n * object with an invalid state is ever available for use.\n *\n * It would usually be polite to users, when writing new modules that need to\n * use this, to make your own subclass and use that instead of directly\n * throwing this.\n */\nexport class InvalidObject extends BecauseError {\n    readonly name: string = \"InvalidObject\";\n}\n\n/**\n * Thrown by parsing routines when their expectations are violated so that they\n * cannot return a reasonable result.\n * This differs from InvalidObject in that it pertains to the parsing side, not\n * semantic validation in constructors to prevent invalid states.\n */\nexport class ParseError extends BecauseError {\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/errors.ts","import { BecauseError } from \"./errors\";\nimport { Response } from \"./response\";\n\n\nclass ParseError extends BecauseError {\n    response: Response;\n\n    constructor (message: string, response: Response) {\n        super(message);\n        this.response = response;\n    }\n}\n\n\n/*\n * Define the structure returned by BCS APIs to encode errors.\n * Ignores other properties.\n */\nclass MayHaveError {\n    errorCode: number | undefined;\n    errorMessage: string | undefined;\n}\n\n\n/**\n * Standard gauntlet of checks and conversions for any of the services\n *\n * T is the type of object that should be returned. Here, it's not checked at\n * runtime, so all that really does is propagate as the type tag of the return\n * value. It's not much different from just using `any`.\n */\nexport function parse_response<T extends MayHaveError>(response: Response): T {\n    if (!response) {\n        throw new Error(\"no response\");\n    }\n    if (!response.body) {\n        throw new Error(\"response has no body\");\n    }\n    if (response.status < 200 || response.status > 299) {\n        const message = `error response: ${response.status}`;\n        throw new Error(message);\n    }\n    const data = JSON.parse(response.body);\n    if (data.errorCode || data.errorMessage) {\n        const code = data.errorCode;\n        const message = data.errorMessage;\n        throw new Error(`error body in response: ${code}: ${message}`);\n    }\n    return data;\n}\n\n\n// bleh\nexport function parse_array<T>(response: Response): T[] {\n    if (!response) {\n        throw new Error(\"no response\");\n    }\n    if (!response.body) {\n        throw new Error(\"response has no body\");\n    }\n    if (response.status < 200 || response.status > 299) {\n        const message = `error response: ${response.status}`;\n        throw new Error(message);\n    }\n    const data = JSON.parse(response.body);\n    return data;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/parse.ts","/**\n * Utilities for working with URL query strings.\n *\n * This module provides `Query`.\n *\n */\n\n/** This line does nothing but make typedoc render the module comment. */\n\nimport { Data, as_string, copy, map, updated } from \"./data\";\nimport { MutableTable } from \"./table\";\n\n\n/**\n * Interchange format for data in query part of URLs.\n */\nexport class QueryData extends Data<string> {\n}\n\n\n/**\n * Public interface definition for Query.\n */\nexport interface QueryInterface {\n    readonly encoded: string;\n}\n\n\n/**\n * Convenient encapsulated storage of URL query parameters.\n *\n * Most of the behavior is from [Table](./table.html). What this adds is\n * convenient conversion to a query string.\n */\nexport class Query extends MutableTable<string> {\n    protected readonly _data: QueryData;\n\n    /**\n     * @param data      JS object mapping query parameters to value strings.\n     *                  If unspecified, the Query object will be empty.\n     *\n     * *Note:* if you are trying to clone an existing Query object, use its\n     * copy() method instead of trying to pass it to the Query constructor,\n     * or trying to extract and pass its data to the Query constructor.\n     */\n    constructor (data?: QueryData) {\n        super(data || {});\n    }\n\n    get encoded(): string {\n        const components = as_uri_components(this._data);\n        return as_query_string(components);\n    }\n\n    url(url: string): string {\n        const encoded = this.encoded;\n        const result = encoded ? `${url}?${encoded}` : url ;\n        return result;\n    }\n\n    copy(): Query {\n        return new Query(copy(this._data));\n    }\n\n    /**\n     * Make a copy of the table with k/v overrides from another table.\n     */\n    updated(other: Query): Query {\n        const data = updated<string>(this._data, other.data());\n        const result = new Query(data);\n        return result;\n    }\n\n}\n\n\n/**\n * Encode keys and values as URI components, e.g. for making a query string.\n *\n * @param data      Data object to be converted.\n * @returns         Data object with keys and values that are encoded as URI\n *                  components.\n */\nexport function as_uri_components(data: Data<string | number>) {\n    return map(data, (key: string, value: string | number) => {\n        if (typeof value === \"number\") {\n            value = value.toString();\n        }\n        return [\n            encodeURIComponent(key),\n            encodeURIComponent(value),\n        ];\n    });\n}\n\n\n/**\n * Serialize a data object into a query string.\n *\n * @param data      Data object to be serialized into a query string.\n * @returns         Query string ready to be appended to a URL (after \"?\").\n */\nexport function as_query_string(data: Data<string | number>) {\n    return as_string(data, \"&\", \"=\");\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/query.ts","import { URI } from \"./http\";\nimport { Response } from \"./response\";\nimport { Service } from \"./service\";\nimport { Client } from \"./client\";\nimport { Transfer } from \"./transfer\";\nimport { Host } from \"./host\";\nimport { Method, Body } from \"./http\";\nimport { Request } from \"./request\";\nimport { Query } from \"./query\";\nimport { Log } from \"./log\";\nimport { Frontend } from \"./frontend\";\n\n/**\n * Frontend for a specific service.\n *\n * This contains per-service logic that would otherwise be in Frontend.\n * Code that needs to share state across services goes in Frontend\n * instead.\n */\nexport class ServiceFrontend {\n    public service: Service;\n    protected _frontend: Frontend;\n    public host: Host;\n    protected log: Log;\n\n    /**\n     * @param service   Service instance to wrap.\n     * @param frontend  Frontend to send requests with.\n     * @param host      Description of host to send requests to.\n     */\n    constructor (\n        service: Service, frontend: Frontend, host: Host,\n    ) {\n        this.service = service;\n        this._frontend = frontend;\n        this.host = host;\n        this.log = new Log(\"ServiceFrontend\");\n    }\n\n    // TODO: instead of query, take args\n    // these can be validated abstractly\n\n    // request(\n    //     method: Method,\n    //     endpoint: URI,\n    //     query?: Query,\n    //     body?: Body,\n    //     // headers?: Headers,\n    // ): Request {\n    //     // TODO: check method validity\n\n    //     // TODO: check uri validity, can't be absolute\n\n    //     // TODO: check query validity\n\n    //     const url = this.service.url(this.host.url, endpoint as string);\n    //     const headers = this.service.headers(endpoint as string);\n    //     const request = new Request(\n    //         method,\n    //         url as string,\n    //         query,\n    //         body as string,\n    //         headers,\n    //     );\n    //     return request;\n    // }\n\n    // request(endpoint: Endpoint, method: Method, args?: {}) {\n    //     return new Request(\n    //         <string> method,\n    //         <string> endpoint.url(this.base, args || {}),\n    //     );\n    // }\n\n    send(request: Request): Transfer {\n        this.log.debug(\"send\", {\"request\": request});\n        return this._frontend.send(request);\n    }\n\n}\n\n\nexport interface ServiceFrontendConstructor {\n\n    new (\n        service: Service,\n        client: Client,\n        host: Host,\n    ): ServiceFrontend;\n}\n\n\nexport interface FrontendClass {\n    new (\n        frontend: Frontend,\n        host: Host,\n    ): ServiceFrontend;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/service_frontend.ts","/**\n * Internal no-frills representation for a point on a two-dimensional plane.\n *\n * It is up to the code using this to decide what it means; this doesn't do\n * anything like projection.\n *\n * Points are immutable because they are intended to work like values.\n */\n\n/** This line does nothing but make typedoc render the module comment. */\n\n/**\n * Structure of arrays passing a point as just two numbers.\n */\nexport interface Coordinates extends Array<number> {\n    [key: number]: number;\n    0: number;\n    1: number;\n}\n\nexport function is_coordinates(arg: Coordinates | Address): arg is Coordinates {\n    return (typeof arg === \"object\" && arg.length === 2);\n}\n\nexport class Point {\n    public readonly x: number;\n    public readonly y: number;\n\n    constructor (x: number, y: number) {\n        this.x = x;\n        this.y = y;\n    }\n\n    equals(other: Point): boolean {\n        return (other.x === this.x && other.y === this.y);\n    }\n}\n\n\nexport class Address extends String {\n}\n\nexport type Location = Address | Coordinates | Point;\n\n\n\n// WEBPACK FOOTER //\n// ./src/location.ts","import { pairs } from \"./data\";\n\n\n/**\n * Define a mapping of arguments to be logged.\n */\ninterface Args {\n    // Need this to be any for general purpose debugging without type wrestle.\n    // tslint:disable-next-line\n    [key: string]: any;\n}\n\n\nenum Level {\n    debug = 7,\n    info = 6,\n    notice = 5,\n    warning = 4,\n    error = 3,\n    critical = 2,\n    // If you have an emergency, please hang up and dial 911 instead\n}\n\n\nconst level_names: {[level: number]: string} = {};\n// Workaround for not directly indexing with enum\nlevel_names[Level.debug] = \"debug\";\nlevel_names[Level.warning] = \"warning\";\nlevel_names[Level.error] = \"error\";\n\n/**\n * Define a source of log messages.\n *\n * Typical usage would be to have one of these per instance of a class complex\n * enough to need logging for debug. Normally this would be private to the\n * class so that it only reflects the \"voice\" of that particular instance.\n *\n */\nexport class Log {\n    name: string;\n\n    constructor (name: string) {\n        this.name = name;\n    }\n\n    protected emit(level: Level, text: string, args?: Args): void {\n        const level_name = level_names[level];\n        const prefix = `${this.name}: ${level_name}: ${text}`;\n        for (const pair of pairs(args || {})) {\n            const [key, value] = pair;\n            // tslint:disable-next-line\n            console.log(prefix, key, value);\n        }\n    }\n\n    debug(text: string, args?: Args): void {\n        this.emit(Level.debug, text, args);\n    }\n\n    warning(text: string, args?: Args): void {\n        this.emit(Level.warning, text, args);\n    }\n\n    error(text: string, args?: Args): void {\n        this.emit(Level.error, text, args);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/log.ts","/**\n * Encapsulated key-value storage on top of JS data objects.\n * For more about data objects, see `data.ts`.\n */\n\n/** This line does nothing but make typedoc render the module comment. */\n\n\nimport {\n    Data,\n    copy,\n    updated,\n    keys,\n    values,\n    pairs,\n    each,\n    map,\n    length,\n    equals,\n    EachCallback,\n    PairCallback,\n    Len,\n} from \"./data\";\n\n\n/**\n * Convenient encapsulated storage for key-value mappings.\n *\n * This class wraps the lower-level functions from `data.ts`, exposing\n * primitive operations while hiding the representation.\n *\n * @param V     Type of values stored in the table.\n *\n */\nexport class Table<V> {\n    /**\n     * Internal data object encapsulated by this table.\n     */\n    protected _data: Data<V>;\n\n    /**\n     * Wrap the given data object with a Table.\n     *\n     * This doesn't copy the data object, so if you make changes to it without\n     * using the table then you will break encapsulation. Easier ways to use it\n     * would include passing an object literal or passing a copy.\n     */\n    constructor (data: Data<V>) {\n        this._data = data;\n    }\n\n    /**\n     * Give the number of items in the table.\n     */\n    get length(): number {\n        return length(this._data);\n    }\n\n    /**\n     * Compare this table to another for equality of their contents.\n     */\n    equals(table: Table<V>): boolean {\n        return equals(table._data, this._data);\n    }\n\n    /**\n     * Make a copy of the table based on a shallow copy of its contents.\n     */\n    copy(): Table<V> {\n        return new Table<V>(copy(this._data));\n    }\n\n    /**\n     * Make a copy of the table with k/v overrides from another table.\n     */\n    updated(other: Table<V>): Table<V> {\n        const data = updated<V>(this._data, other._data);\n        return new Table<V>(data);\n    }\n\n    /**\n     * Make a shallow copy of the underlying data.\n     */\n    data(): Data<V> {\n        return copy(this._data);\n    }\n\n    /**\n     * Get the value for the specified key in the table.\n     */\n    get(key: string): V {\n        return this._data[key];\n    }\n\n    /**\n     * List the keys in the table.\n     */\n    keys(): string[] {\n        return keys(this._data);\n    }\n\n    /**\n     * List the values in the table.\n     */\n    values(): V[] {\n        return values(this._data);\n    }\n\n    /**\n     * List the `[key, value]` pairs in the table.\n     */\n    pairs(): [string, V][] {\n        return pairs(this._data);\n    }\n\n    /**\n     * Run the side-effecting `callback(key: string, value: V): void` for each\n     * pair in the table.\n     */\n    each(callback: EachCallback<V>): void {\n        each(this._data, callback);\n    }\n\n    /**\n     * Get the result of applying callback to each `[key, value]` pair, as a\n     * new table.\n     */\n    map(callback: PairCallback<V>): Table<V> {\n        return new Table(map(this._data, callback));\n    }\n\n}\n\n\nexport class MutableTable<V> extends Table<V> {\n\n    /**\n     * Allow keys to be set.\n     *\n     * For when you can't just build up the whole thing at once.\n     */\n    set(key: string, value: V): void {\n        this._data[key] = value;\n    }\n\n    /**\n     * Ensure that a copy of a MutableTable is also mutable.\n     */\n    copy(): MutableTable<V> {\n        return new MutableTable(copy(this._data));\n    }\n\n    /**\n     * Make a copy of the table with k/v overrides from another table.\n     */\n    updated(other: Table<V>): MutableTable<V> {\n        // TODO: makes copies, ugh\n        const data = updated<V>(this._data, other.data());\n        // can't really use super.updated(other)\n\n        const result = new MutableTable<V>(data);\n        return result;\n    }\n\n    /**\n     * Set keys from another table.\n     */\n    update(other: Table<V>): void {\n        for (const pair of other.pairs()) {\n            const [key, value] = pair;\n            this.set(key, value);\n        }\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/table.ts","import { Frontend } from \"../../frontend\";\nimport { Host } from \"../../host\";\nimport { ServiceFrontend } from \"../../service_frontend\";\nimport { BasemapService } from \"./service\";\nimport { parse_basemaps } from \"./parse\";\n\n\nexport class BasemapFrontend extends ServiceFrontend {\n    service: BasemapService;\n\n    constructor (frontend: Frontend, host: Host) {\n        const service = new BasemapService();\n        super(service, frontend, host);\n    }\n\n    /**\n     * Get a list of basemaps.\n     */\n    async basemaps() {\n        // TODO: does this need login?\n        // await this.need_login();\n\n        const endpoint = this.service.endpoint(\"metadata\");\n        const request = endpoint.request(this.host.url);\n        const response = await this.send(request);\n        return parse_basemaps(response);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/basemap/frontend.ts","import { Log } from \"../../log\";\nimport { Frontend } from \"../../frontend\";\nimport { Host } from \"../../host\";\nimport { Query } from \"../../query\";\nimport { Address, Coordinates } from \"../../location\";\nimport { ServiceFrontend } from \"../../service_frontend\";\nimport { GeocodingService } from \"./service\";\nimport { parse_geocodes } from \"./parse\";\n\n\nexport class GeocodingFrontend extends ServiceFrontend {\n    service: GeocodingService;\n\n    constructor (frontend: Frontend, host: Host) {\n        const service = new GeocodingService();\n        super(service, frontend, host);\n        this.log = new Log(\"geocoding\");\n    }\n\n    // TODO: type provider with an enum\n    /**\n     * Get a list of possible locations for an address.\n     */\n    async geocode(\n        address: Address,\n        // vestigial: \"boundless\" as in bcs-geocoding-boundless role\n        provider?: \"mapzen\" | \"mapbox\",\n    ) {\n        // TODO\n        // await this.need_login();\n        provider = provider || \"mapbox\";\n        if (!address) {\n            throw new Error(\"need an address to geocode\");\n        }\n\n        const endpoint = this.service.endpoint(\"forward\");\n        const request = endpoint.request(this.host.url, {\n            \"provider\": provider,\n            \"address\": encodeURIComponent(address as string),\n        });\n        const response = await this.send(request);\n        this.log.debug(\"geocode\", {\"response\": response});\n        return parse_geocodes(response);\n    }\n\n    // TODO: type provider with an enum\n    /**\n     * Get a list of possible addresses for a location.\n     */\n    async reverse_geocode(coordinates: Coordinates, provider?: string) {\n        // TODO\n        // await this.need_login();\n        if (!coordinates) {\n            throw new Error(\"need coordinates to reverse geocode\");\n        }\n        const endpoint = this.service.endpoint(\"reverse\");\n        const request = endpoint.request(this.host.url, {\n            \"provider\": provider || \"mapbox\",\n            \"x\": coordinates[1],\n            \"y\": coordinates[0],\n        });\n        const response = await this.send(request);\n        this.log.debug(\"reverse_geocode\", {\"response\": response});\n        return parse_geocodes(response);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/geocoding/frontend.ts","import { Frontend } from \"../../frontend\";\nimport { Host } from \"../../host\";\nimport { Query } from \"../../query\";\nimport { ServiceFrontend } from \"../../service_frontend\";\nimport { RoutingService } from \"./service\";\nimport { Route } from \"./route\";\n\nimport { Location, Point, Coordinates, is_coordinates } from \"../../location\";\n\n\nexport class RoutingFrontend extends ServiceFrontend {\n    service: RoutingService;\n\n    constructor (frontend: Frontend, host: Host) {\n        const service = new RoutingService();\n        super(service, frontend, host);\n    }\n\n    /**\n     * Get a route.\n     *\n     * This accepts a list of locations which can either represent points or\n     * addresses. The interface has to be polymorphic in case users actually\n     * need to route through locations specified in different ways. Otherwise,\n     * the client would have to do all the geocoding itself.\n     *\n     * @param locations     A list of locations - addresses or points.\n     * @param service       The name of a service. Default \"mapbox\".\n     */\n    async route(locations: Location[], provider?: \"mapbox\" | \"mapzen\") {\n        provider = provider || \"mapbox\";\n        if (locations.length < 2) {\n            throw new Error(\"need at least two locations to route\");\n        }\n\n        const strings: string[] = [];\n        for (const loc of locations) {\n            let one: string;\n            if (typeof loc === \"string\") {\n                one = loc;\n            }\n            else if (loc instanceof Point) {\n                one = `${loc.y},${loc.x}`;\n            }\n            else if (is_coordinates(loc)) {\n                // service expects lon, lat\n                one = `${loc[1]},${loc[0]}`;\n            }\n            else {\n                const loc_type = (typeof loc);\n                throw new Error(`unsupported location type: ${loc_type}`);\n            }\n            strings.push(one);\n        }\n\n        const endpoint = this.service.endpoint(\"waypoints\");\n        const request = endpoint.request(this.host.url, {\n            \"provider\": provider,\n            \"waypoints\": strings.join(\"|\") || \"\",\n        });\n        const response = await this.send(request);\n        return Route.parse(response);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/routing/frontend.ts","import { Frontend } from \"../../frontend\";\nimport { Query } from \"../../query\";\nimport { Host } from \"../../host\";\nimport { ServiceFrontend } from \"../../service_frontend\";\nimport { SearchService } from \"./service\";\nimport {\n    parse_search_results,\n    parse_search_categories,\n} from \"./parse\";\n\n\nexport class SearchFrontend extends ServiceFrontend {\n    service: SearchService;\n\n    constructor (frontend: Frontend, host: Host) {\n        const service = new SearchService();\n        super(service, frontend, host);\n    }\n\n    async search(\n        // endpoint doesn't require this but we do, because why\n        text: string,\n        categories: string[] = [\"ALL\"],\n        results_per_page: number = 20,\n        starting_page: number = 0,\n    ) {\n        const endpoint = this.service.endpoint(\"search\");\n        const cat = categories.join(\",\");\n        const request = endpoint.request(this.host.url, {\n            \"text\": text,\n            \"cat\": cat,\n            \"results_per_page\": results_per_page,\n            \"starting_page\": starting_page,\n        });\n        const response = await this.send(request);\n        return parse_search_results(response);\n    }\n\n    async search_data() {\n        const endpoint = this.service.endpoint(\"search_data\");\n        const request = endpoint.request(this.host.url, {});\n        const response = await this.send(request);\n        return parse_search_results(response);\n    }\n\n    async get_categories() {\n        const endpoint = this.service.endpoint(\"categories\");\n        const request = endpoint.request(this.host.url, {});\n        const response = await this.send(request);\n        return parse_search_categories(response);\n    }\n\n    async search_in_category(category: string, q: string) {\n        const endpoint = this.service.endpoint(\"search_in_category\");\n        const request = endpoint.request(this.host.url, {\n            \"category\": category,\n            \"q\": q,\n        });\n        const response = await this.send(request);\n        return parse_search_results(response);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/search/frontend.ts","import { Client } from \"../../client\";\nimport { Host } from \"../../host\";\nimport { Query } from \"../../query\";\nimport { Username, Password, LoginError } from \"../../auth\";\nimport { ServiceFrontend } from \"../../service_frontend\";\nimport { TokenService } from \"./service\";\nimport { response_to_jwt } from \"./parse\";\nimport { Frontend } from \"../../frontend\";\n\n\nexport class TokenFrontend extends ServiceFrontend {\n    service: TokenService;\n\n    constructor (frontend: Frontend, host: Host) {\n        const service = new TokenService();\n        super(service, frontend, host);\n    }\n\n    /**\n     * Get a token and return it without other side effects.\n     */\n    async get_token(username: Username, password: Password) {\n        // If Javascript consumers pass null values, don't propagate them.\n        if (!username) {\n            throw new LoginError(\"username is required\");\n        }\n        if (!password) {\n            throw new LoginError(\"password is required\");\n        }\n\n        const endpoint = this.service.endpoint(\"get_token\");\n        const request = endpoint.request(this.host.url, {\n            \"username\": username as string,\n            \"password\": password as string,\n        });\n        const response = await this.send(request);\n        return response_to_jwt(response);\n    }\n\n    /**\n     * (We usually already have the roles...)\n     */\n    async get_roles() {\n        const endpoint = this.service.endpoint(\"get_roles\");\n        const request = endpoint.request(this.host.url, {});\n        const response = await this.send(request);\n        // TODO\n        // return parse_entitlements(response);\n        return response;\n    }\n\n    async get_apikey() {\n        // TODO\n    }\n\n    async get_oauth(username: Username, password: Password) {\n        // const uri = \"/token/oauth\";\n    }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/token/frontend.ts","import { URL } from \"./http\";\nimport { Headers } from \"./headers\";\n\nexport class InvalidHost extends Error {\n}\n\nexport class Host {\n    url: URL;\n    headers: Headers;\n\n    constructor (url: URL, headers?: Headers) {\n        this.url = url;\n\n        // Validate that the URL looks vaguely sane as an absolute URL.\n        // This helps protect everything downstream.\n        const regex = /^(https?):\\/\\/(.+)$/;\n        const match = url.match(regex);\n        if (!match) {\n            throw new InvalidHost(\n                `can't create Host with malformed URL: ${url}`,\n            );\n        }\n        this.headers = headers || new Headers();\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/host.ts","/**\n * Utilities for working with HTTP request data.\n */\n\n/** This line does nothing but make typedoc render the module comment. */\n\nimport { InvalidObject } from \"./errors\";\nimport { Query } from \"./query\";\nimport { Headers, HeaderData } from \"./headers\";\nimport { Method, URI, URL, Body } from \"./http\";\n\n\n// TODO: maybe do a RequestData and have Request unpack from that, then I can\n// verify on keywords instead of ordered-ugh\n\n\n/**\n * Interchange format for data in HTTP request headers.\n */\nexport class RequestHeaderData extends HeaderData {\n}\n\n\nexport class InvalidRequest extends InvalidObject {\n    readonly name: string = \"InvalidRequest\";\n    readonly message: string;\n}\n\n\n/**\n * Bundle of parameters for an HTTP request.\n *\n * This class represents \"abstract requests,\" intentionally excluding\n * anything pertaining to the actual performance of the described request, the\n * progress of that request, or anything about the resulting response.\n *\n * It is basically an annotated tuple which can generate a URL for you, and\n * associate it with headers and body to be sent.\n *\n */\nexport class Request {\n    readonly method: Method;\n    _url: URL;\n    readonly body: Body;\n    readonly query: Query;\n    headers: Headers;\n\n    // timeout is intentionally excluded, it's a performance issue\n    // for Client/Transfer.\n\n    constructor (\n        // HTTP method\n        method: Method,\n        // URL for request, not including querystring\n        url: URL,\n        // Query parameters: mapping of names to string values\n        query?: Query,\n        // bytes to send in body\n        body?: Body,\n        // Headers: mapping of names to string values\n        headers?: Headers,\n    ) {\n        this.method = method;\n        if (url.indexOf(\"?\") > -1) {\n            throw new InvalidRequest(\n                \"argument for url parameter must not include ?\",\n            );\n        }\n        this._url = url as URL;\n        this.query = query || new Query();\n        this.headers = headers || new Headers();\n        this.body = body || \"\" as Body;\n    }\n\n    equals(request: Request): boolean {\n        return (\n            request.method === this.method\n            && request.url === this.url\n            && request.body === this.body\n            && request.query.equals(this.query)\n            && request.headers.equals(this.headers)\n        );\n    }\n\n    copy(): Request {\n        return new Request(\n            this.method,\n            this._url,\n            // query: immutable\n            this.query,\n            this.body,\n            // headers: mutable\n            this.headers ? this.headers.copy() : this.headers,\n        );\n    }\n\n    get url(): string {\n        let result: string;\n        const query_string = this.query.encoded;\n        if (query_string) {\n            result = `${this._url}?${query_string}`;\n        }\n        else {\n            result = this._url as string;\n        }\n        return result;\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/request.ts","/**\n * Utilities for working with HTTP response data.\n */\n\n/** This line does nothing but make typedoc render the module comment. */\n\nimport { InvalidObject } from \"./errors\";\nimport { Headers, HeaderData } from \"./headers\";\n\n\n/**\n * Interchange format for data in HTTP response headers.\n */\nexport class ResponseHeaderData extends HeaderData {\n}\n\n\nexport class InvalidResponse extends InvalidObject {\n}\n\n\n/* Hold data on one HTTP response which might have been received.\n *\n * Only makes sense if the request is complete.\n */\nexport class Response {\n    // HTTP response status code, as an integer.\n    // https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/status\n    public readonly status: number;\n\n    // Mapping of received headers.\n    private _headers: Headers;\n    private _get_headers: (() => Headers);\n\n    // Raw data from the response body.\n    public readonly body: string;\n\n    constructor (\n        status: number,\n        headers?: Headers | ResponseHeaderData | (() => Headers),\n        body?: string,\n    ) {\n        this.status = status;\n        if (headers instanceof Headers) {\n            this._headers = headers;\n        }\n        else if (headers instanceof Function) {\n            this._get_headers = headers;\n        }\n        else {\n            this._headers = new Headers(headers || {});\n        }\n        this.body = body || \"\";\n    }\n\n    get headers() {\n        if (!this._headers) {\n            this._headers = this._get_headers();\n        }\n        return this._headers;\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/response.ts","/**\n * Representations and routines for parsing geocoding service results.\n */\n\nimport { Response } from \"../../response\";\nimport { parse_response } from \"../../parse\";\nimport { Point, Address } from \"../../location\";\nimport { parse_geocodes } from \"./parse\";\n\n\nexport class GeocodesData {\n    geocodePoints: GeocodeData[];\n    errorCode: number;\n    errorMessage: string;\n    id: undefined;\n}\n\n\n/**\n * Define structure of result format from geocoding service\n */\nexport class GeocodeData {\n    candidatePlace: string;\n    candidateSource: string;\n    score: number;\n    x: number;\n    y: number;\n}\n\n\n/**\n * ONE result from the geocoding service, a \"candidate\" matching some name or\n * lat/lon. The service will typically return an array of these.\n */\nexport class Geocode extends Point {\n    // x: number;\n    // y: number;\n    // address: string;\n    // score: number;\n    // source: string;\n\n    constructor (\n        public address: Address,\n        public source: string,\n        public score: number,\n        public x: number,\n        public y: number,\n    ) {\n        super(x, y);\n    }\n\n    static parse(response: Response): Geocode[] {\n        return parse_geocodes(response);\n    }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/geocoding/geocode.ts","import { Response } from \"../../response\";\nimport { parse_response } from \"../../parse\";\nimport { Geocode, GeocodesData } from \"./geocode\";\n\n\nclass ParseError extends Error {}\n\n\nexport function parse_geocodes(response: Response): Geocode[] {\n    const data = parse_response<GeocodesData>(response);\n    // The envelope is irrelevant after we've checked for an error\n    return data.geocodePoints.map((item) => {\n        return new Geocode(\n            // address\n            item.candidatePlace,\n            // source\n            item.candidateSource,\n            // score\n            item.score,\n            // point\n            item.y,\n            item.x,\n        );\n    });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/geocoding/parse.ts","import { Point, Coordinates } from \"../../location\";\nimport { Response } from \"../../response\";\nimport { parse_route } from \"./parse\";\n\n\n/**\n * Geometry representation used in StepData.\n */\nclass GeometryData {\n    type: \"LineString\";\n    coordinates: Coordinates[];\n}\n\nclass Instructions extends String {\n}\n\nclass Distance extends Number {\n}\n\nclass Duration extends Number {\n}\n\n/**\n * Define structure of objects in \"steps\" array in LegData.\n */\nclass StepData {\n    distance: number;\n    duration: number;\n    instructions: Instructions;\n    geometry: GeometryData;\n}\n\n/**\n * Define structure of objects in \"legs\" array in RouteData.\n */\nclass LegData {\n    distance: number;\n    duration: number;\n    steps: StepData[];\n}\n\n\n/**\n * Define structure of routing service responses.\n */\nexport class RouteData {\n    id: undefined;\n    distance: number;\n    duration: number;\n    legs: LegData[];\n    geometry: GeometryData;\n\n    errorCode: number;\n    errorMessage: string;\n}\n\n\nexport class Route {\n    _legs: Leg[];\n    _points: Point[];\n    distance: Distance;\n    duration: Duration;\n\n    constructor (\n        legs: Leg[],\n        distance: Distance,\n        duration: Duration,\n        points?: Point[],\n    ) {\n        this._legs = legs;\n        this.distance = distance;\n        this.duration = duration;\n        this._points = points || [];\n    }\n\n    static parse(response: Response): Route {\n        return parse_route(response);\n    }\n\n    get legs(): Leg[] {\n        return this._legs;\n    }\n\n    get steps(): Step[] {\n        const steps: Step[] = [];\n        for (const leg of this.legs) {\n            steps.push(...leg.steps);\n        }\n        return steps;\n    }\n\n    get points(): Point[] {\n        const points: Point[] = [];\n        for (const step of this.steps) {\n            points.push(...step.points);\n        }\n        return points;\n    }\n\n    get instructions(): Instructions[] {\n        const lines = [];\n        for (const step of this.steps) {\n            lines.push(step.instructions);\n        }\n        return lines;\n    }\n\n    progress(leg: number, step: number, point: number) {\n        leg = leg || 0;\n        step = step || 0;\n        point = point || 0;\n    }\n}\n\n\nexport class Leg {\n    _steps: Step[];\n    distance: Distance;\n    duration: Duration;\n\n    constructor (steps: Step[], distance: number, duration: number) {\n        this._steps = steps;\n        this.distance = distance;\n        this.duration = duration;\n    }\n\n    get steps() {\n        return this._steps;\n    }\n\n    get points(): Point[] {\n        const points: Point[] = [];\n        for (const step of this.steps) {\n            points.push(...step.points);\n        }\n        return points;\n    }\n\n    get instructions(): Instructions[] {\n        const lines = [];\n        for (const step of this.steps) {\n            lines.push(step.instructions);\n        }\n        return lines;\n    }\n\n}\n\n\nexport class Step {\n    _points: Point[];\n    instructions: Instructions;\n    distance: Distance;\n    duration: Duration;\n\n    constructor (\n        points: Point[],\n        instructions: Instructions,\n        distance: Distance,\n        duration: Duration,\n    ) {\n        this._points = points;\n        this.instructions = instructions;\n        this.distance = distance;\n        this.duration = duration;\n    }\n\n    get points(): Point[] {\n        return this._points;\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/routing/route.ts","/**\n * Implementation targeting ES5 in the browser, using vanilla XMLHttpRequest.\n */\n\n/** This line does nothing but make typedoc render the module comment. */\n\nimport { Request } from \"../request\";\nimport { Response } from \"../response\";\nimport { ClientBase } from \"../client\";\nimport { TransferBase } from \"../transfer\";\nimport { Body } from \"../http\";\nimport { XHR } from \"../xhr\";\n\n\n/**\n * Transfer implementation for browser_es5.\n */\nexport class BrowserTransfer extends TransferBase {\n    // Each instance gets its own instance of XMLHttpRequest bound to its\n    // listener callacks. Neither a transfer nor an XHR should be reused for\n    // multiple HTTP requests.\n    private xhr: XHR;\n\n    constructor (request: Request, timeout?: number) {\n        super(request);\n        this.timeout = timeout || 0;\n        this.xhr = this.new_xhr();\n    }\n\n    /**\n     * Create an XMLHttpRequest that tells this when things happen.\n     */\n    private new_xhr(): XHR {\n        const xhr = new XHR(this.timeout || 0);\n\n        // const xhr = new XMLHttpRequest();\n        const listen = (name: string, bindable: Function) => {\n            const bound = bindable.bind(this);\n            xhr.listen(name, bound);\n            // xhr.addEventListener(name, bound);\n        };\n        listen(\"loadstart\", this.on_loadstart);\n        listen(\"progress\", this.on_progress);\n        listen(\"load\", this.on_load);\n        listen(\"loadend\", this.on_loadend);\n        listen(\"abort\", this.on_abort);\n        listen(\"error\", this.on_error);\n        listen(\"timeout\", this.on_timeout);\n        return xhr;\n    }\n\n    protected finish(cause: string): void {\n        super.finish(cause);\n    }\n\n    public async promise(): Promise<Response> {\n        const headers = (\n            this.request.headers\n            ? this.request.headers.pairs()\n            : []\n        );\n        // Mark that we're working for benefit of callers holding transfer.\n        this.started = true;\n        // Get the XHR rolling.\n        const body = this.request.body || \"\";\n        this.xhr.start(\n            this.request.method,\n            this.request.url,\n            headers,\n            body as string,\n        );\n        await this.xhr.promise();\n        return this.response;\n    }\n\n    // TODO: add progress interface\n    // TODO: add callback for doneness if not using the promise?\n\n    /**\n     * Expose response for callers holding the transfer object.\n     */\n    get response() {\n        // Auto-unpack response\n        return this.xhr.response;\n    }\n\n    public abort() {\n        if (this.xhr) {\n            this.xhr.abort();\n        }\n        this.aborted = true;\n    }\n\n    // The following methods are used as event listeners called by the xhr to\n    // keep the transfer informed of the latest, so that callers holding a\n    // reference to the transfer can check it out as needed.\n\n    /**\n     * Progress begun.\n     *\n     * https://developer.mozilla.org/en-US/docs/Web/Events/loadstart\n     */\n    on_loadstart(ev: ProgressEvent) {\n        this.receive_progress.update_from_event(ev);\n    }\n\n    /**\n     * Progress update.\n     *\n     * https://developer.mozilla.org/en-US/docs/Web/Events/progress\n     */\n    on_progress(ev: ProgressEvent) {\n        this.receive_progress.update_from_event(ev);\n    }\n\n    /**\n     * Finished loading.\n     *\n     * https://developer.mozilla.org/en-US/docs/Web/Events/load\n     */\n    on_load(ev: UIEvent) {\n        this.finish(\"load\");\n    }\n\n    /**\n     * Request completed, whether or not successful.\n     *\n     * https://developer.mozilla.org/en-US/docs/Web/Events/loadend\n     */\n    on_loadend(ev: ProgressEvent) {\n        this.receive_progress.update_from_event(ev);\n        this.finish(\"loadend\");\n    }\n\n    /**\n     * Request aborted, e.g. by a user action.\n     *\n     * https://developer.mozilla.org/en-US/docs/Web/Events/abort\n     */\n    on_abort(ev: UIEvent | Event) {\n        this.finish(\"abort\");\n    }\n\n    /**\n     * Failed to load.\n     *\n     * https://developer.mozilla.org/en-US/docs/Web/Events/error\n     */\n    on_error(ev: UIEvent | Event) {\n        this.error = ev;\n        this.finish(\"error\");\n    }\n\n    /**\n     * The preset timeout expired.\n     *\n     * https://developer.mozilla.org/en-US/docs/Web/Events/timeout\n     */\n    on_timeout(ev: ProgressEvent) {\n        this.finish(\"timeout\");\n        this.receive_progress.update_from_event(ev);\n    }\n}\n\n\n/**\n * Client implementation for browser_es5.\n */\nexport class BrowserClient extends ClientBase {\n    constructor () {\n        super(BrowserTransfer);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/flavors/browser_es5.ts","// General utilities\nimport { pairs } from \"./data\";\nimport { Log } from \"./log\";\n\n// Base\nimport { InvalidObject } from \"./errors\";\n\n// HTTP request/response processing\nimport { Host } from \"./host\";\nimport { Method, URI, URL, Body } from \"./http\";\nimport { Username, Password, LoginError } from \"./auth\";\nimport { Request } from \"./request\";\nimport { Query } from \"./query\";\nimport { Headers } from \"./headers\";\nimport { Client } from \"./client\";\nimport { Transfer } from \"./transfer\";\nimport { ServiceFrontend } from \"./service_frontend\";\n\n// We always use the token service for login\nimport { JWT } from \"./services/token/jwt\";\nimport { TokenFrontend } from \"./services/token/frontend\";\n\n// We may also use other services\nimport { FrontendClass } from \"./service_frontend\";\nimport { RoutingFrontend } from \"./services/routing/frontend\";\nimport { BasemapFrontend } from \"./services/basemap/frontend\";\nimport { GeocodingFrontend } from \"./services/geocoding/frontend\";\nimport { SearchFrontend } from \"./services/search/frontend\";\n\nclass Provider extends String {\n}\n\n\n/**\n * Base for top-level facade objects to give API users a friendly entry point.\n */\nexport class Frontend {\n    /**\n     * jwt is either undefined in the case that there has not been a login, or\n     * it is a JWT instance representing the result.\n     *\n     * This is publicly exposed from the Frontend so that users don't have to\n     * directly handle results from login() to know whether they are logged in,\n     * what roles they have, etc. So many use cases are liable to need access\n     * to this that it shouldn't require much effort from the user to get it.\n     */\n    public jwt: JWT | undefined;\n\n    /**\n     * Log instance used internally by the Frontend instance.\n     */\n    protected log: Log;\n\n    /**\n     * Implements the token service wrapper.\n     */\n    tokens: TokenFrontend;\n\n    /**\n     * Implements the basemap service wrapper.\n     *\n     * Should be undefined if this service is not going to be used.\n     */\n    basemaps?: BasemapFrontend;\n\n    /**\n     * Implements the geocoding service wrapper.\n     *\n     * Should be undefined if this service is not going to be used.\n     */\n    geocoding?: GeocodingFrontend;\n\n    /**\n     * Implements the routing service wrapper.\n     *\n     * Should be undefined if this service is not going to be used.\n     */\n    routing?: RoutingFrontend;\n\n    /**\n     * Implements the search service wrapper.\n     *\n     * Should be undefined if this service is not going to be used.\n     */\n    search?: SearchFrontend;\n\n    /**\n     * Headers to be added to every outgoing request from the Frontend.\n     *\n     * Particular instances of Frontend may override this.\n     */\n    default_headers = new Headers({\n        \"User-Agent\": \"Because\",\n        \"Accept\": \"application/json\",\n    });\n\n    constructor (\n        public classes: {[name: string]: FrontendClass},\n        private client: Client,\n        public host: Host,\n        public debug?: boolean,\n    ) {\n        if (!classes) {\n            throw new InvalidObject(\n                \"must pass an object mapping frontend classes\",\n            );\n        }\n        if (!client) {\n            throw new InvalidObject(\n                \"must pass a client\",\n            );\n        }\n        if (!host || !(host instanceof Host)) {\n            throw new InvalidObject(\n                \"must pass a Host instance\",\n            );\n        }\n        this.client = client;\n        this.host = host;\n        this.debug = debug || false;\n        this.jwt = undefined;\n        this.log = new Log(\"because\");\n\n        // Always get a TokenFrontend so we can log in\n        this.tokens = new TokenFrontend(this, host);\n\n        // Use the passed ServiceFrontends\n        this.add_service_frontends(classes);\n    }\n\n    private add_service_frontends(classes: {[name: string]: FrontendClass}) {\n        for (const pair of pairs(classes)) {\n            const name: string = pair[0];\n            const cls: FrontendClass = pair[1];\n            const frontend = new cls(this, this.host);\n            this.add_service_frontend(frontend);\n        }\n    }\n\n    private add_service_frontend(frontend: ServiceFrontend) {\n        // TODO: has to be a better way\n        if (frontend instanceof TokenFrontend) {\n            this.tokens = frontend;\n        }\n        else if (frontend instanceof BasemapFrontend) {\n            this.basemaps = frontend;\n        }\n        else if (frontend instanceof GeocodingFrontend) {\n            this.geocoding = frontend;\n        }\n        else if (frontend instanceof RoutingFrontend) {\n            this.routing = frontend;\n        }\n        else if (frontend instanceof SearchFrontend) {\n            this.search = frontend;\n        }\n    }\n\n    /**\n     * Construct a request with the appropriate User-Agent and Auth headers.\n     */\n    request(\n        // HTTP method\n        method: Method,\n        // HTTP relative URI\n        uri: URI,\n        // URL query parameters\n        query?: Query,\n        // Request body data\n        body?: Body,\n        // HTTP request headers\n        headers?: Headers,\n    ): Request {\n        headers = this.enriched_headers(headers);\n        const url = `${this.host.url}/${uri}`;\n        return new Request(method, url, query, body, headers);\n    }\n\n    private enriched_headers(headers?: Headers): Headers {\n        const enriched: Headers = (\n            headers\n            ? headers.updated(this.default_headers)\n            : this.default_headers.copy()\n        );\n        if (this.jwt) {\n            enriched.set(\"Authorization\", `Bearer ${this.jwt.token}`);\n        }\n        return enriched;\n\n    }\n\n    /**\n     * Get a token and cache it on this instance for reuse.\n     *\n     * This should normally be preferred to ensure that tokens are locally\n     * cached, avoid redundant HTTP requests, and provide better ease-of-use.\n     */\n    async login(username: Username, password: Password) {\n        const frontend: TokenFrontend | undefined = this.tokens;\n        let jwt: JWT | undefined;\n        if (frontend) {\n            jwt = await frontend.get_token(username, password);\n            this.jwt = jwt;\n        }\n        else {\n            this.log.error(\"cannot login without token service loaded\");\n        }\n        return jwt;\n    }\n\n    /**\n     * Encapsulate this.client.send.\n     *\n     * If other methods use this method instead of directly calling\n     * this.client.send, then this instance can uniformly enforce policy around\n     * requests, like logging and 403 handling.\n     */\n    send(request: Request): Transfer {\n        const headers = this.enriched_headers(request.headers);\n        // TODO\n        request.headers = headers;\n        this.log.debug(\"about to send\", {\"request\": request});\n        const transfer = this.client.send(request);\n        return transfer;\n    }\n\n    /**\n     * Assert that we have a token to log in with.\n     *\n     * Methods on this class can simplify their implementation by awaiting this\n     * to ensure they do not issue any requests without having a token to send.\n     *\n     * In the future this may be changed to automatically accomplish login if\n     * there is a way to do that.\n     */\n    private async need_login() {\n        if (!this.jwt || !this.jwt.token) {\n            throw new Error(\"not logged in\");\n        }\n        return this.jwt;\n    }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/frontend.ts","import { URL } from \"./http\";\nimport { Host } from \"./host\";\n\n\n// Shortcut\nexport {\n    Host,\n};\n\n\nexport const urls: {[env: string]: URL} = {\n    \"dev\": \"https://api.dev.boundlessgeo.io/v1\",\n    \"test\": \"https://api.test.boundlessgeo.io/v1\",\n    \"prod\": \"https://api.boundlessgeo.io/v1\",\n    \"local\": \"http://localhost:8000/v1\",\n};\n\n\nexport const hosts: {[env: string]: Host} = {\n    \"dev\": new Host(urls.dev),\n    \"test\": new Host(urls.test),\n    \"prod\": new Host(urls.prod),\n    \"local\": new Host(urls.local),\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/hosts.ts","/**\n * This file defines some simple types for representing data associated with\n * authentication.\n */\n\n/** This line does nothing but make typedoc render the module comment. */\n\nimport { BecauseError } from \"./errors\";\n\n\n/**\n * Simple type wrapper to help avoid mixing up usernames with other data stored\n * in strings.\n */\nexport class Username extends String {\n}\n\n/**\n * Simple type wrapper to help avoid mixing up passwords with other data stored\n * in strings.\n */\nexport class Password extends String {\n}\n\n/**\n * Simple type for passing around a username and password together.\n */\nexport class Credentials {\n    public username: Username;\n    public password: Password;\n}\n\n/**\n * Error class that can be thrown when there was a problem logging in.\n */\nexport class LoginError extends BecauseError {\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/auth.ts","/**\n * Entry point to be used in the browser.\n *\n * This module is referenced by the `\"browser\"` property in `package.json`.\n * This hint may be used by tools like browserify, webpack and jspm.\n * For more information about how some tools may use this property, see\n * https://github.com/defunctzombie/package-browser-field-spec.\n */\n\n/** This line does nothing but make typedoc render the module comment. */\n\nimport { Request } from \"./request\";\nimport { Headers } from \"./headers\";\nimport { Query } from \"./query\";\nimport { Frontend } from \"./frontend\";\nimport { Host, hosts } from \"./hosts\";\n\n// The Because class \"ships\" with everything loaded on it\nimport { FrontendClass } from \"./service_frontend\";\nimport { TokenFrontend } from \"./services/token/frontend\";\nimport { RoutingFrontend } from \"./services/routing/frontend\";\nimport { BasemapFrontend } from \"./services/basemap/frontend\";\nimport { GeocodingFrontend } from \"./services/geocoding/frontend\";\nimport { SearchFrontend } from \"./services/search/frontend\";\n\nimport {\n    BrowserClient as Client,\n    BrowserTransfer as Transfer,\n} from \"./flavors/browser_es5\";\n\n\n/**\n * Top-level frontend implementation for the browser.\n */\nexport class Because extends Frontend {\n    constructor (env?: string, debug?: boolean) {\n        env = env || \"test\";\n        const host: Host = hosts[env];\n        if (!host) {\n            throw new Error(`unknown environment '${env}'`);\n        }\n        if (!host.url) {\n            throw new Error(`bad host for '${env}'`);\n        }\n        const classes: {[name: string]: FrontendClass} = {\n            \"tokens\": TokenFrontend,\n            \"routing\": RoutingFrontend,\n            \"geocode\": GeocodingFrontend,\n            \"basemap\": BasemapFrontend,\n            \"search\": SearchFrontend,\n        };\n        super(classes, new Client(), host, debug);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/browser.ts","/**\n * Base interface and implementation for Client implementations.\n *\n * A `Client` implementation, along with a `Transfer` implementation, defines a\n * way for this library to make HTTP requests, collect HTTP responses, and\n * allow monitoring of progress in between.\n *\n * This allows abstraction of the rest of the library away from details like\n * e.g. whether one is using Angular or vanilla XHR, fetch, Node, Bluebird,\n * ES2017 with async, etc. Then code for various things like validating\n * parameters, generating requests, parsing responses and creating nice objects\n * for results can be shared across implementations, because it is not coupled\n * to any particular implementation.\n *\n * And this allows users of this shared code to exploit it from whatever\n * environment *their* code wants to run in. It's a politeness when you have\n * people who want to use your code across different kinds of environments.\n */\n\n/** This line does nothing but make typedoc render the module comment. */\n\nimport { Request } from \"./request\";\nimport {\n    TransferBase,\n    TransferConstructor,\n    Transfer,\n} from \"./transfer\";\n\n/**\n * Interface for Client implementations.\n *\n * `Client` implementations can use this in an `implements` clause to verify\n * that they provide the structural basics for a `Client` implementation.\n *\n * This interface does not include incidental but public properties defined in\n * `ClientBase` and should be more stable.\n */\nexport interface Client {\n    transfer(request: Request): Transfer;\n    send(request: Request): Transfer;\n}\n\n/**\n * Base for Client implementations.\n *\n * This is not named Client because it is not usable as-is. For that, you need\n * a Client implementation from one of the flavors.\n *\n * Since the Transfer implementation is usually where most of the action\n * happens, the Client subclass basically just provides an interface for the\n * end user.\n */\nexport class ClientBase implements Client {\n    /**\n     * Constructor invoked to make `Transfer` objects compatible with this\n     * `Client`.\n     *\n     * Client implementations subclassing `ClientBase` can override this\n     * property to specify which `Transfer` implementation they want to use.\n     * Then the superclass `transfer()` method should usually work as-is.\n     *\n     */\n    public readonly Transfer: TransferConstructor;\n\n    /**\n     * Construct a `Client` instance given a `Transfer` constructor.\n     */\n    constructor (Transfer: TransferConstructor) {\n        this.Transfer = Transfer;\n    }\n\n    /**\n     * Create a `Transfer` representing performance of the given `Request`.\n     *\n     * This method does not start the transfer, and is suitable for uses where\n     * you need to ensure that certain things are done *after* the `Transfer`\n     * is created, but *before* it is started.\n     */\n    public transfer(request: Request): Transfer {\n        const transfer = new this.Transfer(request);\n        return transfer;\n    }\n\n    /**\n     * Create and start a `Transfer` performing the given `Request`.\n     *\n     * This method is what you normally want to use if you just want to run an\n     * HTTP request in one shot.\n     */\n    public send(request: Request): Transfer {\n        const transfer = this.transfer(request);\n        // If we use the promise interface, we shouldn't need to start(),\n        // but it doesn't hurt anything since it's idempotent,\n        // and it is needed by people who aren't going to use the promise\n        transfer.start();\n        return transfer;\n    }\n}\n\n/**\n * Type for Client implementations.\n */\nexport interface ClientConstructor {\n    new (): Client;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/client.ts","import { Data } from \"./data\";\n\nconst REGEX = /{(.+?)}/g;\n\n\nexport function format(template: string, data?: Data<string>) {\n    return template.replace(REGEX, (match, value) => {\n        return (data ? data[value] : undefined) || \"\";\n    });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/format.ts","/**\n * Tools for representing the discrete progress of some process.\n *\n * This doesn't care about what the progress is of, or how it might be updated.\n * It's just a bundle of data with some convenience methods. But a normal use\n * would be to track the number of bytes sent or received in an HTTP\n * request/response cycle.\n */\n\n/** This line does nothing but make typedoc render the module comment. */\n\nexport interface ProgressInterface {\n    readonly done: number;\n    readonly total: number;\n    readonly left: number;\n    readonly percent: number;\n}\n\n\nexport class ProgressEventInterface {\n    loaded: number;\n    total: number;\n}\n\n/**\n * Internal representation for progress on things like HTTP response downloads.\n */\nexport class Progress implements ProgressInterface {\n\n    /**\n     * Count of items handled so far.\n     * Internal representation only available through accessors.\n     */\n    private _done: number;\n\n    /**\n     * Count of items to be handled, including those done.\n     * Internal representation only available through accessors.\n     */\n    private _total: number;\n\n    /**\n     * @param done      Count of items handled so far.\n     * @param total     Count of items to be handled, including those done.\n     */\n\n    constructor (done?: number, total?: number) {\n        this._done = (typeof done === \"undefined\" ? NaN : done);\n        this._total = (typeof total === \"undefined\" ? NaN : total);\n    }\n\n    /**\n     * @returns         Count of items handled so far.\n     */\n    get done(): number {\n        return this._done;\n    }\n\n    /**\n     * @returns         Count of items to be handled including, those done.\n     */\n    get total(): number {\n        return this._total;\n    }\n\n    /**\n     * @returns         Count of items yet to be done.\n     */\n    get left(): number {\n        if (isNaN(this.total)) {\n            return NaN;\n        }\n        return this.total - this.done;\n    }\n\n    /**\n     * @returns         Percentage (out of 100) of (items done / total items).\n     */\n    get percent(): number {\n        if (isNaN(this.done) || isNaN(this.total) || this.total === 0) {\n            return NaN;\n        }\n        const cent = 100.0;\n        return (this.done / this.total) * cent;\n    }\n\n    /**\n     * Update state from a ProgressEvent.\n     *\n     * @param ev        ProgressEvent, as emitted in the browser.\n     */\n    update_from_event(ev: ProgressEventInterface) {\n        this._done = ev.loaded;\n        this._total = ev.total;\n    }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/progress.ts","import { Response } from \"../../response\";\nimport { parse_array } from \"../../parse\";\nimport { URL } from \"../../http\";\n\n\nexport class BasemapData {\n    name: string;\n    attribution: string;\n    provider: string;\n    description: string;\n    endpoint: string;\n    accessList: string[];\n    styleUrl: string;\n    standard: string;\n    tileFormat: string;\n    thumbnail: undefined;\n\n    errorCode: number;\n    errorMessage: string;\n}\n\n\nexport type Standard = \"XYZ\" ;\nexport type TileFormat = \"PNG\" ;\n\n\n/**\n * Result from the basemaps discovery endpoint.\n */\nexport class Basemap {\n\n    constructor (\n        // URL template. Should specify placeholders for x, y, and z.\n        public endpoint: URL,\n        public standard: Standard,\n        public tile_format: TileFormat,\n        public title: string,\n        public provider: string,\n        public attribution: string,\n        public access_list: string[],\n        public description: string,\n        public thumbnail: string | undefined,\n        public style_url: URL,\n    ) {\n        // TODO: Inspect endpoint for parameter names as validation\n        // const regex = /{(\\-?[a-zA-Z_]+)}/g;\n        // const matches = regex.exec(url as string) || [];\n        // for (const match of matches) {\n        //     console.log(\"match\", match); // TODO\n        // }\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/basemap/basemap.ts","import { Endpoint } from \"../../service\";\n\n\nexport const endpoints = {\n\n    \"metadata\": new Endpoint(\n        // * Trailing slash is needed if security header is not set\n        \"GET\", \"/basemaps/\",\n    ),\n\n    \"manage\": new Endpoint(\n        \"GET\", \"/basemaps/manage\",\n    ),\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/basemap/endpoints.ts","import { URL } from \"../../http\";\nimport { Response } from \"../../response\";\nimport { parse_response, parse_array } from \"../../parse\";\nimport { Basemap, BasemapData, Standard, TileFormat } from \"./basemap\";\n\n\nclass ParseError extends Error {}\n\n\nexport function parse_basemaps(response: Response): Basemap[] {\n    const records: BasemapData[] = parse_array<BasemapData>(response);\n    return records.map((record) => {\n        return new Basemap(\n            // endpoint\n            record.endpoint as URL,\n            // standard\n            record.standard as Standard,\n            // tile_format\n            record.tileFormat as TileFormat,\n            // title\n            record.name,\n            // provider\n            record.provider,\n            // attribution\n            record.attribution,\n            // access_list\n            record.accessList,\n            // description\n            record.description,\n            // thumbnail\n            record.thumbnail,\n            // style_url\n            record.styleUrl as URL,\n        );\n    });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/basemap/parse.ts","// import { URL } from \"../../URL\";\n// import { Basemap } from \"./basemap\";\nimport { Service } from \"../../service\";\nimport { endpoints } from \"./endpoints\";\n\n\n/**\n * HTTP interface definition for basemaps service.\n */\nexport class BasemapService extends Service {\n\n    constructor () {\n        super(endpoints);\n    }\n\n    parse(response: Response) {\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/basemap/service.ts","import { Endpoint } from \"../../service\";\n\n\nexport const endpoints = {\n\n    \"forward\": new Endpoint(\n        \"GET\", \"/geocode/{provider}/address/{address}\",\n    ),\n\n    \"reverse\": new Endpoint(\n        \"GET\", \"/geocode/{provider}/address/x/{x}/y/{y}\",\n    ),\n\n    \"batch\": new Endpoint(\n        \"GET\", \"/geocode/{provider}/batch\",\n    ),\n\n    \"manage\": new Endpoint(\n        \"GET\", \"/geocode/manage\",\n    ),\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/geocoding/endpoints.ts","import { Response } from \"../../response\";\nimport { Service, Endpoint } from \"../../service\";\nimport { GeocodeData, Geocode } from \"./geocode\";\nimport { endpoints } from \"./endpoints\";\n\n\n/**\n * HTTP interface definition for the BCS Geocoding service.\n */\nexport class GeocodingService extends Service {\n    constructor () {\n        super(endpoints);\n    }\n\n    parse(response: Response): Geocode[] {\n        return Geocode.parse(response);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/geocoding/service.ts","import { Endpoint } from \"../../service\";\nimport { Query } from \"../../query\";\n\n\nexport const endpoints = {\n    // JSON list\n    //  name: string\n    //  description: string\n    //  endpoint: string - has originx originy destinationx destinationy in it.\n    //  accessList: List[string]\n    //  apidoc: URL\n    \"metadata\": new Endpoint(\n        \"GET\", \"/routings/\",\n    ),\n\n    // providers: mapzen, mapbox\n    // This looks like the same kind of endpoint provided by /routings/...\n    \"geocoded\": new Endpoint(\n        \"GET\",\n        \"/route/{provider}\\\n        /originx/{originx}\\\n        /originy/{originy}\\\n        /destinationx/{destinationx}\\\n        /destinationy/{destinationy}\",\n    ),\n\n    \"address\": new Endpoint(\n        \"GET\",\n        \"/route/{provider}/\\\n        originaddress/{originaddress}\\\n        /destinationaddress/{destinationaddress}\",\n    ),\n\n    // Any number of waypoints of mixed type: either address or (x, y) coords.\n    // delimited by urlencoded pipe %7C. All data is in the query string.\n    \"waypoints\": new Endpoint(\n        \"GET\", \"/route/{provider}/\",\n        (args) => {\n            const provider = args.provider.toString();\n            // TODO: move the serialization stuff here maybe?\n            const waypoints = args.waypoints.toString();\n            return new Query({\n                \"provider\": provider,\n                \"waypoints\": waypoints,\n            });\n        },\n    ),\n\n    \"batch\": new Endpoint(\n        \"GET\", \"/route/mapbox/batch\",\n    ),\n\n    \"isochrone\": new Endpoint(\n        // returns a jobid.\n        \"GET\", \"/route/{provider}/isochrone\",\n        (args) => {\n            return new Query({\n                \"provider\": args.provider.toString(),\n                // longitude of center point of isochrone\n                \"centerx\": args.longitude.toString(),\n                // latitude of center point of isochrone\n                \"centery\": args.latitude.toString(),\n                // time in seconds\n                \"time\": args.time.toString(),\n                // number of seconds between contours\n                \"resolution\": args.resolution.toString(),\n                // fatest possible speed allowed in area, kilometers per hour\n                \"maxspeed\": args.maxspeed.toString(),\n            });\n        },\n    ),\n\n    \"isochrone_status\": new Endpoint(\n        // status: \"Complete\" | \"Error\"\n        // time\n        // jobid\n        // results: empty for isochrone, populated for batch routing\n        // isoresults: geojson FeatureCollection of WGS84 polygons\n        //  id property;\n        //  level property=drive time from center to this poly's boundary.\n        \"GET\", \"/route/{provider}/isochrone/{jobid}\",\n    ),\n\n    \"manage\": new Endpoint(\n        \"GET\", \"/route/manage\",\n    ),\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/routing/endpoints.ts","import { Response } from \"../../response\";\nimport { parse_response } from \"../../parse\";\nimport { Point } from \"../../location\";\nimport { Route, RouteData, Leg, Step } from \"./route\";\n\n\nclass ParseError extends Error {}\n\n\nexport function parse_route(response: Response): Route {\n    // checks: errorCode, errormessage.\n    const data = parse_response<RouteData>(response);\n    // ignores: id\n    // to be used: distance, duration; legs, geometry\n    const legs = [];\n    for (const leg_data of data.legs) {\n        const steps = [];\n        for (const step_data of leg_data.steps) {\n            const points = [];\n            for (const point_data of step_data.geometry.coordinates) {\n                const point = new Point(point_data[0], point_data[1]);\n                points.push(point);\n            }\n            const step = new Step(\n                points,\n                step_data.instructions,\n                step_data.distance,\n                step_data.duration,\n            );\n            steps.push(step);\n        }\n        const leg = new Leg(steps, leg_data.distance, leg_data.duration);\n        legs.push(leg);\n    }\n    const route = new Route(\n        legs,\n        data.distance,\n        data.duration,\n    );\n    return route;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/routing/parse.ts","import { URI } from \"../../http\";\nimport { Service, ServiceError } from \"../../service\";\nimport { endpoints } from \"./endpoints\";\n\n\nexport class RoutingServiceError extends ServiceError {\n}\n\n\n/**\n * HTTP interface definition for the routing service.\n */\nexport class RoutingService extends Service {\n    _uri: URI;\n\n    constructor () {\n        super(endpoints);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/routing/service.ts","import { Query } from \"../../query\";\nimport { Endpoint } from \"../../service\";\n\n\nclass SearchArgs {\n    text: string;\n    categories: string[];\n    results_per_page: number;\n    starting_page: number;\n}\n\n\n// These should normally be pulled from the search endpoint\nconst DEFAULT_CATEGORIES = [\n    \"LC\",\n    \"DOC\",\n    \"VID\",\n    \"BLOG\",\n    \"QA\",\n    \"DIS\",\n    \"PLUG\",\n];\n\n\n// bcs/bcs-search-service/README.md\nexport const endpoints = {\n\n    \"search\": new Endpoint(\n        \"GET\",\n        \"/search/\",\n        // TODO: not really happy with the untyped interface here... :/\n        (args) => {\n            return new Query({\n                \"q\": (args.text || \"\").toString(),\n                \"cat\": (args.categories || \"ALL\").toString(),\n                \"c\": (args.results_per_page || 20).toString(),\n                \"si\": (args.starting_page || 0).toString(),\n            });\n        },\n    ),\n\n    \"search_data\": new Endpoint(\n        \"GET\",\n        \"/search/data/\",\n    ),\n\n    // NativeSearchServiceTest.java nativeSearchCategory()\n    \"categories\": new Endpoint(\n        \"GET\",\n        \"/search/categories/\",\n    ),\n\n    // TODO: really no point in using this, is there?\n    // NativeSearchServiceTest.java nativeSearchCategory()\n    \"search_in_category\": new Endpoint(\n        \"GET\",\n        \"/search/categories/{category}\",\n        (args) => {\n            let q = args.q;\n            // stupid typescript needs help here\n            if (typeof q === \"number\") {\n                q = \"\";\n            }\n            return new Query({\n                \"q\": q,\n            });\n        },\n    ),\n\n    \"manage\": new Endpoint(\n        \"GET\", \"/search/manage\",\n    ),\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/search/endpoints.ts","import { Response } from \"../../response\";\nimport { ParseError } from \"../../errors\";\nimport {\n    parse_response,\n    parse_array,\n} from \"../../parse\";\nimport {\n    SearchResultEnvelope,\n    SearchResultData,\n    SearchResult,\n} from \"./search_result\";\nimport {\n    SearchCategory,\n    SearchCategoryData,\n} from \"./search_category\";\n\n\nexport function parse_search_results(response: Response): SearchResult[] {\n    const result = parse_response<SearchResultEnvelope>(response);\n    return result.features.map((feature: SearchResultData) => {\n        return new SearchResult(\n            feature.properties.title,\n            feature.properties.url,\n            feature.properties.id,\n            feature.properties.role,\n            feature.properties.category,\n            feature.properties.description,\n            feature.geometry.coordinates[0],\n            feature.geometry.coordinates[1],\n        );\n    });\n}\n\n\nexport function parse_search_categories(response: Response): SearchCategory[] {\n    const results = parse_array<SearchCategoryData>(response);\n    return results.map((result: SearchCategoryData) => {\n        return result as SearchCategory;\n    });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/search/parse.ts","import { URL } from \"../../http\";\nimport { Response } from \"../../response\";\nimport { parse_response } from \"../../parse\";\nimport { Point, Coordinates } from \"../../location\";\n\n\nexport class SearchResultEnvelope {\n    type: \"FeatureCollection\";\n    features: SearchResultData[];\n\n    // Not actually present\n    errorCode: number;\n    errorMessage: string;\n}\n\n\nclass GeometryData {\n    coordinates: Coordinates;\n    type: \"Point\";\n}\n\n\nclass PropertiesData {\n    category: string;\n    description: string;\n    id: string;\n    role: string;\n    title: string;\n    url: URL;\n}\n\n\nexport class SearchResultData {\n    geometry: GeometryData;\n    properties: PropertiesData;\n    type: \"Point\";\n}\n\n\nexport class SearchResult extends Point {\n    constructor (\n        public title: string,\n        public url: URL,\n        public id: string,\n        public role: string,\n        public category: string,\n        public description: string,\n        public x: number,\n        public y: number,\n    ) {\n        super(x, y);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/search/search_result.ts","import { Service, Endpoint } from \"../../service\";\nimport { endpoints } from \"./endpoints\";\n\n\n/**\n * HTTP interface definition for the token service.\n */\nexport class SearchService extends Service {\n\n    constructor () {\n        super(endpoints);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/search/service.ts","import { Query } from \"../../query\";\nimport { Headers } from \"../../headers\";\nimport { Endpoint } from \"../../service\";\n\n\nexport const endpoints = {\n    \"get_token\": new Endpoint(\n        \"POST\",\n        \"/token/\",\n        new Query(),\n        new Headers({\n            \"Content-Type\": \"application/json\",\n        }),\n        (args) => {\n            return JSON.stringify({\n                \"username\": args.username.toString(),\n                \"password\": args.password.toString(),\n            });\n        },\n    ),\n\n    \"get_roles\": new Endpoint(\n        \"GET\",\n        \"/token/entitlements\",\n    ),\n\n    \"get_apikey\": new Endpoint(\n        \"GET\",\n        \"/token/apikey\",\n    ),\n\n    \"manage\": new Endpoint(\n        \"GET\", \"/token/manage\",\n    ),\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/token/endpoints.ts","import { JWTData } from \"./parse\";\n\n\nexport class JWT {\n    // This is way too big, but what can you do\n    // Everything is preparsed so the object is pretty to browse\n\n    constructor (\n        // User name. Probably the same as email in our case.\n        public name: string,\n\n        // Email address.\n        public email: string,\n\n        // Is the email address verified?\n        public email_verified: boolean,\n\n        // List of role strings. Derived from app_metadata.SiteRole\n        public roles: string[],\n\n        // Identify the principal that issued the JWT <- \"iss\"\n        public issuer: string,\n\n        // Principal that the JWT is about. <- \"sub\"\n        public subject: string,\n\n        // Intended recipients for the JWT. <- \"aud\"\n        public audience: string,\n\n        // Time the JWT expires. <- \"exp\"\n        public expiration: Date,\n\n        // Time the JWT was issued. <- \"iat\"\n        public issued_at: Date,\n\n        // Retained copy of the whole token blob, in its unparsed form\n        public token: string,\n    ) {\n    }\n}\n\n\n/**\n * Parses on demand, less pretty to browser\n */\nexport class LazyJWT implements JWT {\n\n    constructor (private data: JWTData) {\n    }\n\n    get name() {\n        return this.data.name;\n    }\n\n    get email() {\n        return this.data.email;\n    }\n\n    get email_verified() {\n        return this.data.email_verified;\n    }\n\n    get roles() {\n        const roles = this.data.app_metadata.SiteRole.split(\",\");\n        roles.sort();\n        return roles;\n    }\n\n    get issuer() {\n        return this.data.iss;\n    }\n\n    get subject() {\n        return this.data.sub;\n    }\n\n    get audience() {\n        return this.data.aud;\n    }\n\n    get expiration() {\n        return new Date(this.data.exp * 1000);\n    }\n\n    get issued_at() {\n        return new Date(this.data.iat * 1000);\n    }\n\n    get token() {\n        return this.data.token || \"\";\n    }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/token/jwt.ts","import { Response } from \"../../response\";\nimport { parse_response } from \"../../parse\";\nimport { JWT, LazyJWT } from \"./jwt\";\n\n\nclass ParseError extends Error {}\n\n\n// https://github.com/boundlessgeo/bcs/blob/master/bcs-token-service\n// /src/main/java/com/boundlessgeo/bcs/data/ApiKeyResponse.java\nclass ApiKeyData {\n    key: string;\n    domain: string;\n    issued: Date;\n    expires: Date;\n}\n\n// ref OAuthTokenResponse in\n// https://github.com/boundlessgeo/bcs/blob/master/bcs-token-service\n// /src/main/java/com/boundlessgeo/bcs/data/OAuthTokenResponse.java\nclass OAuthTokenData {\n    access_token: string;\n    token_type: string;\n    expires_in: number;\n}\n\n// ref TokenRequest in\n// https://github.com/boundlessgeo/bcs/blob/master/bcs-token-service\n// /src/main/java/com/boundlessgeo/bcs/data/TokenRequest.java\nclass TokenRequest {\n    username: string;\n    password: string;\n}\n\n/**\n * Structure of JSON body of token responses.\n *\n * See also:\n * https://github.com/boundlessgeo/bcs/blob/master/bcs-token-service\n * /src/main/java/com/boundlessgeo/bcs/data/BCSToken.java\n */\nexport class TokenData {\n    token: string;\n    errorCode: number | undefined;\n    errorMessage: string | undefined;\n}\n\n/**\n * Structure of object under 'app_metadata' in a parsed JWT.\n */\nexport class AppMetadata {\n    SiteRole: string;\n}\n\n/**\n * Structure of a JWT, after the base64 blob is parsed.\n */\nexport class JWTData {\n    name: string;\n    email: string;\n    email_verified: boolean;\n    app_metadata: AppMetadata;\n    iss: string;\n    sub: string;\n    aud: string;\n    exp: number;\n    iat: number;\n\n    // Not in the actual response, but added by parser for convenience\n    token: string | undefined;\n}\n\n\n/**\n * Extract a token blob from a response.\n *\n * This does not parse any of the JWT structure implicit in the blob.\n */\nexport function response_to_blob(response: Response): string {\n    const data = parse_response<TokenData>(response);\n    if (!data.token) {\n        throw new Error(\"no token blob\");\n    }\n    return data.token;\n}\n\n/**\n * Extract JWT metadata from the given blob.\n */\nexport function blob_to_data(blob: string): JWTData {\n    if (!blob) {\n        throw new Error(\"empty token blob\");\n    }\n    const parts = blob.split(\".\");\n    if (parts.length !== 3) {\n        throw new Error(\"cannot parse token blob into parts\");\n    }\n    const middle = parts[1];\n    // TODO: Node compatibility here...\n    const payload = window.atob(middle);\n    const parsed = JSON.parse(payload);\n    return parsed;\n}\n\n/**\n * Extract JWT metadata from the given response.\n *\n * This means what you get back is a lower-level object directly reflecting the\n * JSON that was base64 encoded.\n */\nexport function response_to_data(response: Response): JWTData {\n    const blob = response_to_blob(response);\n    const data = blob_to_data(blob);\n    // Add the token in case caller doesn't have it\n    return {...data, \"token\": data.token || \"\"};\n}\n\n\n/**\n * Extract a JWT object from the given response.\n *\n * This means what you get back is a higher-level object that's easier for\n * humans to read and write programs against.\n */\nexport function response_to_jwt(response: Response): JWT {\n    const blob = response_to_blob(response);\n    const data = blob_to_data(blob);\n    // Use LazyJWT to parse this, so I don't have to duplicate the parsing\n    // methods right now. But return a nice browsable JWT.\n    const lazy = new LazyJWT(data);\n    return new JWT(\n        lazy.name,\n        lazy.email,\n        lazy.email_verified,\n        lazy.roles,\n        lazy.issuer,\n        lazy.subject,\n        lazy.audience,\n        lazy.expiration,\n        lazy.issued_at,\n        blob,\n    );\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/token/parse.ts","import { Service, Endpoint } from \"../../service\";\nimport { endpoints } from \"./endpoints\";\n\n\n/**\n * HTTP interface definition for the token service.\n */\nexport class TokenService extends Service {\n\n    constructor () {\n        super(endpoints);\n    }\n\n    parse(response: Response) {\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/token/service.ts","/**\n * A Transfer tracks the state of one HTTP request/response cycle.\n *\n * This is the interface and base implementation for Transfer implementations\n * designed around specific environments (e.g. browser on ES5 with XHR).\n */\n\n/** This line does nothing but make typedoc render the module comment. */\n\nimport { Request } from \"./request\";\nimport { Response } from \"./response\";\nimport { Progress } from \"./progress\";\n\n\ninterface Resolve {\n    (response: Response): void;\n}\n\ninterface Reject {\n    (reason: Error): void;\n}\n\ninterface OnFulfill <T> {\n    (response: Response): T;\n}\n\ninterface OnReject <T> {\n    (error: Error): T;\n}\n\n// Promise <R> implements Thenable <R>; here, R = Response.\nexport interface Transfer extends Promise <Response > {\n    readonly request: Request;\n    readonly response: Response;\n    readonly send_progress: Progress;\n    readonly receive_progress: Progress;\n    readonly cause: string;\n    readonly started: boolean;\n\n    start(): void;\n    abort(): void;\n\n    // Interface for presenting a Transfer as a Promise, so we can directly run\n    // transfer.then(...) instead of transfer.promise().then(...).\n    // T is the type of value returned by the on_fulfill callback.\n    then<T>(\n        on_fulfill: OnFulfill<T>, // ((value: Response) => T),\n        on_reject: OnReject<T>, // ((reason: Error) => T),\n    ): Promise<T>;\n\n    catch<T>(\n        on_reject: OnReject<T>, // ((reason: Error) => T),\n    ): Promise<T>;\n}\n\n\n// For use as a type annotation on variables that hold Transfer implementations\nexport interface TransferConstructor {\n    new (request: Request): Transfer;\n}\n\nexport class TransferBase implements Transfer {\n\n    // Work around:\n    // \"Property '[Symbol.toStringTag]' is missing in type 'BrowserTransfer'.\"\n    // This workaround requires tsconfig.json to include \"es2015\" under \"lib\"\n    // under \"compilerOptions\". or else you will get:\n    // \"Property 'toStringTag' does not exist on type 'SymbolConstructor'.\"\n    readonly [Symbol.toStringTag]: \"Promise\";\n\n    request: Request;\n    response: Response;\n    error: Error | Event;\n    started: boolean;\n    aborted: boolean;\n    finished: boolean;\n\n    send_progress: Progress;\n    receive_progress: Progress;\n\n    protected timeout: number;\n    protected _cause: string;\n\n    /**\n     * @param request   Request object representing what will be sent.\n     * @param timeout   Milliseconds to timeout; 0 for no timeout.\n     */\n    constructor (request: Request, timeout?: number) {\n        this.request = request;\n        this.timeout = timeout || 0;\n        this._cause = \"\";\n        this.send_progress = new Progress();\n        this.receive_progress = new Progress();\n        // before started, we're not a promise.\n        // once started = true, we're pending.\n        this.started = false;\n        // rejected\n        this.aborted = false;\n        // fulfilled\n        this.finished = false;\n    }\n\n    start(): void {\n        if (!this.started) {\n            this.started = true;\n        }\n    }\n\n    protected finish(cause: string): void {\n        if (!this.finished) {\n            this._cause = cause;\n            this.finished = true;\n        }\n    }\n\n    /**\n     * Returns a promise, to support a Promises/A+ interface.\n     */\n    public async promise(\n        // on_fulfill?: OnFulfill<void>, // (response: Response) => void,\n        // on_reject?: OnReject<void>, // (reason: Error) => void,\n    ): Promise<Response> {\n        this.start();\n        // Dummy stub for the base.\n        const resolved = Promise.resolve(new Response(0));\n        return resolved;\n    }\n\n    /**\n     * Promises/A+ interface.\n     *\n     * T is the type of value returned by the given callback.\n     */\n    public then <T>(\n        on_fulfill: OnFulfill<T>,\n        on_reject: OnReject<void>,\n    ): Promise<T> | Promise<void> {\n        // NOTE: we can't make this an \"async\" function without making\n        // problems; presumably because ES7 requires not returning any specific\n        // promise type.\n\n        // Delegate to promise returned by this.start().\n        // But we return Promise<T>, where T is whatever onfulfill returns.\n        const promise1: Promise<Response> = this.promise();\n        const promise2: Promise<T> = promise1.then(on_fulfill, on_reject);\n        return promise2;\n    }\n\n    /**\n     * Expose a Promise interface from Transfer.\n     *\n     * T is the type of value returned by the given callback.\n     */\n    public catch <T>(\n        on_reject: OnReject<void>,  // ((reason: Error) => void),\n    ): Promise<T> | Promise<void> {\n        // NOTE: same async issue as we have for then().\n\n        // Delegate to a promise returned by start().\n        return this.promise().catch(on_reject);\n    }\n\n    public abort() {\n        this.aborted = true;\n    }\n\n    get cause() {\n        return this._cause;\n    }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/transfer.ts","import { Request } from \"./request\";\nimport { Response } from \"./response\";\nimport { Headers } from \"./headers\";\n\n\n/**\n * Unpack data from a completed XMLHttpRequest into a Response object.\n */\nfunction xhr_to_response(xhr: XMLHttpRequest): Response {\n\n    // Pass an argless callback that will be invoked lazily to do parsing;\n    // most of the time response won't even need this data\n    const will_parse_headers = () => {\n        const blob: ByteString = xhr.getAllResponseHeaders();\n        return Headers.parse(blob);\n    };\n\n    const response = new Response(\n        xhr.status,\n        will_parse_headers,\n        xhr.responseText,\n    );\n    return response;\n}\n\n\nclass XHRError extends Error {\n    event: Event;\n\n    // TODO: translate event information into something presented\n    constructor (message: string, ev: Event) {\n        super();\n        this.message = message;\n        this.event = ev;\n    }\n}\n\n\n/**\n * Wrap an XMLHttpRequest in a promise that can be awaited.\n *\n * This intentionally doesn't do any interpretation of the XHR. That stuff can\n * be done later in the promise chain.\n *\n * An existing XHR can be passed so that it can be prepared however necessary\n * before passing it in here.\n *\n */\nasync function xhr_to_promise(xhr: XMLHttpRequest) {\n\n    // If the XHR is already done, return an already-resolved Promise.\n    const finished = 4;\n    if (xhr.readyState === finished) {\n        return Promise.resolve(xhr);\n    }\n\n    // Otherwise, return a more complicated Promise wired to the XHR...\n    return new Promise((resolve, reject) => {\n        // Flag used to ensure that reject xor resolve is called exactly once.\n        const flags = {\"done\": false};\n\n        // What is done on successful *load* (INCLUDING HTTP errors 4xx/5xx).\n        // Closes over flags to ensure the one-call invariant.\n        function succeed(ev: UIEvent) {\n            // Do nothing if succeed or fail were already called\n            if (!flags.done) {\n                // Prevent another call\n                flags.done = true;\n\n                // Just return the XHR\n                resolve(xhr);\n\n                // Unpack the XMLHttpRequest and forward it on\n                // const response = xhr_to_response(xhr);\n                // resolve(response);\n            }\n        }\n\n        // What is done in any other failure condition where XHR is done.\n        // Closes over flags to ensure the one-call invariant\n        const fail = (ev: Event) => {\n            // Do nothing if succeed or fail were already called\n            if (!flags.done) {\n                // Prevent another call\n                flags.done = true;\n\n                // Export an Error describing the failure\n                const error = new XHRError(\"XHR failed\", ev);\n                reject(error);\n            }\n        };\n\n        // Load is success\n        xhr.addEventListener(\"load\", succeed);\n\n        // Error, abort, and timeout are failures\n        xhr.addEventListener(\"error\", fail);\n        xhr.addEventListener(\"abort\", fail);\n        xhr.addEventListener(\"timeout\", fail);\n\n        // Just in case other things didn't fire, loadend SHOULD fire after\n        // error, abort, or load. If so, flags.done prevents a second call to\n        // reject. If not, we definitely want to reject.\n        xhr.addEventListener(\"loadend\", fail);\n    });\n}\n\n\nfunction xhr_start(\n    xhr: XMLHttpRequest,\n    method: string,\n    url: string,\n    headers?: [string, string][],\n    body?: string,\n) {\n        xhr.open(method, url, true);\n        if (headers) {\n            for (const pair of headers) {\n                const [key, value] = pair;\n                xhr.setRequestHeader(key, value);\n            }\n        }\n        xhr.send(body || \"\");\n}\n\n\n/**\n * Simple wrapper for XMLHttpRequest.\n *\n * Just a device for organizing XHR-related code.\n */\nexport class XHR {\n    private xhr: XMLHttpRequest;\n    private timeout: number;\n    private _response: Response;\n\n    constructor (timeout = 0) {\n        this.xhr = new XMLHttpRequest();\n        this.timeout = timeout;\n    }\n\n    /**\n     * Add an event listener callback to the underlying XMLHttpRequest.\n     */\n    public listen(name: string, callback: (ev: Event) => void) {\n        this.xhr.addEventListener(name, callback);\n    }\n\n    /**\n     * Start a request running with the underlying XMLHttpRequest.\n     *\n     * For convenience, this returns a promise.\n     */\n    public async start(\n        method: string, url: string, headers?: [string, string][],\n        body?: string,\n    ): Promise<this> {\n        xhr_start(this.xhr, method, url, headers, body || \"\");\n        return this.promise();\n    }\n\n    /**\n     * Create a promise usable to wait on the underlying XMLHttpRequest.\n     *\n     * This intentionally returns a new promise each time.\n     * This intentionally isn't tied to start, since you may want to\n     * \"subscribe\" to an XHR more times than one starts it.\n     */\n    public async promise(): Promise<this> {\n        await xhr_to_promise(this.xhr);\n        return this;\n    }\n\n    /**\n     * Get an unpacked response object for the underlying XMLHttpRequest.\n     *\n     * This intentionally caches and returns the same response object.\n     */\n    public get response(): Response {\n        if (!this._response) {\n            this._response = xhr_to_response(this.xhr);\n        }\n        return this._response;\n    }\n\n    public abort() {\n        this.xhr.abort();\n    }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/xhr.ts"],"sourceRoot":""}